<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200..900&display=swap" rel="stylesheet">
    <title>S√°ch ƒêa Ng√¥n Ng·ªØ</title>
    <style>
        :root {
            --bg-body: #dcdcdc;
            --bg-book: #f4f1ea;
            --text-main: #1a1a1a;
            --text-sub: #555;
            --accent: #e67e22;
            --border: #d1ccc0;
        }

        /* Ch·∫ø ƒë·ªô Dark Mode */
        .dark-mode {
            --bg-body: #1a1a1b;
            --bg-book: #2c2c2e;
            --text-main: #e1e1e1;
            --text-sub: #b0b0b0;
            --accent: #f39c12;
            --border: #444;
        }

        body { 
            margin: 0; padding: 0;
            background-color: var(--bg-body);
            color: var(--text-main);
            transition: all 0.3s ease;
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        }

        .book-container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            background: var(--bg-book);
            min-height: 100vh;
            padding-top: 20px;
        }

        .sentence-item {
            display: flex;
            padding: 20px 5%; /* L·ªÅ tr√°i 5% theo y√™u c·∫ßu */
            border-bottom: 1px solid var(--border);
            word-wrap: break-word; /* T·ª± ƒë·ªông xu·ªëng d√≤ng */
        }

        .text-content {
            flex: 1;
            padding-right: 15px;
        }

        .row-cn { font-family: "Noto Serif SC","Segoe UI", Tahoma, Geneva, Verdana, sans-serif; font-size: 1.8rem; font-weight: normal; margin-bottom: 20px; line-height: 1.4; }
        .row-en { font-size: 1.2rem; margin-bottom: 20px; color: var(--text-main); opacity: 0.9; }
        .row-vi { font-size: 1rem; color: var(--text-sub); font-style: italic; }
        
        .pos-tag { font-size: 0.85rem; color: var(--accent); display: block; margin-bottom: 20px; margin-top: 0px; font-weight: normal; }

        /* Ph√≠m ch·ª©c nƒÉng d·∫°ng c·ªôt icon */
        .control-sidebar {
            display: flex;
            flex-direction: column;
            gap: 8px;
            width: 45px;
            align-items: center;
        }

        .btn-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 1px solid var(--border);
            background: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: 0.2s;
        }
        .btn-icon:hover { background: #eee; transform: scale(1.1); }

        /* Menu n·ªïi c·ªë ƒë·ªãnh ·ªü g√≥c d∆∞·ªõi b√™n ph·∫£i */
        .floating-menu {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 10px;
            z-index: 1000;
        }

        .settings-box {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            display: none; /* ·∫®n m·∫∑c ƒë·ªãnh */
            color: #333;
            font-size: 14px;
        }

        .show-settings .settings-box { display: block; }

        .btn-main-float {
            width: 50px;
            height: 50px;
            background: #34495e;
            color: white;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            font-size: 24px;
        }

	/* Th√™m v√†o trong th·∫ª <style> */
	.pinyin-row {
    		font-size: 16px;
		font-weight: normal;
   		color: #27ae60; /* M√†u xanh l√° d·ªãu m·∫Øt */
    		display: block;
    		margin-top: 0px;
		margin-bottom: 20px;
	}


        .hidden { display: none !important; }

    </style>
</head>
<body>

<div class="book-container" id="bookContent">
    </div>

<div class="floating-menu" id="floatMenu">
    <div class="settings-box">
        <strong>‚öôÔ∏è C√†i ƒë·∫∑t</strong><hr>
        T·ªëc ƒë·ªô: <input type="range" id="rate" min="0.5" max="1.3" step="0.1" value="0.9" style="width: 100px;"><br>
        <label><input type="checkbox" id="autoNext"> T·ª± ƒë·ªông chuy·ªÉn</label><br>
	<button onclick="toggleAllPinyin()" style="width: 100%; margin-top: 10px;">üî§ ·∫®n/Hi·ªán Pinyin</button>
        <button onclick="toggleDarkMode()" style="width: 100%; margin-top: 10px;">üåô Dark Mode</button>
    </div>
    <button class="btn-main-float" onclick="document.getElementById('floatMenu').classList.toggle('show-settings')">üõ†Ô∏è</button>
</div>

<script>
const sentences = [
  {
    cn_raw: `ÊàëÂê¨ËøáÈí¢Áê¥ÂçèÂ•èÊõ≤„ÄäÈªÑÊ≤≥„Äã„ÄÇ`,
    cn_split: `Êàë - Âê¨ - Ëøá - Èí¢Áê¥ - ÂçèÂ•èÊõ≤ - „Ää - ÈªÑÊ≤≥ - „Äã`,
    cn_pos: `ƒê·∫°i t·ª´ - ƒê·ªông t·ª´ - Tr·ª£ t·ª´ - Danh t·ª´ - Danh t·ª´ - K√Ω hi·ªáu - Danh t·ª´ - K√Ω hi·ªáu`,
    en_raw: `I have heard the piano concerto "Yellow River".`,
    en_split: `I - have heard - the piano concerto - "Yellow River"`,
    en_pos: `Pronoun - Verb phrase - Noun phrase - Proper noun`,
    vi: `T√¥i ƒë√£ t·ª´ng nghe b·∫£n h·ª£p x∆∞·ªõng piano "S√¥ng Ho√†ng H√†".`,
    pinyin: `W«í tƒ´nggu√≤ gƒÅngq√≠n xi√©zh√≤uq«î "Hu√°ngh√©".`
  },
  {
    cn_raw: `Áî∞Ëä≥ÔºöÁà±Âæ∑ÂçéÔºå‰Ω†ËØ¥‰Ω†ÊòØ‰∏™Èü≥‰πêËø∑Ôºå‰Ω†Âê¨Ëøá‰∏≠ÂõΩÈü≥‰πêÂêóÔºü`,
    cn_split: `Áî∞Ëä≥ - Ôºö - Áà±Âæ∑Âçé - Ôºå - ‰Ω† - ËØ¥ - ‰Ω† - ÊòØ - ‰∏™ - Èü≥‰πêËø∑ - Ôºå - ‰Ω† - Âê¨ - Ëøá - ‰∏≠ÂõΩ - Èü≥‰πê - Âêó - Ôºü`,
    cn_pos: `Danh t·ª´ - K√Ω hi·ªáu - Danh t·ª´ - K√Ω hi·ªáu - ƒê·∫°i t·ª´ - ƒê·ªông t·ª´ - ƒê·∫°i t·ª´ - ƒê·ªông t·ª´ - L∆∞·ª£ng t·ª´ - Danh t·ª´ - K√Ω hi·ªáu - ƒê·∫°i t·ª´ - ƒê·ªông t·ª´ - Tr·ª£ t·ª´ - Danh t·ª´ - Danh t·ª´ - Tr·ª£ t·ª´ - K√Ω hi·ªáu`,
    en_raw: `Tian Fang: Edward, you said you are a music fan, have you heard Chinese music?`,
    en_split: `Tian Fang - : - Edward - , - you - said - you - are - a music fan - , - have - you - heard - Chinese music - ?`,
    en_pos: `Proper noun - Punctuation - Proper noun - Punctuation - Pronoun - Verb - Pronoun - Verb - Noun phrase - Punctuation - Auxiliary - Pronoun - Verb - Noun phrase - Punctuation`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: Edward, b·∫°n n√≥i b·∫°n l√† m·ªôt ng∆∞·ªùi h√¢m m·ªô √¢m nh·∫°c, b·∫°n ƒë√£ t·ª´ng nghe nh·∫°c Trung Qu·ªëc ch∆∞a?`,
    pinyin: `Ti√°n FƒÅng: √Äid√©hu√°, n«ê shu≈ç n«ê sh√¨ g√® yƒ´nyu√® m√≠, n«ê tƒ´nggu√≤ Zh≈çnggu√≥ yƒ´nyu√® ma?`
  },
  {
    cn_raw: `Áà±Âæ∑ÂçéÔºöÂΩìÁÑ∂Âê¨ËøáÔºÅ`,
    cn_split: `Áà±Âæ∑Âçé - Ôºö - ÂΩìÁÑ∂ - Âê¨ - Ëøá - ÔºÅ`,
    cn_pos: `Danh t·ª´ - K√Ω hi·ªáu - Ph√≥ t·ª´ - ƒê·ªông t·ª´ - Tr·ª£ t·ª´ - K√Ω hi·ªáu`,
    en_raw: `Edward: Of course I have!`,
    en_split: `Edward - : - Of course - I - have - !`,
    en_pos: `Proper noun - Punctuation - Adverb - Pronoun - Verb - Punctuation`,
    vi: `Edward: ƒê∆∞∆°ng nhi√™n l√† nghe r·ªìi!`,
    pinyin: `√Äid√©hu√°: DƒÅngr√°n tƒ´nggu√≤!`
  },
  {
    cn_raw: `Áî∞Ëä≥ÔºöÂê¨Ëøá‰ªÄ‰πàÔºü`,
    cn_split: `Áî∞Ëä≥ - Ôºö - Âê¨ - Ëøá - ‰ªÄ‰πà - Ôºü`,
    cn_pos: `Danh t·ª´ - K√Ω hi·ªáu - ƒê·ªông t·ª´ - Tr·ª£ t·ª´ - ƒê·∫°i t·ª´ nghi v·∫•n - K√Ω hi·ªáu`,
    en_raw: `Tian Fang: What have you heard?`,
    en_split: `Tian Fang - : - What - have - you - heard - ?`,
    en_pos: `Proper noun - Punctuation - Pronoun - Auxiliary - Pronoun - Verb - Punctuation`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: ƒê√£ nghe c√°i g√¨ r·ªìi?`,
    pinyin: `Ti√°n FƒÅng: Tƒ´nggu√≤ sh√©nme?`
  },
  {
    cn_raw: `Áà±Âæ∑ÂçéÔºöÂú®Âä†ÊãøÂ§ßÊó∂ÔºåÊàë‰∫≤ËÄ≥Âê¨Ëøá‰∏Ä‰Ωç‰∏≠ÂõΩÈí¢Áê¥ÂÆ∂ÊºîÂ•èÁöÑ„ÄäÈªÑÊ≤≥„Äã„ÄÇ`,
    cn_split: `Áà±Âæ∑Âçé - Ôºö - Âú® - Âä†ÊãøÂ§ß - Êó∂ - Ôºå - Êàë - ‰∫≤ËÄ≥ - Âê¨ - Ëøá - ‰∏Ä - ‰Ωç - ‰∏≠ÂõΩ - Èí¢Áê¥ÂÆ∂ - ÊºîÂ•è - ÁöÑ - „Ää - ÈªÑÊ≤≥ - „Äã`,
    cn_pos: `Danh t·ª´ - K√Ω hi·ªáu - Gi·ªõi t·ª´ - Danh t·ª´ - Danh t·ª´ (th·ªùi gian) - K√Ω hi·ªáu - ƒê·∫°i t·ª´ - Ph√≥ t·ª´ - ƒê·ªông t·ª´ - Tr·ª£ t·ª´ - S·ªë t·ª´ - L∆∞·ª£ng t·ª´ - Danh t·ª´ - Danh t·ª´ - ƒê·ªông t·ª´ - Tr·ª£ t·ª´ k·∫øt c·∫•u - K√Ω hi·ªáu - Danh t·ª´ - K√Ω hi·ªáu`,
    en_raw: `Edward: When I was in Canada, I personally heard the "Yellow River" performed by a Chinese pianist.`,
    en_split: `Edward - : - When - I - was - in Canada - , - I - personally - heard - the "Yellow River" - performed by - a Chinese pianist`,
    en_pos: `Proper noun - Punctuation - Conjunction - Pronoun - Verb - Prepositional phrase - Punctuation - Pronoun - Adverb - Verb - Noun phrase - Verb phrase - Noun phrase`,
    vi: `Edward: Khi ·ªü Canada, t√¥i ƒë√£ t·∫≠n tai nghe b·∫£n "S√¥ng Ho√†ng H√†" do m·ªôt ngh·ªá sƒ© piano Trung Qu·ªëc bi·ªÉu di·ªÖn.`,
    pinyin: `√Äid√©hu√°: Z√†i JiƒÅn√°d√† sh√≠, w«í qƒ´n'ƒõr tƒ´nggu√≤ y√≠ w√®i Zh≈çnggu√≥ gƒÅngq√≠njiƒÅ y«énz√≤u de "Hu√°ngh√©".`
  },
  {
    cn_raw: `Áî∞Ëä≥Ôºö‰Ω†ËßâÂæóÊÄé‰πàÊ†∑Ôºü`,
    cn_split: `Áî∞Ëä≥ - Ôºö - ‰Ω† - ËßâÂæó - ÊÄé‰πàÊ†∑ - Ôºü`,
    cn_pos: `Danh t·ª´ - K√Ω hi·ªáu - ƒê·∫°i t·ª´ - ƒê·ªông t·ª´ - ƒê·∫°i t·ª´ nghi v·∫•n - K√Ω hi·ªáu`,
    en_raw: `Tian Fang: What do you think?`,
    en_split: `Tian Fang - : - What - do - you - think - ?`,
    en_pos: `Proper noun - Punctuation - Pronoun - Auxiliary - Pronoun - Verb - Punctuation`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: B·∫°n c·∫£m th·∫•y th·∫ø n√†o?`,
    pinyin: `Ti√°n FƒÅng: N«ê ju√©de zƒõnmey√†ng?`
  },
  {
    cn_raw: `Áà±Âæ∑ÂçéÔºöÂ•ΩÊûÅ‰∫ÜÔºåÁúüÊÉ≥ÂÜçÂê¨‰∏ÄÈÅç„ÄÇ`,
    cn_split: `Áà±Âæ∑Âçé - Ôºö - Â•Ω - ÊûÅ - ‰∫Ü - Ôºå - Áúü - ÊÉ≥ - ÂÜç - Âê¨ - ‰∏Ä - ÈÅç - „ÄÇ`,
    cn_pos: `Danh t·ª´ - K√Ω hi·ªáu - T√≠nh t·ª´ - Tr·ª£ t·ª´ m·ª©c ƒë·ªô - Tr·ª£ t·ª´ - K√Ω hi·ªáu - Ph√≥ t·ª´ - ƒê·ªông t·ª´ nƒÉng nguy·ªán - Ph√≥ t·ª´ - ƒê·ªông t·ª´ - S·ªë t·ª´ - L∆∞·ª£ng t·ª´ - K√Ω hi·ªáu`,
    en_raw: `Edward: Excellent, I really want to hear it again.`,
    en_split: `Edward - : - Excellent - , - I - really - want - to hear - it - again - .`,
    en_pos: `Proper noun - Punctuation - Adjective - Punctuation - Pronoun - Adverb - Verb - Infinitive phrase - Pronoun - Adverb - Punctuation`,
    vi: `Edward: Tuy·ªát v·ªùi l·∫Øm, th·ª±c s·ª± mu·ªën nghe l·∫°i m·ªôt l·∫ßn n·ªØa.`,
    pinyin: `√Äid√©hu√°: H«éoj√≠le, zhƒìn xi«éng z√†i tƒ´ng y√≠ bi√†n.`
  },
  {
    cn_raw: `Áî∞Ëä≥ÔºöÂê¨ËøáÂ∞èÊèêÁê¥ÂçèÂ•èÊõ≤„ÄäÊ¢ÅÁ•ù„ÄãÂêóÔºü`,
    cn_split: `Áî∞Ëä≥ - Ôºö - Âê¨ - Ëøá - Â∞èÊèêÁê¥ - ÂçèÂ•èÊõ≤ - „Ää - Ê¢ÅÁ•ù - „Äã - Âêó - Ôºü`,
    cn_pos: `Danh t·ª´ - K√Ω hi·ªáu - ƒê·ªông t·ª´ - Tr·ª£ t·ª´ - Danh t·ª´ - Danh t·ª´ - K√Ω hi·ªáu - Danh t·ª´ - K√Ω hi·ªáu - Tr·ª£ t·ª´ - K√Ω hi·ªáu`,
    en_raw: `Tian Fang: Have you heard the violin concerto "Butterfly Lovers"?`,
    en_split: `Tian Fang - : - Have - you - heard - the violin concerto - "Butterfly Lovers" - ?`,
    en_pos: `Proper noun - Punctuation - Auxiliary - Pronoun - Verb - Noun phrase - Proper noun - Punctuation`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: ƒê√£ nghe b·∫£n h·ª£p x∆∞·ªõng violin "L∆∞∆°ng Ch√∫c" ch∆∞a?`,
    pinyin: `Ti√°n FƒÅng: Tƒ´nggu√≤ xi«éot√≠q√≠n xi√©zh√≤uq«î "Li√°ng-Zh√π" ma?`
  },
  {
    cn_raw: `Áà±Âæ∑ÂçéÔºöÂê¨ËØ¥ËøáÔºå‰ΩÜÊòØÊ≤°Âê¨Ëøá„ÄÇ`,
    cn_split: `Áà±Âæ∑Âçé - Ôºö - Âê¨ËØ¥ - Ëøá - Ôºå - ‰ΩÜÊòØ - Ê≤° - Âê¨ - Ëøá - „ÄÇ`,
    cn_pos: `Danh t·ª´ - K√Ω hi·ªáu - ƒê·ªông t·ª´ - Tr·ª£ t·ª´ - K√Ω hi·ªáu - Li√™n t·ª´ - Ph√≥ t·ª´ ph·ªß ƒë·ªãnh - ƒê·ªông t·ª´ - Tr·ª£ t·ª´ - K√Ω hi·ªáu`,
    en_raw: `Edward: I've heard of it, but I haven't heard it.`,
    en_split: `Edward - : - I - 've heard of - it - , - but - I - haven't - heard - it - .`,
    en_pos: `Proper noun - Punctuation - Pronoun - Verb phrase - Pronoun - Punctuation - Conjunction - Pronoun - Auxiliary - Verb - Pronoun - Punctuation`,
    vi: `Edward: C√≥ nghe n√≥i qua r·ªìi, nh∆∞ng ch∆∞a nghe (tr·ª±c ti·∫øp).`,
    pinyin: `√Äid√©hu√°: Tƒ´ngshu≈çgu√≤, d√†nsh√¨ m√©i tƒ´nggu√≤.`
  },
  {
    cn_raw: `Â•ΩÂê¨ÂêóÔºü`,
    cn_split: `Â•ΩÂê¨ - Âêó - Ôºü`,
    cn_pos: `T√≠nh t·ª´ - Tr·ª£ t·ª´ - K√Ω hi·ªáu`,
    en_raw: `Is it good to listen to?`,
    en_split: `Is - it - good to listen to - ?`,
    en_pos: `Verb - Pronoun - Adjective phrase - Punctuation`,
    vi: `C√≥ hay kh√¥ng?`,
    pinyin: `H«éotƒ´ng ma?`
  },
  {
    cn_raw: `Áî∞Ëä≥Ôºö‰Ω†Âê¨‰∫ÜÂ∞±Áü•ÈÅì‰∫Ü„ÄÇ`,
    cn_split: `Áî∞Ëä≥ - Ôºö - ‰Ω† - Âê¨ - ‰∫Ü - Â∞± - Áü•ÈÅì - ‰∫Ü - „ÄÇ`,
    cn_pos: `Danh t·ª´ - K√Ω hi·ªáu - ƒê·∫°i t·ª´ - ƒê·ªông t·ª´ - Tr·ª£ t·ª´ - Ph√≥ t·ª´ - ƒê·ªông t·ª´ - Tr·ª£ t·ª´ - K√Ω hi·ªáu`,
    en_raw: `Tian Fang: You will know after you listen to it.`,
    en_split: `Tian Fang - : - You - will know - after - you - listen to - it - .`,
    en_pos: `Proper noun - Punctuation - Pronoun - Verb phrase - Conjunction - Pronoun - Verb phrase - Pronoun - Punctuation`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: B·∫°n nghe r·ªìi s·∫Ω bi·∫øt th√¥i.`,
    pinyin: `Ti√°n FƒÅng: N«ê tƒ´ngle ji√π zhƒ´d√†ole.`
  },
  {
    cn_raw: `Áà±Âæ∑ÂçéÔºöÊàëÂæàÊÉ≥Âê¨Âê¨Ôºå‰Ω†ËøôÂÑøÊúâÂÖâÁõòÂêóÔºü`,
    cn_split: `Áà±Âæ∑Âçé - Ôºö - Êàë - Âæà - ÊÉ≥ - Âê¨Âê¨ - Ôºå - ‰Ω† - ËøôÂÑø - Êúâ - ÂÖâÁõò - Âêó - Ôºü`,
    cn_pos: `Danh t·ª´ - K√Ω hi·ªáu - ƒê·∫°i t·ª´ - Ph√≥ t·ª´ - ƒê·ªông t·ª´ nƒÉng nguy·ªán - ƒê·ªông t·ª´ (l·∫∑p l·∫°i) - K√Ω hi·ªáu - ƒê·∫°i t·ª´ - ƒê·∫°i t·ª´ ch·ªâ n∆°i ch·ªën - ƒê·ªông t·ª´ - Danh t·ª´ - Tr·ª£ t·ª´ - K√Ω hi·ªáu`,
    en_raw: `Edward: I really want to listen, do you have the CD here?`,
    en_split: `Edward - : - I - really - want to listen - , - do - you - have - the CD - here - ?`,
    en_pos: `Proper noun - Punctuation - Pronoun - Adverb - Verb phrase - Punctuation - Auxiliary - Pronoun - Verb - Noun phrase - Adverb - Punctuation`,
    vi: `Edward: T√¥i r·∫•t mu·ªën nghe th·ª≠, ch·ªó b·∫°n c√≥ ƒëƒ©a CD kh√¥ng?`,
    pinyin: `√Äid√©hu√°: W«í hƒõn xi«éng tƒ´ngting, n«ê zh√®r y«íu guƒÅngp√°n ma?`
  },
  {
    cn_raw: `Áî∞Ëä≥ÔºöÊúâ„ÄÇ`,
    cn_split: `Áî∞Ëä≥ - Ôºö - Êúâ - „ÄÇ`,
    cn_pos: `Danh t·ª´ - K√Ω hi·ªáu - ƒê·ªông t·ª´ - K√Ω hi·ªáu`,
    en_raw: `Tian Fang: Yes.`,
    en_split: `Tian Fang - : - Yes - .`,
    en_pos: `Proper noun - Punctuation - Adverb - Punctuation`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: C√≥.`,
    pinyin: `Ti√°n FƒÅng: Y«íu.`
  },
  {
    cn_raw: `Áà±Âæ∑ÂçéÔºöÂÄüÁªôÊàëÂê¨Âê¨Âêß„ÄÇ`,
    cn_split: `Áà±Âæ∑Âçé - Ôºö - ÂÄü - Áªô - Êàë - Âê¨Âê¨ - Âêß - „ÄÇ`,
    cn_pos: `Danh t·ª´ - K√Ω hi·ªáu - ƒê·ªông t·ª´ - Gi·ªõi t·ª´ - ƒê·∫°i t·ª´ - ƒê·ªông t·ª´ (l·∫∑p l·∫°i) - Tr·ª£ t·ª´ ng·ªØ kh√≠ - K√Ω hi·ªáu`,
    en_raw: `Edward: Please lend it to me to listen.`,
    en_split: `Edward - : - Please - lend - it - to me - to listen - .`,
    en_pos: `Proper noun - Punctuation - Adverb - Verb - Pronoun - Prepositional phrase - Infinitive phrase - Punctuation`,
    vi: `Edward: Cho t√¥i m∆∞·ª£n nghe th·ª≠ ƒëi.`,
    pinyin: `√Äid√©hu√°: Ji√® gƒõi w«í tƒ´ngting ba.`
  },
  {
    cn_raw: `Áî∞Ëä≥Ôºö‰Ω†ÊãøÂéªÂêß„ÄÇ`,
    cn_split: `Áî∞Ëä≥ - Ôºö - ‰Ω† - Êãø - Âéª - Âêß - „ÄÇ`,
    cn_pos: `Danh t·ª´ - K√Ω hi·ªáu - ƒê·∫°i t·ª´ - ƒê·ªông t·ª´ - ƒê·ªông t·ª´ xu h∆∞·ªõng - Tr·ª£ t·ª´ ng·ªØ kh√≠ - K√Ω hi·ªáu`,
    en_raw: `Tian Fang: You take it.`,
    en_split: `Tian Fang - : - You - take - it - .`,
    en_pos: `Proper noun - Punctuation - Pronoun - Verb - Pronoun - Punctuation`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: B·∫°n c·∫ßm ƒëi ƒëi.`,
    pinyin: `Ti√°n FƒÅng: N«ê n√° q√π ba.`
  },
  {
    cn_raw: `Âê¨ÂÆåÂ∞±ËøòÁªôÊàë„ÄÇ`,
    cn_split: `Âê¨ - ÂÆå - Â∞± - Ëøò - Áªô - Êàë - „ÄÇ`,
    cn_pos: `ƒê·ªông t·ª´ - B·ªï ng·ªØ k·∫øt qu·∫£ - Ph√≥ t·ª´ - ƒê·ªông t·ª´ - Gi·ªõi t·ª´ - ƒê·∫°i t·ª´ - K√Ω hi·ªáu`,
    en_raw: `Return it to me after you finish listening.`,
    en_split: `Return - it - to me - after - you - finish listening - .`,
    en_pos: `Verb - Pronoun - Prepositional phrase - Conjunction - Pronoun - Verb phrase - Punctuation`,
    vi: `Nghe xong th√¨ tr·∫£ l·∫°i cho t√¥i nh√©.`,
    pinyin: `Tƒ´ng w√°n ji√π hu√°n gƒõi w«í.`
  },
  {
    cn_raw: `Áà±Âæ∑ÂçéÔºö‰∏ÄÂÆö„ÄÇ`,
    cn_split: `Áà±Âæ∑Âçé - Ôºö - ‰∏ÄÂÆö - „ÄÇ`,
    cn_pos: `Danh t·ª´ - K√Ω hi·ªáu - Ph√≥ t·ª´ - K√Ω hi·ªáu`,
    en_raw: `Edward: Definitely.`,
    en_split: `Edward - : - Definitely - .`,
    en_pos: `Proper noun - Punctuation - Adverb - Punctuation`,
    vi: `Edward: Nh·∫•t ƒë·ªãnh r·ªìi.`,
    pinyin: `√Äid√©hu√°: Y√≠d√¨ng.`
  },
  {
    cn_raw: `Â•ΩÂÄüÂ•ΩËøòÔºåÂÜçÂÄü‰∏çÈöæÂòõ„ÄÇ`,
    cn_split: `Â•Ω - ÂÄü - Â•Ω - Ëøò - Ôºå - ÂÜç - ÂÄü - ‰∏ç - Èöæ - Âòõ - „ÄÇ`,
    cn_pos: `T√≠nh t·ª´ - ƒê·ªông t·ª´ - T√≠nh t·ª´ - ƒê·ªông t·ª´ - K√Ω hi·ªáu - Ph√≥ t·ª´ - ƒê·ªông t·ª´ - Ph√≥ t·ª´ ph·ªß ƒë·ªãnh - T√≠nh t·ª´ - Tr·ª£ t·ª´ ng·ªØ kh√≠ - K√Ω hi·ªáu`,
    en_raw: `Edward: Borrowing and returning easily makes borrowing again not difficult.`,
    en_split: `Edward - : - Borrowing - and - returning - easily - makes - borrowing again - not - difficult - .`,
    en_pos: `Proper noun - Punctuation - Gerund - Conjunction - Gerund - Adverb - Verb - Noun phrase - Adverb - Adjective - Punctuation`,
    vi: `C√≥ m∆∞·ª£n c√≥ tr·∫£, m∆∞·ª£n l·∫°i kh√¥ng kh√≥ m√†.`,
    pinyin: `H«éo ji√® h«éo hu√°n, z√†i ji√® b√π n√°n ma.`
  }
];
// C·∫≠p nh·∫≠t h√†m render ƒë·ªÉ truy·ªÅn d·ªØ li·ªáu an to√†n h∆°n
function renderBook() {
    const container = document.getElementById('bookContent');
    sentences.forEach((s, i) => {
        const item = document.createElement('div');
        item.className = 'sentence-item';
        item.innerHTML = `
            <div class="text-content">
                <div class="row-cn">
                    <span id="cn-txt-${i}">${s.cn_raw}</span>
                </div>
                <div id="cn-pos-${i}" class="pos-tag hidden">${s.cn_pos}</div>
                <div id="pinyin-${i}" class="pinyin-row hidden">${s.pinyin || ''}</div>
                <div class="row-en">
                    <span id="en-txt-${i}">${s.en_raw}</span>
                </div>
                <div id="en-pos-${i}" class="pos-tag hidden">${s.en_pos}</div>
                <div class="row-vi">${s.vi}</div>
            </div>
            <div class="control-sidebar">
                <button class="btn-icon" onclick="playSpeech(${i}, 'cn')">‚ôò</button>
                <button class="btn-icon" onclick="toggleMode(${i}, 'cn')">‚ôî</button>
                <button class="btn-icon" onclick="playSpeech(${i}, 'en')">‚ôñ</button>
                <button class="btn-icon" onclick="toggleMode(${i}, 'en')">‚ôï</button>
            </div>
        `;
        container.appendChild(item);
    });
}
// H√†m ph√°t √¢m m·ªõi: L·∫•y d·ªØ li·ªáu tr·ª±c ti·∫øp t·ª´ m·∫£ng thay v√¨ truy·ªÅn chu·ªói qua HTML
// H√†m ph√°t √¢m: T·ª± ƒë·ªông duy tr√¨ ng√¥n ng·ªØ ƒëang ch·ªçn
function playSpeech(index, langType) {
    // 1. D·ª´ng m·ªçi √¢m thanh ƒëang ph√°t ƒë·ªÉ tr√°nh ch·ªìng ch√©o
    window.speechSynthesis.cancel(); 

    let textToRead = "";
    let langCode = "";

    // 2. X√°c ƒë·ªãnh n·ªôi dung v√† m√£ ng√¥n ng·ªØ d·ª±a tr√™n l·ª±a ch·ªçn c·ªßa ng∆∞·ªùi d√πng
    if (langType === 'cn') {
        textToRead = sentences[index].cn_raw;
        langCode = 'zh-CN';
    } else {
        textToRead = sentences[index].en_raw;
        langCode = 'en-US';
    }

    const msg = new SpeechSynthesisUtterance();
    msg.text = textToRead;
    msg.lang = langCode;
    msg.rate = document.getElementById('rate').value;
    
    // 3. Hi·ªáu ·ª©ng Highlight: T√¥ m√†u c√¢u ƒëang ƒë·ªçc ƒë·ªÉ d·ªÖ theo d√µi
    const allItems = document.getElementsByClassName('sentence-item');
    // X√≥a m√†u c·ªßa t·∫•t c·∫£ c√°c c√¢u kh√°c
    Array.from(allItems).forEach(item => item.style.backgroundColor = "transparent");
    // T√¥ m√†u v√†ng nh·∫°t cho c√¢u hi·ªán t·∫°i
    allItems[index].style.backgroundColor = "rgba(230, 126, 34, 0.1)";

    // 4. X·ª≠ l√Ω khi k·∫øt th√∫c c√¢u
    msg.onend = () => {
        const isAuto = document.getElementById('autoNext').checked;
        if (isAuto && index < sentences.length - 1) {
            setTimeout(() => {
                // QUAN TR·ªåNG: Truy·ªÅn ƒë√∫ng langType hi·ªán t·∫°i v√†o l·∫ßn g·ªçi ti·∫øp theo
                playSpeech(index + 1, langType); 
                
                // T·ª± ƒë·ªông cu·ªôn m√†n h√¨nh ƒë·∫øn c√¢u ti·∫øp theo
                allItems[index + 1].scrollIntoView({
                    behavior: "smooth", 
                    block: "center"
                });
            }, 500); // Ngh·ªâ 0.5 gi√¢y gi·ªØa c√°c c√¢u ƒë·ªÉ ng∆∞·ªùi d√πng k·ªãp ng·∫•m
        }
    };

    window.speechSynthesis.speak(msg);
}
function toggleMode(index, lang) {
    const txtSpan = document.getElementById(`${lang}-txt-${index}`);
    const posSpan = document.getElementById(`${lang}-pos-${index}`);
    const isOriginal = txtSpan.innerText === sentences[index][`${lang}_raw`];

    txtSpan.innerText = isOriginal ? sentences[index][`${lang}_split`] : sentences[index][`${lang}_raw`];
    posSpan.classList.toggle('hidden');
}

function toggleDarkMode() {
    document.body.classList.toggle('dark-mode');
}

function toggleAllPinyin() {
    // 1. L·∫•y t·∫•t c·∫£ c√°c ph·∫ßn t·ª≠ c√≥ class l√† pinyin-row
    const pinyinElements = document.getElementsByClassName('pinyin-row');
    
    // 2. Ki·ªÉm tra n·∫øu kh√¥ng t√¨m th·∫•y ph·∫ßn t·ª≠ n√†o (b√°o l·ªói ra Console ƒë·ªÉ ki·ªÉm tra)
    if (pinyinElements.length === 0) {
        console.error("Kh√¥ng t√¨m th·∫•y ph·∫ßn t·ª≠ n√†o c√≥ class 'pinyin-row'");
        return;
    }

    // 3. Duy·ªát qua t·ª´ng ph·∫ßn t·ª≠ v√† b·∫≠t/t·∫Øt class 'hidden'
    for (let i = 0; i < pinyinElements.length; i++) {
        pinyinElements[i].classList.toggle('hidden');
    }
}

function speak(text, lang, index) {
    window.speechSynthesis.cancel();
    const msg = new SpeechSynthesisUtterance(text);
    msg.lang = lang;
    msg.rate = document.getElementById('rate').value;

    msg.onend = () => {
        if (document.getElementById('autoNext').checked && index < sentences.length - 1) {
            setTimeout(() => {
                speak(sentences[index + 1].cn_raw, 'zh-CN', index + 1);
                document.getElementsByClassName('sentence-item')[index+1].scrollIntoView({behavior: "smooth", block: "center"});
            }, 1200);
        }
    };
    window.speechSynthesis.speak(msg);
}

renderBook();
</script>
</body>
</html>