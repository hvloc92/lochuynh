<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200..900&display=swap" rel="stylesheet">
    <title>S√°ch ƒêa Ng√¥n Ng·ªØ</title>
    <style>
        :root {
            --bg-body: #dcdcdc;
            --bg-book: #f4f1ea;
            --text-main: #1a1a1a;
            --text-sub: #555;
            --accent: #e67e22;
            --border: #d1ccc0;
        }

        /* Ch·∫ø ƒë·ªô Dark Mode */
        .dark-mode {
            --bg-body: #1a1a1b;
            --bg-book: #2c2c2e;
            --text-main: #e1e1e1;
            --text-sub: #b0b0b0;
            --accent: #f39c12;
            --border: #444;
        }

        body { 
            margin: 0; padding: 0;
            background-color: var(--bg-body);
            color: var(--text-main);
            transition: all 0.3s ease;
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        }

        .book-container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            background: var(--bg-book);
            min-height: 100vh;
            padding-top: 20px;
        }

        .sentence-item {
            display: flex;
            padding: 20px 5%; /* L·ªÅ tr√°i 5% theo y√™u c·∫ßu */
            border-bottom: 1px solid var(--border);
            word-wrap: break-word; /* T·ª± ƒë·ªông xu·ªëng d√≤ng */
        }

        .text-content {
            flex: 1;
            padding-right: 15px;
        }

        .row-cn { font-family: "Noto Serif SC","Segoe UI", Tahoma, Geneva, Verdana, sans-serif; font-size: 1.8rem; font-weight: normal; margin-bottom: 20px; line-height: 1.4; }
        .row-en { font-size: 1.2rem; margin-bottom: 20px; color: var(--text-main); opacity: 0.9; }
        .row-vi { font-size: 1rem; color: var(--text-sub); font-style: italic; }
        
        .pos-tag { font-size: 0.85rem; color: var(--accent); display: block; margin-bottom: 20px; margin-top: 0px; font-weight: normal; }

        /* Ph√≠m ch·ª©c nƒÉng d·∫°ng c·ªôt icon */
        .control-sidebar {
            display: flex;
            flex-direction: column;
            gap: 8px;
            width: 45px;
            align-items: center;
        }

        .btn-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 1px solid var(--border);
            background: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: 0.2s;
        }
        .btn-icon:hover { background: #eee; transform: scale(1.1); }

        /* Menu n·ªïi c·ªë ƒë·ªãnh ·ªü g√≥c d∆∞·ªõi b√™n ph·∫£i */
        .floating-menu {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 10px;
            z-index: 1000;
        }

        .settings-box {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            display: none; /* ·∫®n m·∫∑c ƒë·ªãnh */
            color: #333;
            font-size: 14px;
        }

        .show-settings .settings-box { display: block; }

        .btn-main-float {
            width: 50px;
            height: 50px;
            background: #34495e;
            color: white;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            font-size: 24px;
        }

	/* Th√™m v√†o trong th·∫ª <style> */
	.pinyin-row {
    		font-size: 16px;
		font-weight: normal;
   		color: #27ae60; /* M√†u xanh l√° d·ªãu m·∫Øt */
    		display: block;
    		margin-top: 0px;
		margin-bottom: 20px;
	}


        .hidden { display: none !important; }

    </style>
</head>
<body>

<div class="book-container" id="bookContent">
    </div>

<div class="floating-menu" id="floatMenu">
    <div class="settings-box">
        <strong>‚öôÔ∏è C√†i ƒë·∫∑t</strong><hr>
        T·ªëc ƒë·ªô: <input type="range" id="rate" min="0.5" max="1.3" step="0.1" value="0.9" style="width: 100px;"><br>
        <label><input type="checkbox" id="autoNext"> T·ª± ƒë·ªông chuy·ªÉn</label><br>
	<button onclick="toggleAllPinyin()" style="width: 100%; margin-top: 10px;">üî§ ·∫®n/Hi·ªán Pinyin</button>
        <button onclick="toggleDarkMode()" style="width: 100%; margin-top: 10px;">üåô Dark Mode</button>
    </div>
    <button class="btn-main-float" onclick="document.getElementById('floatMenu').classList.toggle('show-settings')">üõ†Ô∏è</button>
</div>

<script>
const sentences = [
  {
    cn_raw: `(‰∫å)ÊàëË∑ü‰Ω†‰∏ç‰∏ÄÊ†∑`,
    cn_split: `(‰∫å) - Êàë - Ë∑ü - ‰Ω† - ‰∏ç - ‰∏ÄÊ†∑`,
    cn_pos: `(num) - pron - prep - pron - adv - adj`,
    en_raw: `(2) I am different from you`,
    en_split: `(2) - I - am - different - from - you`,
    en_pos: `(num) - pron - v - adj - prep - pron`,
    vi: `(Hai) T√¥i kh√¥ng gi·ªëng b·∫°n`,
    pinyin: `(√àr) W«í gƒìn n«ê b√π yƒ´y√†ng`
  },
  {
    cn_raw: `È∫¶ÂÖã:ËøôÊ¨°‰Ω†ËÄÉÂæóÊÄé‰πàÊ†∑?`,
    cn_split: `È∫¶ÂÖã - ËøôÊ¨° - ‰Ω† - ËÄÉ - Âæó - ÊÄé‰πàÊ†∑`,
    cn_pos: `n - n - pron - v - part - pron`,
    en_raw: `Mike: How did you do on the exam this time?`,
    en_split: `Mike - How - did - you - do - on - the - exam - this - time`,
    en_pos: `n - adv - aux - pron - v - prep - art - n - det - n`,
    vi: `Mike: L·∫ßn n√†y b·∫°n thi th·∫ø n√†o?`,
    pinyin: `M√†ik√®: Zh√®c√¨ n«ê k«éo de zƒõnmey√†ng?`
  },
  {
    cn_raw: `Áéõ‰∏Ω:ËøòÂèØ‰ª•,ÁªºÂêàËØæËÄÉ‰∫Ü95ÂàÜ,Âê¨ÂäõË∑üÈòÖËØª‰∏ÄÊ†∑,ÈÉΩÊòØ90ÂàÜ,Âè£ËØ≠ËÄÉÂæó‰∏çÂ§™Â•Ω,Âè™ËÄÉ‰∫Ü85ÂàÜ„ÄÇ`,
    cn_split: `Áéõ‰∏Ω - Ëøò - ÂèØ‰ª• - ÁªºÂêà - ËØæ - ËÄÉ - ‰∫Ü - 95 - ÂàÜ - Âê¨Âäõ - Ë∑ü - ÈòÖËØª - ‰∏ÄÊ†∑ - ÈÉΩ - ÊòØ - 90 - ÂàÜ - Âè£ËØ≠ - ËÄÉ - Âæó - ‰∏ç - Â§™ - Â•Ω - Âè™ - ËÄÉ - ‰∫Ü - 85 - ÂàÜ`,
    cn_pos: `n - adv - adj - adj - n - v - part - num - mw - n - prep - n - adj - adv - v - num - mw - n - v - part - adv - adv - adj - adv - v - part - num - mw`,
    en_raw: `Mary: Not bad, I got 95 on the comprehensive course, listening is the same as reading, both are 90, speaking was not so good, I only got 85.`,
    en_split: `Mary - Not - bad - I - got - 95 - on - the - comprehensive - course - listening - is - the - same - as - reading - both - are - 90 - speaking - was - not - so - good - I - only - got - 85`,
    en_pos: `n - adv - adj - pron - v - num - prep - art - adj - n - n - v - art - adj - prep - n - pron - v - num - n - v - adv - adv - adj - pron - adv - v - num`,
    vi: `Mary: C≈©ng ƒë∆∞·ª£c, m√¥n t·ªïng h·ª£p thi ƒë∆∞·ª£c 95 ƒëi·ªÉm, nghe hi·ªÉu gi·ªëng v·ªõi ƒë·ªçc hi·ªÉu, ƒë·ªÅu l√† 90 ƒëi·ªÉm, kh·∫©u ng·ªØ thi kh√¥ng t·ªët l·∫Øm, ch·ªâ ƒë∆∞·ª£c 85 ƒëi·ªÉm.`,
    pinyin: `M«él√¨: H√°i kƒõy«ê, z≈çngh√© k√® k«éole ji«îsh√≠w«î fƒìn, tƒ´ngl√¨ gƒìn yu√®d√∫ yƒ´y√†ng, d≈çu sh√¨ ji«îsh√≠ fƒìn, k«íuy«î k«éo de b√π t√†i h«éo, zh«ê k«éole bƒÅsh√≠w«î fƒìn.`
  },
  {
    cn_raw: `‰Ω†Âë¢?`,
    cn_split: `‰Ω† - Âë¢`,
    cn_pos: `pron - part`,
    en_raw: `How about you?`,
    en_split: `How - about - you`,
    en_pos: `adv - prep - pron`,
    vi: `C√≤n b·∫°n th√¨ sao?`,
    pinyin: `N«ê ne?`
  },
  {
    cn_raw: `È∫¶ÂÖã:‰Ω†ÊØîÊàëËÄÉÂæóÂ•Ω„ÄÇ`,
    cn_split: `È∫¶ÂÖã - ‰Ω† - ÊØî - Êàë - ËÄÉ - Âæó - Â•Ω`,
    cn_pos: `n - pron - prep - pron - v - part - adj`,
    en_raw: `Mike: You did better than me on the exam.`,
    en_split: `Mike - You - did - better - than - me - on - the - exam`,
    en_pos: `n - pron - v - adj - prep - pron - prep - art - n`,
    vi: `Mike: B·∫°n thi t·ªët h∆°n m√¨nh.`,
    pinyin: `M√†ik√®: N«ê b«ê w«í k«éo de h«éo.`
  },
  {
    cn_raw: `ÊàëÁöÑÈòÖËØªË∑ü‰Ω†ËÄÉÂæó‰∏ÄÊ†∑,ÁªºÂêàËØæÂíåÂê¨ÂäõËØæÈÉΩÊ≤°Êúâ‰Ω†ËÄÉÂæóÂ•Ω,Âè™Âæó‰∫Ü80ÂàÜ„ÄÇ`,
    cn_split: `Êàë - ÁöÑ - ÈòÖËØª - Ë∑ü - ‰Ω† - ËÄÉ - Âæó - ‰∏ÄÊ†∑ - ÁªºÂêà - ËØæ - Âíå - Âê¨Âäõ - ËØæ - ÈÉΩ - Ê≤°Êúâ - ‰Ω† - ËÄÉ - Âæó - Â•Ω - Âè™ - Âæó - ‰∫Ü - 80 - ÂàÜ`,
    cn_pos: `pron - part - n - prep - pron - v - part - adj - adj - n - conj - n - n - adv - v - pron - v - part - adj - adv - v - part - num - mw`,
    en_raw: `My reading is the same as yours, but neither comprehensive nor listening is as good as yours, I only got 80.`,
    en_split: `My - reading - is - the - same - as - yours - but - neither - comprehensive - nor - listening - is - as - good - as - yours - I - only - got - 80`,
    en_pos: `pron - n - v - art - adj - prep - pron - conj - conj - adj - conj - n - v - adv - adj - prep - pron - pron - adv - v - num`,
    vi: `ƒê·ªçc hi·ªÉu c·ªßa m√¨nh gi·ªëng v·ªõi b·∫°n, m√¥n t·ªïng h·ª£p v√† m√¥n nghe ƒë·ªÅu kh√¥ng thi t·ªët b·∫±ng b·∫°n, ch·ªâ ƒë∆∞·ª£c 80 ƒëi·ªÉm.`,
    pinyin: `M√†ik√®: W«í de yu√®d√∫ gƒìn n«ê k«éo de yƒ´y√†ng, z≈çngh√© k√® h√© tƒ´ngl√¨ k√® d≈çu m√©iy«íu n«ê k«éo de h«éo, zh«ê d√©le bƒÅsh√≠ fƒìn.`
  },
  {
    cn_raw: `Áéõ‰∏Ω:Âê¨ÂÜôÊàëÊ≤°ËÄÉÂ•Ω,ÊúâÁöÑÊ±âÂ≠ó‰∏ç‰ºöÂÜô„ÄÇ`,
    cn_split: `Áéõ‰∏Ω - Âê¨ÂÜô - Êàë - Ê≤° - ËÄÉ - Â•Ω - ÊúâÁöÑ - Ê±âÂ≠ó - ‰∏ç - ‰ºö - ÂÜô`,
    cn_pos: `n - n - pron - adv - v - adj - pron - n - adv - v - v`,
    en_raw: `Mary: I didn't do well on the dictation, I couldn't write some Chinese characters.`,
    en_split: `Mary - I - did - not - do - well - on - the - dictation - I - could - not - write - some - Chinese - characters`,
    en_pos: `n - pron - v - adv - v - adv - prep - art - n - pron - v - adv - v - det - adj - n`,
    vi: `Mary: Ch√≠nh t·∫£ m√¨nh thi kh√¥ng t·ªët, c√≥ nh·ªØng ch·ªØ H√°n kh√¥ng bi·∫øt vi·∫øt.`,
    pinyin: `M«él√¨: Tƒ´ngxiƒõ w«í m√©i k«éo h«éo, y«íude h√†nz√¨ b√π hu√¨ xiƒõ.`
  },
  {
    cn_raw: `È∫¶ÂÖã:Â•Ω‰∫Ü,‰∏çË∞àËÄÉËØï‰∫Ü„ÄÇ`,
    cn_split: `È∫¶ÂÖã - Â•Ω‰∫Ü - ‰∏ç - Ë∞à - ËÄÉËØï - ‰∫Ü`,
    cn_pos: `n - adj - adv - v - n - part`,
    en_raw: `Mike: Okay, let's not talk about exams anymore.`,
    en_split: `Mike - Okay - let - us - not - talk - about - exams - anymore`,
    en_pos: `n - adj - v - pron - adv - v - prep - n - adv`,
    vi: `Mike: ƒê∆∞·ª£c r·ªìi, kh√¥ng b√†n chuy·ªán thi c·ª≠ n·ªØa.`,
    pinyin: `M√†ik√®: H«éole, b√π t√°n k«éosh√¨ le.`
  },
  {
    cn_raw: `ÊàëÈóÆ‰Ω†,Âë®Êú´Êúâ‰ªÄ‰πàÊâìÁÆó?`,
    cn_split: `Êàë - ÈóÆ - ‰Ω† - Âë®Êú´ - Êúâ - ‰ªÄ‰πà - ÊâìÁÆó`,
    cn_pos: `pron - v - pron - n - v - pron - n`,
    en_raw: `I ask you, what are your plans for the weekend?`,
    en_split: `I - ask - you - what - are - your - plans - for - the - weekend`,
    en_pos: `pron - v - pron - pron - v - pron - n - prep - art - n`,
    vi: `M√¨nh h·ªèi b·∫°n, cu·ªëi tu·∫ßn c√≥ d·ª± ƒë·ªãnh g√¨ kh√¥ng?`,
    pinyin: `W«í w√®n n«ê, zh≈çum√≤ y«íu sh√©me d«ésu√†n?`
  },
  {
    cn_raw: `Âá∫ÂéªÁé©ÂÑøÂêó?`,
    cn_split: `Âá∫Âéª - Áé©ÂÑø - Âêó`,
    cn_pos: `v - v - part`,
    en_raw: `Are you going out to play?`,
    en_split: `Are - you - going - out - to - play`,
    en_pos: `v - pron - v - adv - part - v`,
    vi: `C√≥ ƒëi ch∆°i kh√¥ng?`,
    pinyin: `Ch≈´q√π w√°nr ma?`
  },
  {
    cn_raw: `Áéõ‰∏Ω:Âá∫Âéª„ÄÇ`,
    cn_split: `Áéõ‰∏Ω - Âá∫Âéª`,
    cn_pos: `n - v`,
    en_raw: `Mary: Going out.`,
    en_split: `Mary - Going - out`,
    en_pos: `n - v - adv`,
    vi: `Mary: C√≥ ƒëi.`,
    pinyin: `M«él√¨: Ch≈´q√π.`
  },
  {
    cn_raw: `ÊúÄËøë,ÊàëÂ∏∏Âà∞ÂéÜÂè≤ÂçöÁâ©È¶ÜÂéªÂèÇËßÇ„ÄÇ`,
    cn_split: `ÊúÄËøë - Êàë - Â∏∏ - Âà∞ - ÂéÜÂè≤ - ÂçöÁâ©È¶Ü - Âéª - ÂèÇËßÇ`,
    cn_pos: `n - pron - adv - prep - n - n - v - v`,
    en_raw: `Recently, I often go to the History Museum to visit.`,
    en_split: `Recently - I - often - go - to - the - History - Museum - to - visit`,
    en_pos: `adv - pron - adv - v - prep - art - n - n - part - v`,
    vi: `D·∫°o n√†y, m√¨nh th∆∞·ªùng ƒë·∫øn B·∫£o t√†ng L·ªãch s·ª≠ ƒë·ªÉ tham quan.`,
    pinyin: `M«él√¨: Zu√¨j√¨n, w«í ch√°ng d√†o l√¨sh«ê b√≥w√πgu«én q√π cƒÅnguƒÅn.`
  },
  {
    cn_raw: `È∫¶ÂÖã:ÊòØÂêó?‰Ω†ÊÄé‰πàÂØπÂéÜÂè≤‰∫ßÁîüÂÖ¥Ë∂£‰∫Ü?`,
    cn_split: `È∫¶ÂÖã - ÊòØ - Âêó - ‰Ω† - ÊÄé‰πà - ÂØπ - ÂéÜÂè≤ - ‰∫ßÁîü - ÂÖ¥Ë∂£ - ‰∫Ü`,
    cn_pos: `n - v - part - pron - adv - prep - n - v - n - part`,
    en_raw: `Mike: Really? How did you become interested in history?`,
    en_split: `Mike - Really - How - did - you - become - interested - in - history`,
    en_pos: `n - adv - adv - aux - pron - v - adj - prep - n`,
    vi: `Mike: Th·∫ø √†? Sao b·∫°n l·∫°i n·∫£y sinh h·ª©ng th√∫ v·ªõi l·ªãch s·ª≠ v·∫≠y?`,
    pinyin: `M√†ik√®: Sh√¨ ma? N«ê zƒõnmey√†ng du√¨ l√¨sh«ê ch«énshƒìng x√¨ngq√π le?`
  },
  {
    cn_raw: `Áéõ‰∏Ω:Â≠¶‰∫Ü‰∫¨Ââß‰ª•Âêé,ÊàëÂ∞±ÂØπ‰∏≠ÂõΩÂéÜÂè≤‰∫ßÁîü‰∫ÜÂÖ¥Ë∂£„ÄÇ`,
    cn_split: `Áéõ‰∏Ω - Â≠¶ - ‰∫Ü - ‰∫¨Ââß - ‰ª•Âêé - Êàë - Â∞± - ÂØπ - ‰∏≠ÂõΩ - ÂéÜÂè≤ - ‰∫ßÁîü - ‰∫Ü - ÂÖ¥Ë∂£`,
    cn_pos: `n - v - part - n - n - pron - adv - prep - n - n - v - part - n`,
    en_raw: `Mary: After studying Peking Opera, I became interested in Chinese history.`,
    en_split: `Mary - After - studying - Peking - Opera - I - became - interested - in - Chinese - history`,
    en_pos: `n - prep - v - adj - n - pron - v - adj - prep - adj - n`,
    vi: `Mary: Sau khi h·ªçc Kinh k·ªãch, m√¨nh li·ªÅn n·∫£y sinh h·ª©ng th√∫ v·ªõi l·ªãch s·ª≠ Trung Qu·ªëc.`,
    pinyin: `M«él√¨: Xu√©le jƒ´ngj√π y«êh√≤u, w«í ji√π du√¨ Zh≈çnggu√≥ l√¨sh«ê ch«énshƒìngle x√¨ngq√π.`
  },
  {
    cn_raw: `Êúâ‰∏ÄÂ§©,ÊàëÂú®‰π¶Â∫ó‰π∞Âà∞‰∫Ü‰∏ÄÊú¨ÁîªÂÜå,ÊòØ‰ªãÁªç‰∏≠ÂõΩÂéÜÂè≤ÁöÑ„ÄÇ`,
    cn_split: `Êúâ - ‰∏ÄÂ§© - Êàë - Âú® - ‰π¶Â∫ó - ‰π∞ - Âà∞ - ‰∫Ü - ‰∏Ä - Êú¨ - ÁîªÂÜå - ÊòØ - ‰ªãÁªç - ‰∏≠ÂõΩ - ÂéÜÂè≤ - ÁöÑ`,
    cn_pos: `v - n - pron - prep - n - v - v - part - num - mw - n - v - v - n - n - part`,
    en_raw: `One day, I bought a picture album in the bookstore that introduces Chinese history.`,
    en_split: `One - day - I - bought - a - picture - album - in - the - bookstore - that - introduces - Chinese - history`,
    en_pos: `num - n - pron - v - art - n - n - prep - art - n - pron - v - adj - n`,
    vi: `C√≥ m·ªôt ng√†y, m√¨nh mua ƒë∆∞·ª£c m·ªôt cu·ªën s√°ch ·∫£nh ·ªü hi·ªáu s√°ch, l√† gi·ªõi thi·ªáu v·ªÅ l·ªãch s·ª≠ Trung Qu·ªëc.`,
    pinyin: `Y«íu yƒ´tiƒÅn, w«í z√†i sh≈´di√†n m«éid√†ole yƒ´ bƒõn hu√†c√®, sh√¨ ji√®sh√†o Zh≈çnggu√≥ l√¨sh«ê de.`
  },
  {
    cn_raw: `Áúã‰∫Ü‰ª•Âêé,ÊàëÂ∞±ÊÉ≥Âà∞ÂéÜÂè≤ÂçöÁâ©È¶ÜÂéªÁúãÁúã„ÄÇ`,
    cn_split: `Áúã - ‰∫Ü - ‰ª•Âêé - Êàë - Â∞± - ÊÉ≥ - Âà∞ - ÂéÜÂè≤ - ÂçöÁâ©È¶Ü - Âéª - ÁúãÁúã`,
    cn_pos: `v - part - n - pron - adv - v - prep - n - n - v - v`,
    en_raw: `After reading it, I wanted to go to the History Museum to take a look.`,
    en_split: `After - reading - it - I - wanted - to - go - to - the - History - Museum - to - take - a - look`,
    en_pos: `prep - v - pron - pron - v - part - v - prep - art - n - n - part - v - art - n`,
    vi: `Sau khi xem xong, m√¨nh li·ªÅn mu·ªën ƒë·∫øn b·∫£o t√†ng l·ªãch s·ª≠ ƒë·ªÉ xem th·ª≠.`,
    pinyin: `K√†nle y«êh√≤u, w«í ji√π xi«éng d√†o l√¨sh«ê b√≥w√πgu«én q√π k√†nkan.`
  },
  {
    cn_raw: `È∫¶ÂÖã:‰Ω†ÊâìÁÆóÁ†îÁ©∂‰∏≠ÂõΩÂéÜÂè≤Âêó?`,
    cn_split: `È∫¶ÂÖã - ‰Ω† - ÊâìÁÆó - Á†îÁ©∂ - ‰∏≠ÂõΩ - ÂéÜÂè≤ - Âêó`,
    cn_pos: `n - pron - v - v - n - n - part`,
    en_raw: `Mike: Do you plan to study Chinese history?`,
    en_split: `Mike - Do - you - plan - to - study - Chinese - history`,
    en_pos: `n - aux - pron - v - part - v - adj - n`,
    vi: `Mike: B·∫°n ƒë·ªãnh nghi√™n c·ª©u l·ªãch s·ª≠ Trung Qu·ªëc √†?`,
    pinyin: `M√†ik√®: N«ê d«ésu√†n y√°nji≈´ Zh≈çnggu√≥ l√¨sh«ê ma?`
  },
  {
    cn_raw: `Áéõ‰∏Ω:‰∏ç,ÊàëÂè™ÊòØÂØπ‰∏≠ÂõΩÂéÜÂè≤ÊÑüÂÖ¥Ë∂£„ÄÇ`,
    cn_split: `Áéõ‰∏Ω - ‰∏ç - Êàë - Âè™ÊòØ - ÂØπ - ‰∏≠ÂõΩ - ÂéÜÂè≤ - ÊÑü - ÂÖ¥Ë∂£`,
    cn_pos: `n - adv - pron - adv - prep - n - n - v - n`,
    en_raw: `Mary: No, I am just interested in Chinese history.`,
    en_split: `Mary - No - I - am - just - interested - in - Chinese - history`,
    en_pos: `n - adv - pron - v - adv - adj - prep - adj - n`,
    vi: `Mary: Kh√¥ng, m√¨nh ch·ªâ l√† c√≥ h·ª©ng th√∫ v·ªõi l·ªãch s·ª≠ Trung Qu·ªëc th√¥i.`,
    pinyin: `M«él√¨: B√π, w«í zh«êsh√¨ du√¨ Zh≈çnggu√≥ l√¨sh«ê g«én x√¨ngq√π.`
  },
  {
    cn_raw: `È∫¶ÂÖã:ÊàëË∑ü‰Ω†‰∏ç‰∏ÄÊ†∑,‰Ω†ÂñúÊ¨¢ËÄÅÁöÑ,ÊàëÂñúÊ¨¢Êñ∞ÁöÑ„ÄÇ`,
    cn_split: `È∫¶ÂÖã - Êàë - Ë∑ü - ‰Ω† - ‰∏ç - ‰∏ÄÊ†∑ - ‰Ω† - ÂñúÊ¨¢ - ËÄÅ - ÁöÑ - Êàë - ÂñúÊ¨¢ - Êñ∞ - ÁöÑ`,
    cn_pos: `n - pron - prep - pron - adv - adj - pron - v - adj - part - pron - v - adj - part`,
    en_raw: `Mike: I am different from you, you like the old ones, I like the new ones.`,
    en_split: `Mike - I - am - different - from - you - you - like - the - old - ones - I - like - the - new - ones`,
    en_pos: `n - pron - v - adj - prep - pron - pron - v - art - adj - n - pron - v - art - adj - n`,
    vi: `Mike: M√¨nh kh√¥ng gi·ªëng b·∫°n, b·∫°n th√≠ch c√°i c≈©, m√¨nh th√≠ch c√°i m·ªõi.`,
    pinyin: `M√†ik√®: W«í gƒìn n«ê b√π yƒ´y√†ng, n«ê x«êhuƒÅn l«éo de, w«í x«êhuƒÅn xƒ´n de.`
  },
  {
    cn_raw: `ÊàëÂØπ‰∏≠ÂõΩÊîπÈù©ÂºÄÊîæ‰ª•ÂêéÁöÑ‰∏ÄÂàáÈÉΩÂæàÊÑüÂÖ¥Ë∂£„ÄÇ`,
    cn_split: `Êàë - ÂØπ - ‰∏≠ÂõΩ - ÊîπÈù© - ÂºÄÊîæ - ‰ª•Âêé - ÁöÑ - ‰∏ÄÂàá - ÈÉΩ - Âæà - ÊÑü - ÂÖ¥Ë∂£`,
    cn_pos: `pron - prep - n - v - v - n - part - pron - adv - adv - v - n`,
    en_raw: `I am very interested in everything since China's reform and opening up.`,
    en_split: `I - am - very - interested - in - everything - since - China's - reform - and - opening - up`,
    en_pos: `pron - v - adv - adj - prep - pron - prep - n - n - conj - v - adv`,
    vi: `M√¨nh r·∫•t c√≥ h·ª©ng th√∫ v·ªõi t·∫•t c·∫£ m·ªçi th·ª© sau khi Trung Qu·ªëc c·∫£i c√°ch m·ªü c·ª≠a.`,
    pinyin: `W«í du√¨ Zh≈çnggu√≥ g«éig√© kƒÅif√†ng y«êh√≤u de yƒ´qi√® d≈çu hƒõn g«én x√¨ngq√π.`
  }
];
// C·∫≠p nh·∫≠t h√†m render ƒë·ªÉ truy·ªÅn d·ªØ li·ªáu an to√†n h∆°n
function renderBook() {
    const container = document.getElementById('bookContent');
    sentences.forEach((s, i) => {
        const item = document.createElement('div');
        item.className = 'sentence-item';
        item.innerHTML = `
            <div class="text-content">
                <div class="row-cn">
                    <span id="cn-txt-${i}">${s.cn_raw}</span>
                </div>
                <div id="cn-pos-${i}" class="pos-tag hidden">${s.cn_pos}</div>
                <div id="pinyin-${i}" class="pinyin-row hidden">${s.pinyin || ''}</div>
                <div class="row-en">
                    <span id="en-txt-${i}">${s.en_raw}</span>
                </div>
                <div id="en-pos-${i}" class="pos-tag hidden">${s.en_pos}</div>
                <div class="row-vi">${s.vi}</div>
            </div>
            <div class="control-sidebar">
                <button class="btn-icon" onclick="playSpeech(${i}, 'cn')">‚ôò</button>
                <button class="btn-icon" onclick="toggleMode(${i}, 'cn')">‚ôî</button>
                <button class="btn-icon" onclick="playSpeech(${i}, 'en')">‚ôñ</button>
                <button class="btn-icon" onclick="toggleMode(${i}, 'en')">‚ôï</button>
            </div>
        `;
        container.appendChild(item);
    });
}
// H√†m ph√°t √¢m m·ªõi: L·∫•y d·ªØ li·ªáu tr·ª±c ti·∫øp t·ª´ m·∫£ng thay v√¨ truy·ªÅn chu·ªói qua HTML
// H√†m ph√°t √¢m: T·ª± ƒë·ªông duy tr√¨ ng√¥n ng·ªØ ƒëang ch·ªçn
function playSpeech(index, langType) {
    // 1. D·ª´ng m·ªçi √¢m thanh ƒëang ph√°t ƒë·ªÉ tr√°nh ch·ªìng ch√©o
    window.speechSynthesis.cancel(); 

    let textToRead = "";
    let langCode = "";

    // 2. X√°c ƒë·ªãnh n·ªôi dung v√† m√£ ng√¥n ng·ªØ d·ª±a tr√™n l·ª±a ch·ªçn c·ªßa ng∆∞·ªùi d√πng
    if (langType === 'cn') {
        textToRead = sentences[index].cn_raw;
        langCode = 'zh-CN';
    } else {
        textToRead = sentences[index].en_raw;
        langCode = 'en-US';
    }

    const msg = new SpeechSynthesisUtterance();
    msg.text = textToRead;
    msg.lang = langCode;
    msg.rate = document.getElementById('rate').value;
    
    // 3. Hi·ªáu ·ª©ng Highlight: T√¥ m√†u c√¢u ƒëang ƒë·ªçc ƒë·ªÉ d·ªÖ theo d√µi
    const allItems = document.getElementsByClassName('sentence-item');
    // X√≥a m√†u c·ªßa t·∫•t c·∫£ c√°c c√¢u kh√°c
    Array.from(allItems).forEach(item => item.style.backgroundColor = "transparent");
    // T√¥ m√†u v√†ng nh·∫°t cho c√¢u hi·ªán t·∫°i
    allItems[index].style.backgroundColor = "rgba(230, 126, 34, 0.1)";

    // 4. X·ª≠ l√Ω khi k·∫øt th√∫c c√¢u
    msg.onend = () => {
        const isAuto = document.getElementById('autoNext').checked;
        if (isAuto && index < sentences.length - 1) {
            setTimeout(() => {
                // QUAN TR·ªåNG: Truy·ªÅn ƒë√∫ng langType hi·ªán t·∫°i v√†o l·∫ßn g·ªçi ti·∫øp theo
                playSpeech(index + 1, langType); 
                
                // T·ª± ƒë·ªông cu·ªôn m√†n h√¨nh ƒë·∫øn c√¢u ti·∫øp theo
                allItems[index + 1].scrollIntoView({
                    behavior: "smooth", 
                    block: "center"
                });
            }, 500); // Ngh·ªâ 0.5 gi√¢y gi·ªØa c√°c c√¢u ƒë·ªÉ ng∆∞·ªùi d√πng k·ªãp ng·∫•m
        }
    };

    window.speechSynthesis.speak(msg);
}
function toggleMode(index, lang) {
    const txtSpan = document.getElementById(`${lang}-txt-${index}`);
    const posSpan = document.getElementById(`${lang}-pos-${index}`);
    const isOriginal = txtSpan.innerText === sentences[index][`${lang}_raw`];

    txtSpan.innerText = isOriginal ? sentences[index][`${lang}_split`] : sentences[index][`${lang}_raw`];
    posSpan.classList.toggle('hidden');
}

function toggleDarkMode() {
    document.body.classList.toggle('dark-mode');
}

function toggleAllPinyin() {
    // 1. L·∫•y t·∫•t c·∫£ c√°c ph·∫ßn t·ª≠ c√≥ class l√† pinyin-row
    const pinyinElements = document.getElementsByClassName('pinyin-row');
    
    // 2. Ki·ªÉm tra n·∫øu kh√¥ng t√¨m th·∫•y ph·∫ßn t·ª≠ n√†o (b√°o l·ªói ra Console ƒë·ªÉ ki·ªÉm tra)
    if (pinyinElements.length === 0) {
        console.error("Kh√¥ng t√¨m th·∫•y ph·∫ßn t·ª≠ n√†o c√≥ class 'pinyin-row'");
        return;
    }

    // 3. Duy·ªát qua t·ª´ng ph·∫ßn t·ª≠ v√† b·∫≠t/t·∫Øt class 'hidden'
    for (let i = 0; i < pinyinElements.length; i++) {
        pinyinElements[i].classList.toggle('hidden');
    }
}

function speak(text, lang, index) {
    window.speechSynthesis.cancel();
    const msg = new SpeechSynthesisUtterance(text);
    msg.lang = lang;
    msg.rate = document.getElementById('rate').value;

    msg.onend = () => {
        if (document.getElementById('autoNext').checked && index < sentences.length - 1) {
            setTimeout(() => {
                speak(sentences[index + 1].cn_raw, 'zh-CN', index + 1);
                document.getElementsByClassName('sentence-item')[index+1].scrollIntoView({behavior: "smooth", block: "center"});
            }, 1200);
        }
    };
    window.speechSynthesis.speak(msg);
}

renderBook();
</script>
</body>
</html>