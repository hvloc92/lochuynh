<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200..900&display=swap" rel="stylesheet">
    <title>S√°ch ƒêa Ng√¥n Ng·ªØ</title>
    <style>
        :root {
            --bg-body: #dcdcdc;
            --bg-book: #f4f1ea;
            --text-main: #1a1a1a;
            --text-sub: #555;
            --accent: #e67e22;
            --border: #d1ccc0;
        }

        /* Ch·∫ø ƒë·ªô Dark Mode */
        .dark-mode {
            --bg-body: #1a1a1b;
            --bg-book: #2c2c2e;
            --text-main: #e1e1e1;
            --text-sub: #b0b0b0;
            --accent: #f39c12;
            --border: #444;
        }

        body { 
            margin: 0; padding: 0;
            background-color: var(--bg-body);
            color: var(--text-main);
            transition: all 0.3s ease;
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        }

        .book-container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            background: var(--bg-book);
            min-height: 100vh;
            padding-top: 20px;
        }

        .sentence-item {
            display: flex;
            padding: 20px 5%; /* L·ªÅ tr√°i 5% theo y√™u c·∫ßu */
            border-bottom: 1px solid var(--border);
            word-wrap: break-word; /* T·ª± ƒë·ªông xu·ªëng d√≤ng */
        }

        .text-content {
            flex: 1;
            padding-right: 15px;
        }

        .row-cn { font-family: "Noto Serif SC","Segoe UI", Tahoma, Geneva, Verdana, sans-serif; font-size: 1.8rem; font-weight: normal; margin-bottom: 8px; line-height: 1.4; }
        .row-en { font-size: 1.2rem; margin-bottom: 5px; color: var(--text-main); opacity: 0.9; }
        .row-vi { font-size: 1rem; color: var(--text-sub); font-style: italic; }
        
        .pos-tag { font-size: 0.85rem; color: var(--accent); display: block; margin-top: 4px; font-weight: normal; }

        /* Ph√≠m ch·ª©c nƒÉng d·∫°ng c·ªôt icon */
        .control-sidebar {
            display: flex;
            flex-direction: column;
            gap: 8px;
            width: 45px;
            align-items: center;
        }

        .btn-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 1px solid var(--border);
            background: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: 0.2s;
        }
        .btn-icon:hover { background: #eee; transform: scale(1.1); }

        /* Menu n·ªïi c·ªë ƒë·ªãnh ·ªü g√≥c d∆∞·ªõi b√™n ph·∫£i */
        .floating-menu {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 10px;
            z-index: 1000;
        }

        .settings-box {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            display: none; /* ·∫®n m·∫∑c ƒë·ªãnh */
            color: #333;
            font-size: 14px;
        }

        .show-settings .settings-box { display: block; }

        .btn-main-float {
            width: 50px;
            height: 50px;
            background: #34495e;
            color: white;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            font-size: 24px;
        }

	/* Th√™m v√†o trong th·∫ª <style> */
	.pinyin-row {
    		font-size: 16px;
		font-weight: normal;
   		color: #27ae60; /* M√†u xanh l√° d·ªãu m·∫Øt */
    		display: block;
    		margin-top: 2px;
	}


        .hidden { display: none !important; }

    </style>
</head>
<body>

<div class="book-container" id="bookContent">
    </div>

<div class="floating-menu" id="floatMenu">
    <div class="settings-box">
        <strong>‚öôÔ∏è C√†i ƒë·∫∑t</strong><hr>
        T·ªëc ƒë·ªô: <input type="range" id="rate" min="0.5" max="1.3" step="0.1" value="0.9" style="width: 100px;"><br>
        <label><input type="checkbox" id="autoNext"> T·ª± ƒë·ªông chuy·ªÉn</label><br>
	<button onclick="toggleAllPinyin()" style="width: 100%; margin-top: 10px;">üî§ ·∫®n/Hi·ªán Pinyin</button>
        <button onclick="toggleDarkMode()" style="width: 100%; margin-top: 10px;">üåô Dark Mode</button>
    </div>
    <button class="btn-main-float" onclick="document.getElementById('floatMenu').classList.toggle('show-settings')">üõ†Ô∏è</button>
</div>

<script>
const sentences = [
  {
    cn_raw: `(‰∏Ä)Âåó‰∫¨ÊØî‰∏äÊµ∑Â§ßÂêß`,
    cn_split: `(‰∏Ä) - Âåó‰∫¨ - ÊØî - ‰∏äÊµ∑ - Â§ß - Âêß`,
    cn_pos: `(num) - n - prep - n - adj - part`,
    en_raw: `(1) Beijing is bigger than Shanghai, right?`,
    en_split: `(1) - Beijing - is - bigger - than - Shanghai - right`,
    en_pos: `(num) - n - v - adj - prep - n - adj`,
    vi: `(M·ªôt) B·∫Øc Kinh l·ªõn h∆°n Th∆∞·ª£ng H·∫£i nh·ªâ?`,
    pinyin: `(Yƒ´) Bƒõijƒ´ng b«ê Sh√†ngh«éi d√† ba`
  },
  {
    cn_raw: `Â±±Êú¨:Áî∞Ëä≥,‰∏äÊµ∑ÊÄé‰πàÊ†∑?`,
    cn_split: `Â±±Êú¨ - Áî∞Ëä≥ - ‰∏äÊµ∑ - ÊÄé‰πàÊ†∑`,
    cn_pos: `n - n - n - pron`,
    en_raw: `Yamamoto: Tian Fang, how is Shanghai?`,
    en_split: `Yamamoto - Tian - Fang - how - is - Shanghai`,
    en_pos: `n - n - n - adv - v - n`,
    vi: `S∆°n B·∫£n: ƒêi·ªÅn Ph∆∞∆°ng, Th∆∞·ª£ng H·∫£i th·∫ø n√†o?`,
    pinyin: `ShƒÅnbƒõn: Ti√°n FƒÅng, Sh√†ngh«éi zƒõnmey√†ng?`
  },
  {
    cn_raw: `ÊàëÊÉ≥ÂùêÁÅ´ËΩ¶Âéª‰∏äÊµ∑ÊóÖË°å„ÄÇ`,
    cn_split: `Êàë - ÊÉ≥ - Âùê - ÁÅ´ËΩ¶ - Âéª - ‰∏äÊµ∑ - ÊóÖË°å`,
    cn_pos: `pron - v - v - n - v - n - v`,
    en_raw: `I want to take a train to Shanghai for travel.`,
    en_split: `I - want - to - take - a - train - to - Shanghai - for - travel`,
    en_pos: `pron - v - part - v - art - n - prep - n - prep - v`,
    vi: `T√¥i mu·ªën ƒëi t√†u h·ªèa ƒë·∫øn Th∆∞·ª£ng H·∫£i du l·ªãch.`,
    pinyin: `W«í xi«éng zu√≤ hu«íchƒì q√π Sh√†ngh«éi l«öx√≠ng.`
  },
  {
    cn_raw: `Áî∞Ëä≥:‰∏äÊµ∑ÂæàÂ•Ω,ËøôÂá†Âπ¥ÂèòÂåñÂæàÂ§ß„ÄÇ`,
    cn_split: `Áî∞Ëä≥ - ‰∏äÊµ∑ - Âæà - Â•Ω - Ëøô - Âá† - Âπ¥ - ÂèòÂåñ - Âæà - Â§ß`,
    cn_pos: `n - n - adv - adj - pron - num - mw - n - adv - adj`,
    en_raw: `Tian Fang: Shanghai is very good, it has changed a lot in recent years.`,
    en_split: `Tian - Fang - Shanghai - is - very - good - it - has - changed - a - lot - in - recent - years`,
    en_pos: `n - n - n - v - adv - adj - pron - v - v - art - n - prep - adj - n`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: Th∆∞·ª£ng H·∫£i r·∫•t t·ªët, m·∫•y nƒÉm nay thay ƒë·ªïi r·∫•t l·ªõn.`,
    pinyin: `Ti√°n FƒÅng: Sh√†ngh«éi hƒõn h«éo, zh√® j«ê ni√°n bi√†nhu√† hƒõn d√†.`
  },
  {
    cn_raw: `‰ªäÂπ¥ÊöëÂÅáÊàëËøòÂú®ÈÇ£ÂÑøÁé©‰∫Ü‰∏Ä‰∏™Â§öÊúàÂë¢„ÄÇ`,
    cn_split: `‰ªäÂπ¥ - ÊöëÂÅá - Êàë - Ëøò - Âú® - ÈÇ£ÂÑø - Áé© - ‰∫Ü - ‰∏Ä‰∏™Â§öÊúà - Âë¢`,
    cn_pos: `n - n - pron - adv - prep - pron - v - part - num - mw - part`,
    en_raw: `During this summer vacation, I also played there for more than a month.`,
    en_split: `During - this - summer - vacation - I - also - played - there - for - more - than - a - month`,
    en_pos: `prep - det - adj - n - pron - adv - v - adv - prep - adj - num - n`,
    vi: `K·ª≥ ngh·ªâ h√® nƒÉm nay t√¥i c√≤n ·ªü ƒë√≥ ch∆°i h∆°n m·ªôt th√°ng c∆°.`,
    pinyin: `Jƒ´nni√°n sh«îji√† w«í h√°i z√†i n√†'er w√°nle yƒ´g√® du≈ç yu√® ne.`
  },
  {
    cn_raw: `ÊàëÁöÑ‰∏Ä‰∏™ÂêåÂ≠¶ÂÆ∂Â∞±Âú®‰∏äÊµ∑„ÄÇ`,
    cn_split: `Êàë - ÁöÑ - ‰∏Ä‰∏™ - ÂêåÂ≠¶ - ÂÆ∂ - Â∞± - Âú® - ‰∏äÊµ∑`,
    cn_pos: `pron - part - num - mw - n - n - adv - v - n`,
    en_raw: `A classmate's home of mine is right in Shanghai.`,
    en_split: `A - classmate's - home - of - mine - is - right - in - Shanghai`,
    en_pos: `art - n - n - prep - pron - v - adv - prep - n`,
    vi: `Nh√† m·ªôt ng∆∞·ªùi b·∫°n h·ªçc c·ªßa t√¥i ·ªü ngay Th∆∞·ª£ng H·∫£i.`,
    pinyin: `W«í de yƒ´g√® t√≥ngxu√© jiƒÅ ji√π z√†i Sh√†ngh«éi.`
  },
  {
    cn_raw: `Â±±Êú¨:‰∏äÊµ∑ÊØîÂåó‰∫¨Â§ßÂêß?`,
    cn_split: `Â±±Êú¨ - ‰∏äÊµ∑ - ÊØî - Âåó‰∫¨ - Â§ß - Âêß`,
    cn_pos: `n - n - prep - n - adj - part`,
    en_raw: `Yamamoto: Is Shanghai bigger than Beijing?`,
    en_split: `Yamamoto - Is - Shanghai - bigger - than - Beijing`,
    en_pos: `n - v - n - adj - prep - n`,
    vi: `S∆°n B·∫£n: Th∆∞·ª£ng H·∫£i l·ªõn h∆°n B·∫Øc Kinh nh·ªâ?`,
    pinyin: `ShƒÅnbƒõn: Sh√†ngh«éi b«ê Bƒõijƒ´ng d√† ba?`
  },
  {
    cn_raw: `Áî∞Ëä≥:‰∏ç,‰∏äÊµ∑Ê≤°ÊúâÂåó‰∫¨Â§ß,‰∏çËøá‰∫∫Âè£ÊØîÂåó‰∫¨Â§ö„ÄÇ`,
    cn_split: `Áî∞Ëä≥ - ‰∏ç - ‰∏äÊµ∑ - Ê≤°Êúâ - Âåó‰∫¨ - Â§ß - ‰∏çËøá - ‰∫∫Âè£ - ÊØî - Âåó‰∫¨ - Â§ö`,
    cn_pos: `n - adv - n - v - n - adj - conj - n - prep - n - adj`,
    en_raw: `Tian Fang: No, Shanghai is not as big as Beijing, but the population is more than Beijing.`,
    en_split: `Tian - Fang - No - Shanghai - is - not - as - big - as - Beijing - but - the - population - is - more - than - Beijing`,
    en_pos: `n - n - adv - n - v - adv - adv - adj - prep - n - conj - art - n - v - adj - prep - n`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: Kh√¥ng, Th∆∞·ª£ng H·∫£i kh√¥ng l·ªõn b·∫±ng B·∫Øc Kinh, nh∆∞ng d√¢n s·ªë ƒë√¥ng h∆°n B·∫Øc Kinh.`,
    pinyin: `Ti√°n FƒÅng: B√π, Sh√†ngh«éi m√©iy«íu Bƒõijƒ´ng d√†, b√πgu√≤ r√©nk«íu b«ê Bƒõijƒ´ng du≈ç.`
  },
  {
    cn_raw: `‰∏äÊµ∑ÊòØ‰∏≠ÂõΩ‰∫∫Âè£ÊúÄÂ§öÁöÑÂüéÂ∏Ç„ÄÇ`,
    cn_split: `‰∏äÊµ∑ - ÊòØ - ‰∏≠ÂõΩ - ‰∫∫Âè£ - ÊúÄ - Â§ö - ÁöÑ - ÂüéÂ∏Ç`,
    cn_pos: `n - v - n - n - adv - adj - part - n`,
    en_raw: `Shanghai is the city with the most population in China.`,
    en_split: `Shanghai - is - the - city - with - the - most - population - in - China`,
    en_pos: `n - v - art - n - prep - art - adj - n - prep - n`,
    vi: `Th∆∞·ª£ng H·∫£i l√† th√†nh ph·ªë ƒë√¥ng d√¢n nh·∫•t Trung Qu·ªëc.`,
    pinyin: `Sh√†ngh«éi sh√¨ Zh≈çnggu√≥ r√©nk«íu zu√¨du≈ç de ch√©ngsh√¨.`
  },
  {
    cn_raw: `ËøôÂá†Âπ¥,Â¢ûÂä†‰∫Ü‰∏çÂ∞ëÊñ∞Âª∫Á≠ë,‰∏äÊµ∑ÊØîËøáÂéªÂèòÂæóÊõ¥ÊºÇ‰∫Æ‰∫Ü„ÄÇ`,
    cn_split: `Ëøô - Âá† - Âπ¥ - Â¢ûÂä† - ‰∫Ü - ‰∏çÂ∞ë - Êñ∞ - Âª∫Á≠ë - ‰∏äÊµ∑ - ÊØî - ËøáÂéª - ÂèòÂæó - Êõ¥ - ÊºÇ‰∫Æ - ‰∫Ü`,
    cn_pos: `pron - num - mw - v - part - adj - adj - n - n - prep - n - v - adv - adj - part`,
    en_raw: `In recent years, many new buildings have been added, Shanghai has become more beautiful than in the past.`,
    en_split: `In - recent - years - many - new - buildings - have - been - added - Shanghai - has - become - more - beautiful - than - in - the - past`,
    en_pos: `prep - adj - n - adj - adj - n - v - v - v - n - v - v - adv - adj - prep - prep - art - n`,
    vi: `M·∫•y nƒÉm nay, ƒë√£ tƒÉng th√™m kh√¥ng √≠t ki·∫øn tr√∫c m·ªõi, Th∆∞·ª£ng H·∫£i so v·ªõi tr∆∞·ªõc ƒë√¢y ƒë√£ tr·ªü n√™n ƒë·∫πp h∆°n r·ªìi.`,
    pinyin: `Zh√® j«ê ni√°n, zƒìngjiƒÅle b√π sh«éo xƒ´n ji√†nzh√π, Sh√†ngh«éi b«ê gu√≤q√π bi√†n de g√®ng pi√†oliang le.`
  },
  {
    cn_raw: `Â±±Êú¨:‰∏äÊµ∑ÁöÑÂÖ¨Âõ≠ÊúâÂåó‰∫¨ÁöÑÂ§öÂêó?`,
    cn_split: `Â±±Êú¨ - ‰∏äÊµ∑ - ÁöÑ - ÂÖ¨Âõ≠ - Êúâ - Âåó‰∫¨ - ÁöÑ - Â§ö - Âêó`,
    cn_pos: `n - n - part - n - v - n - part - adj - part`,
    en_raw: `Yamamoto: Are there as many parks in Shanghai as in Beijing?`,
    en_split: `Yamamoto - Are - there - as - many - parks - in - Shanghai - as - in - Beijing`,
    en_pos: `n - v - adv - adj - adj - n - prep - n - prep - prep - n`,
    vi: `S∆°n B·∫£n: C√¥ng vi√™n ·ªü Th∆∞·ª£ng H·∫£i c√≥ nhi·ªÅu nh∆∞ ·ªü B·∫Øc Kinh kh√¥ng?`,
    pinyin: `ShƒÅnbƒõn: Sh√†ngh«éi de g≈çngyu√°n y«íu Bƒõijƒ´ng de du≈ç ma?`
  },
  {
    cn_raw: `Áî∞Ëä≥:‰∏äÊµ∑ÁöÑÂÖ¨Âõ≠Ê≤°ÊúâÂåó‰∫¨ÁöÑÂ§ö,‰πüÊ≤°ÊúâÂåó‰∫¨ÁöÑÂÖ¨Âõ≠Ëøô‰πàÂ§ß„ÄÇ`,
    cn_split: `Áî∞Ëä≥ - ‰∏äÊµ∑ - ÁöÑ - ÂÖ¨Âõ≠ - Ê≤°Êúâ - Âåó‰∫¨ - ÁöÑ - Â§ö - ‰πü - Ê≤°Êúâ - Âåó‰∫¨ - ÁöÑ - ÂÖ¨Âõ≠ - Ëøô‰πà - Â§ß`,
    cn_pos: `n - n - part - n - v - n - part - adj - adv - v - n - part - n - pron - adj`,
    en_raw: `Tian Fang: Parks in Shanghai are not as many as those in Beijing, and they are not as big as the parks in Beijing.`,
    en_split: `Tian - Fang - Parks - in - Shanghai - are - not - as - many - as - those - in - Beijing - and - they - are - not - as - big - as - the - parks - in - Beijing`,
    en_pos: `n - n - n - prep - n - v - adv - adv - adj - prep - pron - prep - n - conj - pron - v - adv - adv - adj - prep - art - n - prep - n`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: C√¥ng vi√™n c·ªßa Th∆∞·ª£ng H·∫£i kh√¥ng nhi·ªÅu b·∫±ng c·ªßa B·∫Øc Kinh, c≈©ng kh√¥ng l·ªõn nh∆∞ c√¥ng vi√™n c·ªßa B·∫Øc Kinh.`,
    pinyin: `Ti√°n FƒÅng: Sh√†ngh«éi de g≈çngyu√°n m√©iy«íu Bƒõijƒ´ng de du≈ç, yƒõ m√©iy«íu Bƒõijƒ´ng de g≈çngyu√°n zh√®me d√†.`
  },
  {
    cn_raw: `Â±±Êú¨:‰∏äÊµ∑ÁöÑÂÜ¨Â§©ÊòØ‰∏çÊòØÊØîÂåó‰∫¨ÊöñÂíå‰∏ÄÁÇπÂÑø?`,
    cn_split: `Â±±Êú¨ - ‰∏äÊµ∑ - Ïùò - ÂÜ¨Â§© - ÊòØ‰∏çÊòØ - ÊØî - Âåó‰∫¨ - ÊöñÂíå - ‰∏ÄÁÇπÂÑø`,
    cn_pos: `n - n - part - n - v - prep - n - adj - num - mw`,
    en_raw: `Yamamoto: Is the winter in Shanghai a bit warmer than in Beijing?`,
    en_split: `Yamamoto - Is - the - winter - in - Shanghai - a - bit - warmer - than - in - Beijing`,
    en_pos: `n - v - art - n - prep - n - art - n - adj - prep - prep - n`,
    vi: `S∆°n B·∫£n: M√πa ƒë√¥ng ·ªü Th∆∞·ª£ng H·∫£i c√≥ ph·∫£i ·∫•m √°p h∆°n B·∫Øc Kinh m·ªôt ch√∫t kh√¥ng?`,
    pinyin: `ShƒÅnbƒõn: Sh√†ngh«éi de d≈çngtiƒÅn sh√¨ b√π sh√¨ b«ê Bƒõijƒ´ng nu«énhuo yƒ´di«éner?`
  },
  {
    cn_raw: `Áî∞Ëä≥:‰∏äÊµ∑‰∏ç‰∏ÄÂÆöÊØîÂåó‰∫¨ÊöñÂíå„ÄÇ`,
    cn_split: `Áî∞Ëä≥ - ‰∏äÊµ∑ - ‰∏ç - ‰∏ÄÂÆö - ÊØî - Âåó‰∫¨ - ÊöñÂíå`,
    cn_pos: `n - n - adv - adv - prep - n - adj`,
    en_raw: `Tian Fang: Shanghai is not necessarily warmer than Beijing.`,
    en_split: `Tian - Fang - Shanghai - is - not - necessarily - warmer - than - Beijing`,
    en_pos: `n - n - n - v - adv - adv - adj - prep - n`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: Th∆∞·ª£ng H·∫£i kh√¥ng nh·∫•t ƒë·ªãnh ·∫•m h∆°n B·∫Øc Kinh.`,
    pinyin: `Ti√°n FƒÅng: Sh√†ngh«éi b√π yƒ´d√¨ng b«ê Bƒõijƒ´ng nu«énhuo.`
  },
  {
    cn_raw: `Â±±Êú¨:ÂèØÊòØ,ÊàëÁúãÂ§©Ê∞îÈ¢ÑÊä•,‰∏äÊµ∑ÁöÑÊ∞îÊ∏©ÊØîÂåó‰∫¨È´òÂæóÂ§ö„ÄÇ`,
    cn_split: `Â±±Êú¨ - ÂèØÊòØ - Êàë - Áúã - Â§©Ê∞î - È¢ÑÊä• - ‰∏äÊµ∑ - ÁöÑ - Ê∞îÊ∏© - ÊØî - Âåó‰∫¨ - È´ò - Âæó - Â§ö`,
    cn_pos: `n - conj - pron - v - n - n - n - part - n - prep - n - adj - part - adj`,
    en_raw: `Yamamoto: But, I watch the weather forecast, the temperature in Shanghai is much higher than in Beijing.`,
    en_split: `Yamamoto - But - I - watch - the - weather - forecast - the - temperature - in - Shanghai - is - much - higher - than - in - Beijing`,
    en_pos: `n - conj - pron - v - art - n - n - art - n - prep - n - v - adv - adj - prep - prep - n`,
    vi: `S∆°n B·∫£n: Nh∆∞ng m√†, t√¥i xem d·ª± b√°o th·ªùi ti·∫øt, nhi·ªát ƒë·ªô c·ªßa Th∆∞·ª£ng H·∫£i cao h∆°n B·∫Øc Kinh nhi·ªÅu.`,
    pinyin: `ShƒÅnbƒõn: Kƒõsh√¨, w«í k√†n tiƒÅnq√¨ y√πb√†o, Sh√†ngh«éi de q√¨wƒìn b«ê Bƒõijƒ´ng gƒÅo de du≈ç.`
  },
  {
    cn_raw: `Áî∞Ëä≥:ÊòØ,‰∏äÊµ∑ÁöÑÊ∞îÊ∏©ÊØîÂåó‰∫¨È´òÂ•ΩÂá†Â∫¶,‰∏çËøáÂõ†‰∏∫Â±ãÂ≠êÈáåÊ≤°ÊúâÊöñÊ∞î,ÊâÄ‰ª•ÊÑüËßâËøòÊ≤°ÊúâÂåó‰∫¨ÊöñÂíå„ÄÇ`,
    cn_split: `Áî∞Ëä≥ - ÊòØ - ‰∏äÊµ∑ - ÁöÑ - Ê∞îÊ∏© - ÊØî - Âåó‰∫¨ - È´ò - Â•Ω - Âá† - Â∫¶ - ‰∏çËøá - Âõ†‰∏∫ - Â±ãÂ≠ê - Èáå - Ê≤°Êúâ - ÊöñÊ∞î - ÊâÄ‰ª• - ÊÑüËßâ - Ëøò - Ê≤°Êúâ - Âåó‰∫¨ - ÊöñÂíå`,
    cn_pos: `n - v - n - part - n - prep - n - adj - adv - num - mw - conj - conj - n - n - v - n - conj - v - adv - v - n - adj`,
    en_raw: `Tian Fang: Yes, the temperature in Shanghai is several degrees higher than in Beijing, but because there is no heating in the room, it feels not as warm as Beijing.`,
    en_split: `Tian - Fang - Yes - the - temperature - in - Shanghai - is - several - degrees - higher - than - in - Beijing - but - because - there - is - no - heating - in - the - room - it - feels - not - as - warm - as - Beijing`,
    en_pos: `n - n - adv - art - n - prep - n - v - adj - n - adj - prep - prep - n - conj - conj - adv - v - det - n - prep - art - n - pron - v - adv - adv - adj - prep - n`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: ƒê√∫ng v·∫≠y, nhi·ªát ƒë·ªô Th∆∞·ª£ng H·∫£i cao h∆°n B·∫Øc Kinh m·∫•y ƒë·ªô, nh∆∞ng v√¨ trong ph√≤ng kh√¥ng c√≥ l√≤ s∆∞·ªüi, cho n√™n c·∫£m gi√°c v·∫´n kh√¥ng ·∫•m b·∫±ng B·∫Øc Kinh.`,
    pinyin: `Ti√°n FƒÅng: Sh√¨, Sh√†ngh«éi de q√¨wƒìn b«ê Bƒõijƒ´ng gƒÅo h«éoj«ê d√π, b√πgu√≤ yƒ´nw√®i w≈´zi l«ê m√©iy«íu nu«énq√¨, su«íy«ê g«énju√© h√°i m√©iy«íu Bƒõijƒ´ng nu«énhuo.`
  },
  {
    cn_raw: `Â±±Êú¨:‰∏äÊµ∑‰∫∫ÂÆ∂ÈáåÊ≤°ÊúâÊöñÊ∞î?`,
    cn_split: `Â±±Êú¨ - ‰∏äÊµ∑ - ‰∫∫ - ÂÆ∂ - Èáå - Ê≤°Êúâ - ÊöñÊ∞î`,
    cn_pos: `n - n - n - n - n - v - n`,
    en_raw: `Yamamoto: There is no heating in people's homes in Shanghai?`,
    en_split: `Yamamoto - There - is - no - heating - in - people's - homes - in - Shanghai`,
    en_pos: `n - adv - v - det - n - prep - n - n - prep - n`,
    vi: `S∆°n B·∫£n: Trong nh√† ng∆∞·ªùi Th∆∞·ª£ng H·∫£i kh√¥ng c√≥ l√≤ s∆∞·ªüi sao?`,
    pinyin: `ShƒÅnbƒõn: Sh√†ngh«éi r√©n jiƒÅl«ê m√©iy«íu nu«énq√¨?`
  },
  {
    cn_raw: `Áî∞Ëä≥:‰∏ÄËà¨ÁöÑÂÆ∂Â∫≠Ê≤°Êúâ,‰∏çËøáÊóÖÈ¶ÜÂíåÈ•≠Â∫óÈáåÊúâ„ÄÇ`,
    cn_split: `Áî∞Ëä≥ - ‰∏ÄËà¨ÁöÑ - ÂÆ∂Â∫≠ - Ê≤°Êúâ - ‰∏çËøá - ÊóÖÈ¶Ü - Âíå - È•≠Â∫ó - Èáå - Êúâ`,
    cn_pos: `n - adj - n - v - conj - n - conj - n - n - v`,
    en_raw: `Tian Fang: Ordinary families don't have it, but hotels and restaurants do.`,
    en_split: `Tian - Fang - Ordinary - families - don't - have - it - but - hotels - and - restaurants - do`,
    en_pos: `n - n - adj - n - v - v - pron - conj - n - conj - n - v`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: Gia ƒë√¨nh b√¨nh th∆∞·ªùng kh√¥ng c√≥, nh∆∞ng trong kh√°ch s·∫°n v√† nh√† h√†ng th√¨ c√≥.`,
    pinyin: `Ti√°n FƒÅng: Yƒ´bƒÅn de jiƒÅt√≠ng m√©iy«íu, b√πgu√≤ l«ögu«én h√© f√†ndi√†n l«ê y«íu.`
  }
];

// C·∫≠p nh·∫≠t h√†m render ƒë·ªÉ truy·ªÅn d·ªØ li·ªáu an to√†n h∆°n
function renderBook() {
    const container = document.getElementById('bookContent');
    sentences.forEach((s, i) => {
        const item = document.createElement('div');
        item.className = 'sentence-item';
        item.innerHTML = `
            <div class="text-content">
                <div class="row-cn">
                    <span id="cn-txt-${i}">${s.cn_raw}</span>
                </div>
                <div id="cn-pos-${i}" class="pos-tag hidden">${s.cn_pos}</div>
		<p>
                <div id="pinyin-${i}" class="pinyin-row hidden">${s.pinyin || ''}</div>
                <div class="row-en">
                    <span id="en-txt-${i}">${s.en_raw}</span>
                </div>
                <div id="en-pos-${i}" class="pos-tag hidden">${s.en_pos}</div>
                <p>
                <div class="row-vi">${s.vi}</div>
            </div>
            <div class="control-sidebar">
                <button class="btn-icon" onclick="playSpeech(${i}, 'cn')">üó£Ô∏è</button>
                <button class="btn-icon" onclick="toggleMode(${i}, 'cn')">üß©</button>
                <button class="btn-icon" onclick="playSpeech(${i}, 'en')">üîä</button>
                <button class="btn-icon" onclick="toggleMode(${i}, 'en')">üîç</button>
            </div>
        `;
        container.appendChild(item);
    });
}
// H√†m ph√°t √¢m m·ªõi: L·∫•y d·ªØ li·ªáu tr·ª±c ti·∫øp t·ª´ m·∫£ng thay v√¨ truy·ªÅn chu·ªói qua HTML
// H√†m ph√°t √¢m: T·ª± ƒë·ªông duy tr√¨ ng√¥n ng·ªØ ƒëang ch·ªçn
function playSpeech(index, langType) {
    // 1. D·ª´ng m·ªçi √¢m thanh ƒëang ph√°t ƒë·ªÉ tr√°nh ch·ªìng ch√©o
    window.speechSynthesis.cancel(); 

    let textToRead = "";
    let langCode = "";

    // 2. X√°c ƒë·ªãnh n·ªôi dung v√† m√£ ng√¥n ng·ªØ d·ª±a tr√™n l·ª±a ch·ªçn c·ªßa ng∆∞·ªùi d√πng
    if (langType === 'cn') {
        textToRead = sentences[index].cn_raw;
        langCode = 'zh-CN';
    } else {
        textToRead = sentences[index].en_raw;
        langCode = 'en-US';
    }

    const msg = new SpeechSynthesisUtterance();
    msg.text = textToRead;
    msg.lang = langCode;
    msg.rate = document.getElementById('rate').value;
    
    // 3. Hi·ªáu ·ª©ng Highlight: T√¥ m√†u c√¢u ƒëang ƒë·ªçc ƒë·ªÉ d·ªÖ theo d√µi
    const allItems = document.getElementsByClassName('sentence-item');
    // X√≥a m√†u c·ªßa t·∫•t c·∫£ c√°c c√¢u kh√°c
    Array.from(allItems).forEach(item => item.style.backgroundColor = "transparent");
    // T√¥ m√†u v√†ng nh·∫°t cho c√¢u hi·ªán t·∫°i
    allItems[index].style.backgroundColor = "rgba(230, 126, 34, 0.1)";

    // 4. X·ª≠ l√Ω khi k·∫øt th√∫c c√¢u
    msg.onend = () => {
        const isAuto = document.getElementById('autoNext').checked;
        if (isAuto && index < sentences.length - 1) {
            setTimeout(() => {
                // QUAN TR·ªåNG: Truy·ªÅn ƒë√∫ng langType hi·ªán t·∫°i v√†o l·∫ßn g·ªçi ti·∫øp theo
                playSpeech(index + 1, langType); 
                
                // T·ª± ƒë·ªông cu·ªôn m√†n h√¨nh ƒë·∫øn c√¢u ti·∫øp theo
                allItems[index + 1].scrollIntoView({
                    behavior: "smooth", 
                    block: "center"
                });
            }, 500); // Ngh·ªâ 0.5 gi√¢y gi·ªØa c√°c c√¢u ƒë·ªÉ ng∆∞·ªùi d√πng k·ªãp ng·∫•m
        }
    };

    window.speechSynthesis.speak(msg);
}
function toggleMode(index, lang) {
    const txtSpan = document.getElementById(`${lang}-txt-${index}`);
    const posSpan = document.getElementById(`${lang}-pos-${index}`);
    const isOriginal = txtSpan.innerText === sentences[index][`${lang}_raw`];

    txtSpan.innerText = isOriginal ? sentences[index][`${lang}_split`] : sentences[index][`${lang}_raw`];
    posSpan.classList.toggle('hidden');
}

function toggleDarkMode() {
    document.body.classList.toggle('dark-mode');
}

function toggleAllPinyin() {
    // 1. L·∫•y t·∫•t c·∫£ c√°c ph·∫ßn t·ª≠ c√≥ class l√† pinyin-row
    const pinyinElements = document.getElementsByClassName('pinyin-row');
    
    // 2. Ki·ªÉm tra n·∫øu kh√¥ng t√¨m th·∫•y ph·∫ßn t·ª≠ n√†o (b√°o l·ªói ra Console ƒë·ªÉ ki·ªÉm tra)
    if (pinyinElements.length === 0) {
        console.error("Kh√¥ng t√¨m th·∫•y ph·∫ßn t·ª≠ n√†o c√≥ class 'pinyin-row'");
        return;
    }

    // 3. Duy·ªát qua t·ª´ng ph·∫ßn t·ª≠ v√† b·∫≠t/t·∫Øt class 'hidden'
    for (let i = 0; i < pinyinElements.length; i++) {
        pinyinElements[i].classList.toggle('hidden');
    }
}

function speak(text, lang, index) {
    window.speechSynthesis.cancel();
    const msg = new SpeechSynthesisUtterance(text);
    msg.lang = lang;
    msg.rate = document.getElementById('rate').value;

    msg.onend = () => {
        if (document.getElementById('autoNext').checked && index < sentences.length - 1) {
            setTimeout(() => {
                speak(sentences[index + 1].cn_raw, 'zh-CN', index + 1);
                document.getElementsByClassName('sentence-item')[index+1].scrollIntoView({behavior: "smooth", block: "center"});
            }, 1200);
        }
    };
    window.speechSynthesis.speak(msg);
}

renderBook();
</script>
</body>
</html>