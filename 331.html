<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200..900&display=swap" rel="stylesheet">
    <title>S√°ch ƒêa Ng√¥n Ng·ªØ</title>
    <style>
        :root {
            --bg-body: #dcdcdc;
            --bg-book: #f4f1ea;
            --text-main: #1a1a1a;
            --text-sub: #555;
            --accent: #e67e22;
            --border: #d1ccc0;
        }

        /* Ch·∫ø ƒë·ªô Dark Mode */
        .dark-mode {
            --bg-body: #1a1a1b;
            --bg-book: #2c2c2e;
            --text-main: #e1e1e1;
            --text-sub: #b0b0b0;
            --accent: #f39c12;
            --border: #444;
        }

        body { 
            margin: 0; padding: 0;
            background-color: var(--bg-body);
            color: var(--text-main);
            transition: all 0.3s ease;
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        }

        .book-container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            background: var(--bg-book);
            min-height: 100vh;
            padding-top: 20px;
        }

        .sentence-item {
            display: flex;
            padding: 20px 5%; /* L·ªÅ tr√°i 5% theo y√™u c·∫ßu */
            border-bottom: 1px solid var(--border);
            word-wrap: break-word; /* T·ª± ƒë·ªông xu·ªëng d√≤ng */
        }

        .text-content {
            flex: 1;
            padding-right: 15px;
        }

        .row-cn { font-family: "Noto Serif SC","Segoe UI", Tahoma, Geneva, Verdana, sans-serif; font-size: 1.8rem; font-weight: normal; margin-bottom: 20px; line-height: 1.4; }
        .row-en { font-size: 1.2rem; margin-bottom: 20px; color: var(--text-main); opacity: 0.9; }
        .row-vi { font-size: 1rem; color: var(--text-sub); font-style: italic; }
        
        .pos-tag { font-size: 0.85rem; color: var(--accent); display: block; margin-bottom: 20px; margin-top: 0px; font-weight: normal; }

        /* Ph√≠m ch·ª©c nƒÉng d·∫°ng c·ªôt icon */
        .control-sidebar {
            display: flex;
            flex-direction: column;
            gap: 8px;
            width: 45px;
            align-items: center;
        }

        .btn-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 1px solid var(--border);
            background: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: 0.2s;
        }
        .btn-icon:hover { background: #eee; transform: scale(1.1); }

        /* Menu n·ªïi c·ªë ƒë·ªãnh ·ªü g√≥c d∆∞·ªõi b√™n ph·∫£i */
        .floating-menu {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 10px;
            z-index: 1000;
        }

        .settings-box {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            display: none; /* ·∫®n m·∫∑c ƒë·ªãnh */
            color: #333;
            font-size: 14px;
        }

        .show-settings .settings-box { display: block; }

        .btn-main-float {
            width: 50px;
            height: 50px;
            background: #34495e;
            color: white;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            font-size: 24px;
        }

	/* Th√™m v√†o trong th·∫ª <style> */
	.pinyin-row {
    		font-size: 16px;
		font-weight: normal;
   		color: #27ae60; /* M√†u xanh l√° d·ªãu m·∫Øt */
    		display: block;
    		margin-top: 0px;
		margin-bottom: 20px;
	}


        .hidden { display: none !important; }

    </style>
</head>
<body>

<div class="book-container" id="bookContent">
    </div>

<div class="floating-menu" id="floatMenu">
    <div class="settings-box">
        <strong>‚öôÔ∏è C√†i ƒë·∫∑t</strong><hr>
        T·ªëc ƒë·ªô: <input type="range" id="rate" min="0.5" max="1.3" step="0.1" value="0.9" style="width: 100px;"><br>
        <label><input type="checkbox" id="autoNext"> T·ª± ƒë·ªông chuy·ªÉn</label><br>
	<button onclick="toggleAllPinyin()" style="width: 100%; margin-top: 10px;">üî§ ·∫®n/Hi·ªán Pinyin</button>
        <button onclick="toggleDarkMode()" style="width: 100%; margin-top: 10px;">üåô Dark Mode</button>
    </div>
    <button class="btn-main-float" onclick="document.getElementById('floatMenu').classList.toggle('show-settings')">üõ†Ô∏è</button>
</div>

<script>
const sentences = [
  {
    cn_raw: `(‰∏Ä)Âø´Ëµ∞Âêß,Ë¶Å‰∏äËØæ‰∫Ü`,
    cn_split: `(‰∏Ä) - Âø´ - Ëµ∞ - Âêß - Ë¶Å - ‰∏äËØæ - ‰∫Ü`,
    cn_pos: `Num - Adv - V - Part - Adv - V - Part`,
    en_raw: `(1) Hurry up, class is about to start`,
    en_split: `(1) - Hurry - up - class - is - about - to - start`,
    en_pos: `Num - V - Adv - N - V - Prep - Part - V`,
    vi: `(M·ªôt) Mau ƒëi th√¥i, s·∫Øp v√†o l·ªõp r·ªìi`,
    pinyin: `(Yƒ´) Ku√†i z«íu ba, y√†o sh√†ngk√® le`
  },
  {
    cn_raw: `(ÂéªÊïôÂÆ§ÁöÑË∑Ø‰∏ä)`,
    cn_split: `Âéª - ÊïôÂÆ§ - ÁöÑ - Ë∑Ø‰∏ä`,
    cn_pos: `V - N - Part - N`,
    en_raw: `(On the way to the classroom)`,
    en_split: `On - the - way - to - the - classroom`,
    en_pos: `Prep - Art - N - Prep - Art - N`,
    vi: `(Tr√™n ƒë∆∞·ªùng ƒë·∫øn ph√≤ng h·ªçc)`,
    pinyin: `(Q√π ji√†osh√¨ de l√πsh√†ng)`
  },
  {
    cn_raw: `Áî∞Ëä≥:Âïä,ÂàÆÈ£é‰∫Ü„ÄÇ`,
    cn_split: `Áî∞Ëä≥ - Âïä - ÂàÆÈ£é - ‰∫Ü`,
    cn_pos: `N - Part - V - Part`,
    en_raw: `Tian Fang: Ah, it's windy now.`,
    en_split: `Tian - Fang - Ah - it - is - windy - now`,
    en_pos: `N - N - Part - Pr - V - Adj - Adv`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: A, gi√≥ n·ªïi l√™n r·ªìi.`,
    pinyin: `Ti√°n FƒÅng: √Ä, guƒÅfƒìng le.`
  },
  {
    cn_raw: `‰ªäÂ§©Â§©Ê∞îÁúüÂÜ∑„ÄÇ`,
    cn_split: `‰ªäÂ§© - Â§©Ê∞î - Áúü - ÂÜ∑`,
    cn_pos: `N - N - Adv - Adj`,
    en_raw: `The weather is really cold today.`,
    en_split: `The - weather - is - really - cold - today`,
    en_pos: `Art - N - V - Adv - Adj - N`,
    vi: `Th·ªùi ti·∫øt h√¥m nay th·∫≠t l·∫°nh.`,
    pinyin: `Jƒ´ntiƒÅn tiƒÅnq√¨ zhƒìn lƒõng.`
  },
  {
    cn_raw: `Âº†‰∏ú:ÂÜ¨Â§©Âø´Ë¶ÅÂà∞‰∫Ü„ÄÇ`,
    cn_split: `Âº†‰∏ú - ÂÜ¨Â§© - Âø´Ë¶Å - Âà∞ - ‰∫Ü`,
    cn_pos: `N - N - Adv - V - Part`,
    en_raw: `Zhang Dong: Winter is about to arrive.`,
    en_split: `Zhang - Dong - Winter - is - about - to - arrive`,
    en_pos: `N - N - N - V - Prep - Part - V`,
    vi: `Tr∆∞∆°ng ƒê√¥ng: M√πa ƒë√¥ng s·∫Øp ƒë·∫øn r·ªìi.`,
    pinyin: `ZhƒÅng D≈çng: D≈çngtiƒÅn ku√†y√†o d√†o le.`
  },
  {
    cn_raw: `Áî∞Ëä≥:Êàë‰∏çÂñúÊ¨¢ÂÜ¨Â§©„ÄÇ`,
    cn_split: `Áî∞Ëä≥ - Êàë - ‰∏ç - ÂñúÊ¨¢ - ÂÜ¨Â§©`,
    cn_pos: `N - Pr - Adv - V - N`,
    en_raw: `Tian Fang: I don't like winter.`,
    en_split: `Tian - Fang - I - do - not - like - winter`,
    en_pos: `N - N - Pr - V - Adv - V - N`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: T√¥i kh√¥ng th√≠ch m√πa ƒë√¥ng.`,
    pinyin: `Ti√°n FƒÅng: W«í b√π x«êhuƒÅn d≈çngtiƒÅn.`
  },
  {
    cn_raw: `Âº†‰∏ú:ÊàëÂñúÊ¨¢ÂÜ¨Â§©„ÄÇ`,
    cn_split: `Âº†‰∏ú - Êàë - ÂñúÊ¨¢ - ÂÜ¨Â§©`,
    cn_pos: `N - Pr - V - N`,
    en_raw: `Zhang Dong: I like winter.`,
    en_split: `Zhang - Dong - I - like - winter`,
    en_pos: `N - N - Pr - V - N`,
    vi: `Tr∆∞∆°ng ƒê√¥ng: T√¥i th√≠ch m√πa ƒë√¥ng.`,
    pinyin: `ZhƒÅng D≈çng: W«í x«êhuƒÅn d≈çngtiƒÅn.`
  },
  {
    cn_raw: `ÊàëÁà±ÊªëÂÜ∞,‰πüÁà±ÊªëÈõ™„ÄÇ`,
    cn_split: `Êàë - Áà± - ÊªëÂÜ∞ - ‰πü - Áà± - ÊªëÈõ™`,
    cn_pos: `Pr - V - V - Adv - V - V`,
    en_raw: `I love ice skating, and I also love skiing.`,
    en_split: `I - love - ice - skating - and - I - also - love - skiing`,
    en_pos: `Pr - V - N - V - Conj - Pr - Adv - V - V`,
    vi: `T√¥i y√™u tr∆∞·ª£t bƒÉng, c≈©ng y√™u tr∆∞·ª£t tuy·∫øt.`,
    pinyin: `W«í √†i hu√°bƒ´ng, yƒõ √†i hu√°xuƒõ.`
  },
  {
    cn_raw: `Êàë‰ª¨ÂÆ∂‰π°ÊúâÂ±±ÊúâÊ∞¥,ÊòØÊúâÂêçÁöÑÈ£éÊôØÂå∫„ÄÇ`,
    cn_split: `Êàë‰ª¨ - ÂÆ∂‰π° - Êúâ - Â±± - Êúâ - Ê∞¥ - ÊòØ - ÊúâÂêç - ÁöÑ - È£éÊôØÂå∫`,
    cn_pos: `Pr - N - V - N - V - N - V - Adj - Part - N`,
    en_raw: `My hometown has mountains and water, it is a famous scenic area.`,
    en_split: `My - hometown - has - mountains - and - water - it - is - a - famous - scenic - area`,
    en_pos: `Pr - N - V - N - Conj - N - Pr - V - Art - Adj - Adj - N`,
    vi: `Qu√™ h∆∞∆°ng ch√∫ng t√¥i c√≥ n√∫i c√≥ n∆∞·ªõc, l√† khu phong c·∫£nh n·ªïi ti·∫øng.`,
    pinyin: `W«ímen jiƒÅxiƒÅng y«íu shƒÅn y«íu shu«ê, sh√¨ y«íum√≠ng de fƒìngj«êngq≈´.`
  },
  {
    cn_raw: `Â§èÂ§©ÂèØ‰ª•Ê∏∏Ê≥≥,ÂÜ¨Â§©ÂèØ‰ª•ÊªëÈõ™,‰∏ÄÂπ¥ÂõõÂ≠£ÈÉΩÊúâÂéªÊóÖÊ∏∏ÁöÑ‰∫∫,`,
    cn_split: `Â§èÂ§© - ÂèØ‰ª• - Ê∏∏Ê≥≥ - ÂÜ¨Â§© - ÂèØ‰ª• - ÊªëÈõ™ - ‰∏Ä - Âπ¥ - Âõõ - Â≠£ - ÈÉΩ - Êúâ - Âéª - ÊóÖÊ∏∏ - ÁöÑ - ‰∫∫`,
    cn_pos: `N - V - V - N - V - V - Num - N - Num - N - Adv - V - V - V - Part - N`,
    en_raw: `You can swim in summer, ski in winter, there are people traveling all year round,`,
    en_split: `You - can - swim - in - summer - ski - in - winter - there - are - people - traveling - all - year - round`,
    en_pos: `Pr - V - V - Prep - N - V - Prep - N - Adv - V - N - V - Det - N - Adv`,
    vi: `M√πa h√® c√≥ th·ªÉ b∆°i l·ªôi, m√πa ƒë√¥ng c√≥ th·ªÉ tr∆∞·ª£t tuy·∫øt, b·ªën m√πa trong nƒÉm ƒë·ªÅu c√≥ ng∆∞·ªùi ƒëi du l·ªãch,`,
    pinyin: `Xi√†tiƒÅn kƒõy«ê y√≥uy«íng, d≈çngtiƒÅn kƒõy«ê hu√°xuƒõ, yƒ´ ni√°n s√¨j√¨ d≈çu y«íu q√π l«öy√≥u de r√©n,`
  },
  {
    cn_raw: `Â∞§ÂÖ∂ÊòØÂ§èÂ§©,Â±±ÈáåÂæàÂáâÂø´,ÂéªÈÅøÊöëÁöÑ‰∫∫ÁâπÂà´Â§ö„ÄÇ`,
    cn_split: `Â∞§ÂÖ∂ - ÊòØ - Â§èÂ§© - Â±± - Èáå - Âæà - ÂáâÂø´ - Âéª - ÈÅøÊöë - ÁöÑ - ‰∫∫ - ÁâπÂà´ - Â§ö`,
    cn_pos: `Adv - V - N - N - N - Adv - Adj - V - V - Part - N - Adv - Adj`,
    en_raw: `Especially in summer, it's cool in the mountains, and there are many people going to avoid the heat.`,
    en_split: `Especially - in - summer - it - is - cool - in - the - mountains - and - there - are - many - people - going - to - avoid - the - heat`,
    en_pos: `Adv - Prep - N - Pr - V - Adj - Prep - Art - N - Conj - Adv - V - Adj - N - V - Part - V - Art - N`,
    vi: `ƒê·∫∑c bi·ªát l√† m√πa h√®, trong n√∫i r·∫•t m√°t m·∫ª, ng∆∞·ªùi ƒëi tr√°nh n√≥ng ƒë·∫∑c bi·ªát ƒë√¥ng.`,
    pinyin: `Y√≥uq√≠ sh√¨ xi√†tiƒÅn, shƒÅnl«ê hƒõn li√°ngkuai, q√π b√¨sh«î de r√©n t√®bi√© du≈ç.`
  },
  {
    cn_raw: `ÂæàÂ§ö‰∫∫ÂÆ∂ÈÉΩÈù†ÁªèËê•ÊóÖÈ¶Ü„ÄÅÈ•≠Â∫óÂèë‰∫ÜË¥¢„ÄÇ`,
    cn_split: `ÂæàÂ§ö - ‰∫∫ÂÆ∂ - ÈÉΩ - Èù† - ÁªèËê• - ÊóÖÈ¶Ü - È•≠Â∫ó - ÂèëË¥¢ - ‰∫Ü`,
    cn_pos: `Adj - N - Adv - Prep - V - N - N - V - Part`,
    en_raw: `Many families have made a fortune by running hotels and restaurants.`,
    en_split: `Many - families - have - made - a - fortune - by - running - hotels - and - restaurants`,
    en_pos: `Adj - N - V - V - Art - N - Prep - V - N - Conj - N`,
    vi: `R·∫•t nhi·ªÅu h·ªô gia ƒë√¨nh ƒë·ªÅu d·ª±a v√†o kinh doanh kh√°ch s·∫°n, nh√† h√†ng m√† ph√°t t√†i.`,
    pinyin: `Hƒõndu≈ç r√©njiƒÅ d≈çu k√†o jƒ´ngy√≠ng l«ögu«én, f√†ndi√†n fƒÅle c√°i.`
  },
  {
    cn_raw: `Áî∞Ëä≥:ÊàëÂè™‰ºöÊªëÂÜ∞,‰∏ç‰ºöÊªëÈõ™„ÄÇ`,
    cn_split: `Áî∞Ëä≥ - Êàë - Âè™ - ‰ºö - ÊªëÂÜ∞ - ‰∏ç - ‰ºö - ÊªëÈõ™`,
    cn_pos: `N - Pr - Adv - V - V - Adv - V - V`,
    en_raw: `Tian Fang: I can only ice skate, I can't ski.`,
    en_split: `Tian - Fang - I - can - only - ice - skate - I - cannot - ski`,
    en_pos: `N - N - Pr - V - Adv - N - V - Pr - V - V`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: T√¥i ch·ªâ bi·∫øt tr∆∞·ª£t bƒÉng, kh√¥ng bi·∫øt tr∆∞·ª£t tuy·∫øt.`,
    pinyin: `Ti√°n FƒÅng: W«í zh«ê hu√¨ hu√°bƒ´ng, b√π hu√¨ hu√°xuƒõ.`
  },
  {
    cn_raw: `ÊàëÁúüÊÉ≥Âà∞‰Ω†‰ª¨ÂÆ∂‰π°ÂéªÂ≠¶Â≠¶ÊªëÈõ™„ÄÇ`,
    cn_split: `Êàë - Áúü - ÊÉ≥ - Âà∞ - ‰Ω†‰ª¨ - ÂÆ∂‰π° - Âéª - Â≠¶Â≠¶ - ÊªëÈõ™`,
    cn_pos: `Pr - Adv - V - Prep - Pr - N - V - V - V`,
    en_raw: `I really want to go to your hometown to learn to ski.`,
    en_split: `I - really - want - to - go - to - your - hometown - to - learn - to - ski`,
    en_pos: `Pr - Adv - V - Part - V - Prep - Pr - N - Part - V - Part - V`,
    vi: `T√¥i th·∫≠t s·ª± mu·ªën ƒë·∫øn qu√™ b·∫°n h·ªçc tr∆∞·ª£t tuy·∫øt m·ªôt ch√∫t.`,
    pinyin: `W«í zhƒìn xi«éng d√†o n«êmen jiƒÅxiƒÅng q√π xu√©xue hu√°xuƒõ.`
  },
  {
    cn_raw: `‰Ω†Áúã,Ê†ëÂè∂ÈÉΩÁ∫¢‰∫Ü„ÄÇ`,
    cn_split: `‰Ω† - Áúã - Ê†ëÂè∂ - ÈÉΩ - Á∫¢ - ‰∫Ü`,
    cn_pos: `Pr - V - N - Adv - Adj - Part`,
    en_raw: `Look, the leaves have all turned red.`,
    en_split: `Look - the - leaves - have - all - turned - red`,
    en_pos: `V - Art - N - V - Adv - V - Adj`,
    vi: `B·∫°n nh√¨n k√¨a, l√° c√¢y ƒë·ªÅu ƒë·ªè c·∫£ r·ªìi.`,
    pinyin: `N«ê k√†n, sh√πy√® d≈çu h√≥ng le.`
  },
  {
    cn_raw: `Á∫¢Âè∂Â§öÊºÇ‰∫Æ„ÄÇ`,
    cn_split: `Á∫¢Âè∂ - Â§ö - ÊºÇ‰∫Æ`,
    cn_pos: `N - Adv - Adj`,
    en_raw: `How beautiful the red leaves are.`,
    en_split: `How - beautiful - the - red - leaves - are`,
    en_pos: `Adv - Adj - Art - Adj - N - V`,
    vi: `L√° ƒë·ªè ƒë·∫πp bi·∫øt bao.`,
    pinyin: `H√≥ngy√® du≈ç pi√†oliang.`
  },
  {
    cn_raw: `Á≠â‰∏Ä‰∏ã,ÊàëÂéªÊç°Âá†ÁâáÁ∫¢Âè∂„ÄÇ`,
    cn_split: `Á≠â - ‰∏Ä‰∏ã - Êàë - Âéª - Êç° - Âá† - Áâá - Á∫¢Âè∂`,
    cn_pos: `V - Num - Pr - V - V - Num - M - N`,
    en_raw: `Wait a second, I'm going to pick up a few red leaves.`,
    en_split: `Wait - a - second - I - am - going - to - pick - up - a - few - red - leaves`,
    en_pos: `V - Art - N - Pr - V - V - Part - V - Adv - Art - Adj - Adj - N`,
    vi: `ƒê·ª£i m·ªôt ch√∫t, t√¥i ƒëi nh·∫∑t m·∫•y l√° ƒë·ªè.`,
    pinyin: `Dƒõng yƒ´xi√†, w«í q√π ji«én j«ê pi√†n h√≥ngy√®.`
  },
  {
    cn_raw: `Âº†‰∏ú:Âà´Êç°‰∫Ü,Âø´Ëµ∞Âêß,Ë¶Å‰∏äËØæ‰∫Ü„ÄÇ`,
    cn_split: `Âº†‰∏ú - Âà´ - Êç° - ‰∫Ü - Âø´ - Ëµ∞ - Âêß - Ë¶Å - ‰∏äËØæ - ‰∫Ü`,
    cn_pos: `N - Adv - V - Part - Adv - V - Part - Adv - V - Part`,
    en_raw: `Zhang Dong: Stop picking them, hurry up, class is about to start.`,
    en_split: `Zhang - Dong - Stop - picking - them - hurry - up - class - is - about - to - start`,
    en_pos: `N - N - V - V - Pr - V - Adv - N - V - Prep - Part - V`,
    vi: `Tr∆∞∆°ng ƒê√¥ng: ƒê·ª´ng nh·∫∑t n·ªØa, mau ƒëi th√¥i, s·∫Øp v√†o l·ªõp r·ªìi.`,
    pinyin: `ZhƒÅng D≈çng: Bi√© ji«én le, ku√†i z«íu ba, y√†o sh√†ngk√® le.`
  },
  {
    cn_raw: `Áî∞Ëä≥:ÁùÄ‰ªÄ‰πàÊÄ•,ËøòÊó©ÁùÄÂë¢„ÄÇ`,
    cn_split: `Áî∞Ëä≥ - ÁùÄ - ‰ªÄ‰πà - ÊÄ• - Ëøò - Êó© - ÁùÄ - Âë¢`,
    cn_pos: `N - V - Pr - Adj - Adv - Adj - Part - Part`,
    en_raw: `Tian Fang: Why the rush? It's still early.`,
    en_split: `Tian - Fang - Why - the - rush - It - is - still - early`,
    en_pos: `N - N - Adv - Art - N - Pr - V - Adv - Adj`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: G·∫•p c√°i g√¨, v·∫´n c√≤n s·ªõm m√†.`,
    pinyin: `Ti√°n FƒÅng: Zh√°o sh√©nme j√≠, h√°i z«éozhe ne.`
  },
  {
    cn_raw: `Âº†‰∏ú:‰Ω†ÁúãÁúãË°®,Âá†ÁÇπ‰∫Ü?`,
    cn_split: `Âº†‰∏ú - ‰Ω† - ÁúãÁúã - Ë°® - Âá† - ÁÇπ - ‰∫Ü`,
    cn_pos: `N - Pr - V - N - Num - N - Part`,
    en_raw: `Zhang Dong: Look at your watch, what time is it?`,
    en_split: `Zhang - Dong - Look - at - your - watch - what - time - is - it`,
    en_pos: `N - N - V - Prep - Pr - N - Adj - N - V - Pr`,
    vi: `Tr∆∞∆°ng ƒê√¥ng: B·∫°n nh√¨n ƒë·ªìng h·ªì xem, m·∫•y gi·ªù r·ªìi?`,
    pinyin: `ZhƒÅng D≈çng: N«ê k√†nkan bi«éo, j«ê di«én le?`
  },
  {
    cn_raw: `Áî∞Ëä≥:Âàö‰∏ÉÁÇπÂçä„ÄÇ`,
    cn_split: `Áî∞Ëä≥ - Âàö - ‰∏É - ÁÇπ - Âçä`,
    cn_pos: `N - Adv - Num - N - Num`,
    en_raw: `Tian Fang: Just 7:30.`,
    en_split: `Tian - Fang - Just - seven - thirty`,
    en_pos: `N - N - Adv - Num - Num`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: M·ªõi 7 gi·ªù r∆∞·ª°i.`,
    pinyin: `Ti√°n FƒÅng: GƒÅng qƒ´ di«én b√†n.`
  },
  {
    cn_raw: `Âº†‰∏ú:‰ªÄ‰πà?‰Ω†ÁöÑË°®ÊòØ‰∏çÊòØÂùè‰∫Ü?`,
    cn_split: `Âº†‰∏ú - ‰ªÄ‰πà - ‰Ω† - ÁöÑ - Ë°® - ÊòØ‰∏çÊòØ - Âùè - ‰∫Ü`,
    cn_pos: `N - Pr - Pr - Part - N - V - Adj - Part`,
    en_raw: `Zhang Dong: What? Is your watch broken?`,
    en_split: `Zhang - Dong - What - Is - your - watch - broken`,
    en_pos: `N - N - Pr - V - Pr - N - Adj`,
    vi: `Tr∆∞∆°ng ƒê√¥ng: C√°i g√¨? ƒê·ªìng h·ªì c·ªßa b·∫°n c√≥ ph·∫£i h·ªèng r·ªìi kh√¥ng?`,
    pinyin: `ZhƒÅng D≈çng: Sh√©nme? N«ê de bi«éo sh√¨bush√¨ hu√†i le?`
  },
  {
    cn_raw: `Áî∞Ëä≥:ÂìéÂëÄ,ÊàëÁöÑË°®ÂÅú‰∫Ü,ÂèØËÉΩÊ≤°Áîµ‰∫Ü,ËØ•Êç¢ÁîµÊ±†‰∫Ü„ÄÇ`,
    cn_split: `Áî∞Ëä≥ - ÂìéÂëÄ - Êàë - ÁöÑ - Ë°® - ÂÅú - ‰∫Ü - ÂèØËÉΩ - Ê≤° - Áîµ - ‰∫Ü - ËØ• - Êç¢ - ÁîµÊ±† - ‰∫Ü`,
    cn_pos: `N - Part - Pr - Part - N - V - Part - Adv - V - N - Part - Adv - V - N - Part`,
    en_raw: `Tian Fang: Oh no, my watch has stopped, maybe it's out of battery, it's time to change the battery.`,
    en_split: `Tian - Fang - Oh - no - my - watch - has - stopped - maybe - it - is - out - of - battery - it - is - time - to - change - the - battery`,
    en_pos: `N - N - Part - Adv - Pr - N - V - V - Adv - Pr - V - Prep - Prep - N - Pr - V - N - Part - V - Art - N`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: √Åi ch√†, ƒë·ªìng h·ªì c·ªßa t√¥i d·ª´ng r·ªìi, c√≥ l·∫Ω h·∫øt ƒëi·ªán r·ªìi, ƒë·∫øn l√∫c thay pin r·ªìi.`,
    pinyin: `Ti√°n FƒÅng: ƒÄiyƒÅ, w«í de bi«éo t√≠ng le, kƒõn√©ng m√©i di√†n le, gƒÅi hu√†n di√†nch√≠ le.`
  },
  {
    cn_raw: `‰ªÄ‰πàÊó∂Èó¥‰∫Ü?`,
    cn_split: `‰ªÄ‰πà - Êó∂Èó¥ - ‰∫Ü`,
    cn_pos: `Pr - N - Part`,
    en_raw: `What time is it?`,
    en_split: `What - time - is - it`,
    en_pos: `Adj - N - V - Pr`,
    vi: `M·∫•y gi·ªù r·ªìi?`,
    pinyin: `Sh√©nme sh√≠jiƒÅn le?`
  },
  {
    cn_raw: `Âº†‰∏ú:ÈÉΩ‰∏ÉÁÇπ‰∫îÂçÅ‰∫Ü„ÄÇ`,
    cn_split: `Âº†‰∏ú - ÈÉΩ - ‰∏É - ÁÇπ - ‰∫îÂçÅ - ‰∫Ü`,
    cn_pos: `N - Adv - Num - N - Num - Part`,
    en_raw: `Zhang Dong: It's already 7:50.`,
    en_split: `Zhang - Dong - It - is - already - seven - fifty`,
    en_pos: `N - N - Pr - V - Adv - Num - Num`,
    vi: `Tr∆∞∆°ng ƒê√¥ng: ƒê√£ 7 gi·ªù 50 r·ªìi.`,
    pinyin: `ZhƒÅng D≈çng: D≈çu qƒ´ di«én w«îsh√≠ le.`
  },
  {
    cn_raw: `Âø´Ëµ∞Âêß,ÂÜç‰∏çÂø´ÁÇπÂÑøÂ∞±ËøüÂà∞‰∫Ü„ÄÇ`,
    cn_split: `Âø´ - Ëµ∞ - Âêß - ÂÜç - ‰∏ç - Âø´ - ÁÇπÂÑø - Â∞± - ËøüÂà∞ - ‰∫Ü`,
    cn_pos: `Adv - V - Part - Adv - Adv - Adj - M - Adv - V - Part`,
    en_raw: `Hurry up, if we don't move faster, we'll be late.`,
    en_split: `Hurry - up - if - we - do - not - move - faster - we - will - be - late`,
    en_pos: `V - Adv - Conj - Pr - V - Adv - V - Adj - Pr - V - V - Adj`,
    vi: `Mau ƒëi th√¥i, kh√¥ng nhanh ch√∫t n·ªØa l√† mu·ªôn m·∫•t.`,
    pinyin: `Ku√†i z«íu ba, z√†i b√π ku√†i di«énr ji√π ch√≠d√†o le.`
  }
];
// C·∫≠p nh·∫≠t h√†m render ƒë·ªÉ truy·ªÅn d·ªØ li·ªáu an to√†n h∆°n
function renderBook() {
    const container = document.getElementById('bookContent');
    sentences.forEach((s, i) => {
        const item = document.createElement('div');
        item.className = 'sentence-item';
        item.innerHTML = `
            <div class="text-content">
                <div class="row-cn">
                    <span id="cn-txt-${i}">${s.cn_raw}</span>
                </div>
                <div id="cn-pos-${i}" class="pos-tag hidden">${s.cn_pos}</div>
                <div id="pinyin-${i}" class="pinyin-row hidden">${s.pinyin || ''}</div>
                <div class="row-en">
                    <span id="en-txt-${i}">${s.en_raw}</span>
                </div>
                <div id="en-pos-${i}" class="pos-tag hidden">${s.en_pos}</div>
                <div class="row-vi">${s.vi}</div>
            </div>
            <div class="control-sidebar">
                <button class="btn-icon" onclick="playSpeech(${i}, 'cn')">‚ôò</button>
                <button class="btn-icon" onclick="toggleMode(${i}, 'cn')">‚ôî</button>
                <button class="btn-icon" onclick="playSpeech(${i}, 'en')">‚ôñ</button>
                <button class="btn-icon" onclick="toggleMode(${i}, 'en')">‚ôï</button>
            </div>
        `;
        container.appendChild(item);
    });
}
// H√†m ph√°t √¢m m·ªõi: L·∫•y d·ªØ li·ªáu tr·ª±c ti·∫øp t·ª´ m·∫£ng thay v√¨ truy·ªÅn chu·ªói qua HTML
// H√†m ph√°t √¢m: T·ª± ƒë·ªông duy tr√¨ ng√¥n ng·ªØ ƒëang ch·ªçn
function playSpeech(index, langType) {
    // 1. D·ª´ng m·ªçi √¢m thanh ƒëang ph√°t ƒë·ªÉ tr√°nh ch·ªìng ch√©o
    window.speechSynthesis.cancel(); 

    let textToRead = "";
    let langCode = "";

    // 2. X√°c ƒë·ªãnh n·ªôi dung v√† m√£ ng√¥n ng·ªØ d·ª±a tr√™n l·ª±a ch·ªçn c·ªßa ng∆∞·ªùi d√πng
    if (langType === 'cn') {
        textToRead = sentences[index].cn_raw;
        langCode = 'zh-CN';
    } else {
        textToRead = sentences[index].en_raw;
        langCode = 'en-US';
    }

    const msg = new SpeechSynthesisUtterance();
    msg.text = textToRead;
    msg.lang = langCode;
    msg.rate = document.getElementById('rate').value;
    
    // 3. Hi·ªáu ·ª©ng Highlight: T√¥ m√†u c√¢u ƒëang ƒë·ªçc ƒë·ªÉ d·ªÖ theo d√µi
    const allItems = document.getElementsByClassName('sentence-item');
    // X√≥a m√†u c·ªßa t·∫•t c·∫£ c√°c c√¢u kh√°c
    Array.from(allItems).forEach(item => item.style.backgroundColor = "transparent");
    // T√¥ m√†u v√†ng nh·∫°t cho c√¢u hi·ªán t·∫°i
    allItems[index].style.backgroundColor = "rgba(230, 126, 34, 0.1)";

    // 4. X·ª≠ l√Ω khi k·∫øt th√∫c c√¢u
    msg.onend = () => {
        const isAuto = document.getElementById('autoNext').checked;
        if (isAuto && index < sentences.length - 1) {
            setTimeout(() => {
                // QUAN TR·ªåNG: Truy·ªÅn ƒë√∫ng langType hi·ªán t·∫°i v√†o l·∫ßn g·ªçi ti·∫øp theo
                playSpeech(index + 1, langType); 
                
                // T·ª± ƒë·ªông cu·ªôn m√†n h√¨nh ƒë·∫øn c√¢u ti·∫øp theo
                allItems[index + 1].scrollIntoView({
                    behavior: "smooth", 
                    block: "center"
                });
            }, 500); // Ngh·ªâ 0.5 gi√¢y gi·ªØa c√°c c√¢u ƒë·ªÉ ng∆∞·ªùi d√πng k·ªãp ng·∫•m
        }
    };

    window.speechSynthesis.speak(msg);
}
function toggleMode(index, lang) {
    const txtSpan = document.getElementById(`${lang}-txt-${index}`);
    const posSpan = document.getElementById(`${lang}-pos-${index}`);
    const isOriginal = txtSpan.innerText === sentences[index][`${lang}_raw`];

    txtSpan.innerText = isOriginal ? sentences[index][`${lang}_split`] : sentences[index][`${lang}_raw`];
    posSpan.classList.toggle('hidden');
}

function toggleDarkMode() {
    document.body.classList.toggle('dark-mode');
}

function toggleAllPinyin() {
    // 1. L·∫•y t·∫•t c·∫£ c√°c ph·∫ßn t·ª≠ c√≥ class l√† pinyin-row
    const pinyinElements = document.getElementsByClassName('pinyin-row');
    
    // 2. Ki·ªÉm tra n·∫øu kh√¥ng t√¨m th·∫•y ph·∫ßn t·ª≠ n√†o (b√°o l·ªói ra Console ƒë·ªÉ ki·ªÉm tra)
    if (pinyinElements.length === 0) {
        console.error("Kh√¥ng t√¨m th·∫•y ph·∫ßn t·ª≠ n√†o c√≥ class 'pinyin-row'");
        return;
    }

    // 3. Duy·ªát qua t·ª´ng ph·∫ßn t·ª≠ v√† b·∫≠t/t·∫Øt class 'hidden'
    for (let i = 0; i < pinyinElements.length; i++) {
        pinyinElements[i].classList.toggle('hidden');
    }
}

function speak(text, lang, index) {
    window.speechSynthesis.cancel();
    const msg = new SpeechSynthesisUtterance(text);
    msg.lang = lang;
    msg.rate = document.getElementById('rate').value;

    msg.onend = () => {
        if (document.getElementById('autoNext').checked && index < sentences.length - 1) {
            setTimeout(() => {
                speak(sentences[index + 1].cn_raw, 'zh-CN', index + 1);
                document.getElementsByClassName('sentence-item')[index+1].scrollIntoView({behavior: "smooth", block: "center"});
            }, 1200);
        }
    };
    window.speechSynthesis.speak(msg);
}

renderBook();
</script>
</body>
</html>