<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S√°ch ƒêa Ng√¥n Ng·ªØ</title>
    <style>
        :root {
            --bg-body: #dcdcdc;
            --bg-book: #f4f1ea;
            --text-main: #1a1a1a;
            --text-sub: #555;
            --accent: #e67e22;
            --border: #d1ccc0;
        }

        /* Ch·∫ø ƒë·ªô Dark Mode */
        .dark-mode {
            --bg-body: #1a1a1b;
            --bg-book: #2c2c2e;
            --text-main: #e1e1e1;
            --text-sub: #b0b0b0;
            --accent: #f39c12;
            --border: #444;
        }

        body { 
            margin: 0; padding: 0;
            background-color: var(--bg-body);
            color: var(--text-main);
            transition: all 0.3s ease;
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        }

        .book-container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            background: var(--bg-book);
            min-height: 100vh;
            padding-top: 20px;
        }

        .sentence-item {
            display: flex;
            padding: 20px 5%; /* L·ªÅ tr√°i 5% theo y√™u c·∫ßu */
            border-bottom: 1px solid var(--border);
            word-wrap: break-word; /* T·ª± ƒë·ªông xu·ªëng d√≤ng */
        }

        .text-content {
            flex: 1;
            padding-right: 15px;
        }

        .row-cn { font-size: 1.8rem; font-weight: normal; margin-bottom: 8px; line-height: 1.4; }
        .row-en { font-size: 1.2rem; margin-bottom: 5px; color: var(--text-main); opacity: 0.9; }
        .row-vi { font-size: 1rem; color: var(--text-sub); font-style: italic; }
        
        .pos-tag { font-size: 0.85rem; color: var(--accent); display: block; margin-top: 4px; font-weight: normal; }

        /* Ph√≠m ch·ª©c nƒÉng d·∫°ng c·ªôt icon */
        .control-sidebar {
            display: flex;
            flex-direction: column;
            gap: 8px;
            width: 45px;
            align-items: center;
        }

        .btn-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 1px solid var(--border);
            background: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: 0.2s;
        }
        .btn-icon:hover { background: #eee; transform: scale(1.1); }

        /* Menu n·ªïi c·ªë ƒë·ªãnh ·ªü g√≥c d∆∞·ªõi b√™n ph·∫£i */
        .floating-menu {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 10px;
            z-index: 1000;
        }

        .settings-box {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            display: none; /* ·∫®n m·∫∑c ƒë·ªãnh */
            color: #333;
            font-size: 14px;
        }

        .show-settings .settings-box { display: block; }

        .btn-main-float {
            width: 50px;
            height: 50px;
            background: #34495e;
            color: white;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            font-size: 24px;
        }

	/* Th√™m v√†o trong th·∫ª <style> */
	.pinyin-row {
    		font-size: 16px;
		font-weight: normal;
   		color: #27ae60; /* M√†u xanh l√° d·ªãu m·∫Øt */
    		display: block;
    		margin-top: 2px;
	}


        .hidden { display: none !important; }

    </style>
</head>
<body>

<div class="book-container" id="bookContent">
    </div>

<div class="floating-menu" id="floatMenu">
    <div class="settings-box">
        <strong>‚öôÔ∏è C√†i ƒë·∫∑t</strong><hr>
        T·ªëc ƒë·ªô: <input type="range" id="rate" min="0.5" max="1.3" step="0.1" value="0.9" style="width: 100px;"><br>
        <label><input type="checkbox" id="autoNext"> T·ª± ƒë·ªông chuy·ªÉn</label><br>
	<button onclick="toggleAllPinyin()" style="width: 100%; margin-top: 10px;">üî§ ·∫®n/Hi·ªán Pinyin</button>
        <button onclick="toggleDarkMode()" style="width: 100%; margin-top: 10px;">üåô Dark Mode</button>
    </div>
    <button class="btn-main-float" onclick="document.getElementById('floatMenu').classList.toggle('show-settings')">üõ†Ô∏è</button>
</div>

<script>
const sentences = [
  {
    cn_raw: `(‰∏Ä)Êàë‰ª¨ÈÇ£ÂÑøÁöÑÂÜ¨Â§©Ë∑üÂåó‰∫¨‰∏ÄÊ†∑ÂÜ∑`,
    cn_split: `(‰∏Ä) - Êàë‰ª¨ - ÈÇ£ÂÑø - ÁöÑ - ÂÜ¨Â§© - Ë∑ü - Âåó‰∫¨ - ‰∏ÄÊ†∑ - ÂÜ∑`,
    cn_pos: `(num) - pron - pron - part - n - prep - n - adj - adj`,
    en_raw: `(1) The winter in our place is as cold as in Beijing.`,
    en_split: `(1) - The - winter - in - our - place - is - as - cold - as - in - Beijing`,
    en_pos: `(num) - art - n - prep - pron - n - v - adv - adj - prep - prep - n`,
    vi: `(M·ªôt) M√πa ƒë√¥ng ·ªü ch·ªó ch√∫ng t√¥i l·∫°nh gi·ªëng nh∆∞ ·ªü B·∫Øc Kinh.`,
    pinyin: `(Yƒ´) W«ímen n√†r de d≈çngtiƒÅn gƒìn Bƒõijƒ´ng yƒ´y√†ng lƒõng`
  },
  {
    cn_raw: `Áî∞Ëä≥:ÁΩóÂÖ∞,‰Ω†‰ª¨ÂõΩÂÆ∂ÁöÑÊó∂Èó¥Ë∑üÂåó‰∫¨‰∏ç‰∏ÄÊ†∑Âêß?`,
    cn_split: `Áî∞Ëä≥ - ÁΩóÂÖ∞ - ‰Ω†‰ª¨ - ÂõΩÂÆ∂ - ÁöÑ - Êó∂Èó¥ - Ë∑ü - Âåó‰∫¨ - ‰∏ç - ‰∏ÄÊ†∑ - Âêß`,
    cn_pos: `n - n - pron - n - part - n - prep - n - adv - adj - part`,
    en_raw: `Tian Fang: Roland, the time in your country is different from Beijing, right?`,
    en_split: `Tian - Fang - the - time - in - your - country - is - different - from - Beijing - right`,
    en_pos: `n - n - art - n - prep - pron - n - v - adj - prep - n - adj`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: Roland, th·ªùi gian ·ªü n∆∞·ªõc b·∫°n kh√¥ng gi·ªëng B·∫Øc Kinh ph·∫£i kh√¥ng?`,
    pinyin: `Ti√°n FƒÅng: Lu√≥l√°n, n«êmen gu√≥jiƒÅ de sh√≠jiƒÅn gƒìn Bƒõijƒ´ng b√π yƒ´y√†ng ba?`
  },
  {
    cn_raw: `ÁΩóÂÖ∞:ÂΩìÁÑ∂‰∏ç‰∏ÄÊ†∑„ÄÇ`,
    cn_split: `ÁΩóÂÖ∞ - ÂΩìÁÑ∂ - ‰∏ç - ‰∏ÄÊ†∑`,
    cn_pos: `n - adv - adv - adj`,
    en_raw: `Roland: Of course it's different.`,
    en_split: `Roland - Of - course - it - is - different`,
    en_pos: `n - prep - n - pron - v - adj`,
    vi: `Roland: ƒê∆∞∆°ng nhi√™n l√† kh√¥ng gi·ªëng r·ªìi.`,
    pinyin: `Lu√≥l√°n: DƒÅngr√°n b√π yƒ´y√†ng.`
  },
  {
    cn_raw: `Êàë‰ª¨ÈÇ£ÂÑøË∑üÂåó‰∫¨Êúâ‰∏É‰∏™Â∞èÊó∂ÁöÑÊó∂Â∑ÆÂë¢„ÄÇ`,
    cn_split: `Êàë‰ª¨ - ÈÇ£ÂÑø - Ë∑ü - Âåó‰∫¨ - Êúâ - ‰∏É - ‰∏™ - Â∞èÊó∂ - ÁöÑ - Êó∂Â∑Æ - Âë¢`,
    cn_pos: `pron - pron - prep - n - v - num - mw - n - part - n - part`,
    en_raw: `We have a seven-hour time difference with Beijing.`,
    en_split: `We - have - a - seven-hour - time - difference - with - Beijing`,
    en_pos: `pron - v - art - adj - n - n - prep - n`,
    vi: `Ch·ªó ch√∫ng t√¥i v√† B·∫Øc Kinh c√≥ 7 ti·∫øng ƒë·ªìng h·ªì ch√™nh l·ªách m√∫i gi·ªù c∆°.`,
    pinyin: `W«ímen n√†r gƒìn Bƒõijƒ´ng y«íu qƒ´ g√® xi«éosh√≠ de sh√≠chƒÅ ne.`
  },
  {
    cn_raw: `Áî∞Ëä≥:‰Ω†‰ª¨ÈÇ£ÂÑøÊó©ËøòÊòØÂåó‰∫¨Êó©?`,
    cn_split: `Áî∞Ëä≥ - ‰Ω†‰ª¨ - ÈÇ£ÂÑø - Êó© - ËøòÊòØ - Âåó‰∫¨ - Êó©`,
    cn_pos: `n - pron - pron - adj - conj - n - adj`,
    en_raw: `Tian Fang: Is it earlier in your place or in Beijing?`,
    en_split: `Tian - Fang - Is - it - earlier - in - your - place - or - in - Beijing`,
    en_pos: `n - n - v - pron - adj - prep - pron - n - conj - prep - n`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: Ch·ªó c√°c b·∫°n s·ªõm hay l√† B·∫Øc Kinh s·ªõm?`,
    pinyin: `Ti√°n FƒÅng: N«êmen n√†r z«éo h√°ish√¨ Bƒõijƒ´ng z«éo?`
  },
  {
    cn_raw: `ÁΩóÂÖ∞:Âåó‰∫¨ÊØîÊàë‰ª¨ÈÇ£ÂÑøÊó©‰∏É‰∏™Â∞èÊó∂„ÄÇ`,
    cn_split: `ÁΩóÂÖ∞ - Âåó‰∫¨ - ÊØî - Êàë‰ª¨ - ÈÇ£ÂÑø - Êó© - ‰∏É - ‰∏™ - Â∞èÊó∂`,
    cn_pos: `n - n - prep - pron - pron - adj - num - mw - n`,
    en_raw: `Roland: Beijing is seven hours earlier than our place.`,
    en_split: `Roland - Beijing - is - seven - hours - earlier - than - our - place`,
    en_pos: `n - n - v - num - n - adj - prep - pron - n`,
    vi: `Roland: B·∫Øc Kinh s·ªõm h∆°n ch·ªó ch√∫ng t√¥i 7 ti·∫øng ƒë·ªìng h·ªì.`,
    pinyin: `Lu√≥l√°n: Bƒõijƒ´ng b«ê w«ímen n√†r z«éo qƒ´ g√® xi«éosh√≠.`
  },
  {
    cn_raw: `Áé∞Âú®Âåó‰∫¨ÊòØ‰∏äÂçàÂÖ´ÁÇπÂ§ö,Êàë‰ª¨ÈÇ£ÂÑøÊâçÂ§úÈáå‰∏ÄÁÇπÂ§ö„ÄÇ`,
    cn_split: `Áé∞Âú® - Âåó‰∫¨ - ÊòØ - ‰∏äÂçà - ÂÖ´ÁÇπ - Â§ö - Êàë‰ª¨ - ÈÇ£ÂÑø - Êâç - Â§úÈáå - ‰∏ÄÁÇπ - Â§ö`,
    cn_pos: `n - n - v - n - n - adj - pron - pron - adv - n - n - adj`,
    en_raw: `Now it's after 8 AM in Beijing, but only after 1 AM at night in our place.`,
    en_split: `Now - it - is - after - 8 - AM - in - Beijing - but - only - after - 1 - AM - at - night - in - our - place`,
    en_pos: `adv - pron - v - prep - num - n - prep - n - conj - adv - prep - num - n - prep - n - prep - pron - n`,
    vi: `B√¢y gi·ªù B·∫Øc Kinh l√† h∆°n 8 gi·ªù s√°ng, ch·ªó ch√∫ng t√¥i m·ªõi l√† h∆°n 1 gi·ªù ƒë√™m.`,
    pinyin: `Xi√†nz√†i Bƒõijƒ´ng sh√¨ sh√†ngw«î bƒÅdi«én du≈ç, w«ímen n√†r c√°i y√®l«ê yƒ´di«én du≈ç.`
  },
  {
    cn_raw: `Áî∞Ëä≥:Â≠£ËäÇË∑üÂåó‰∫¨‰∏ÄÊ†∑Âêó?`,
    cn_split: `Áî∞Ëä≥ - Â≠£ËäÇ - Ë∑ü - Âåó‰∫¨ - ‰∏ÄÊ†∑ - Âêó`,
    cn_pos: `n - n - prep - n - adj - part`,
    en_raw: `Tian Fang: Is the season the same as Beijing?`,
    en_split: `Tian - Fang - Is - the - season - the - same - as - Beijing`,
    en_pos: `n - n - v - art - n - art - adj - prep - n`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: M√πa m√†ng c√≥ gi·ªëng B·∫Øc Kinh kh√¥ng?`,
    pinyin: `Ti√°n FƒÅng: J√¨ji√© gƒìn Bƒõijƒ´ng yƒ´y√†ng ma?`
  },
  {
    cn_raw: `ÁΩóÂÖ∞:Â≠£ËäÇË∑üÂåó‰∫¨‰∏ÄÊ†∑,‰πüÊòØÊò•„ÄÅÂ§è„ÄÅÁßã„ÄÅÂÜ¨Âõõ‰∏™Â≠£ËäÇ„ÄÇ`,
    cn_split: `ÁΩóÂÖ∞ - Â≠£ËäÇ - Ë∑ü - Âåó‰∫¨ - ‰∏ÄÊ†∑ - ‰πü - ÊòØ - Êò• - Â§è - Áßã - ÂÜ¨ - Âõõ - ‰∏™ - Â≠£ËäÇ`,
    cn_pos: `n - n - prep - n - adj - adv - v - n - n - n - n - num - mw - n`,
    en_raw: `Roland: The seasons are the same as Beijing, also spring, summer, autumn, and winter, four seasons.`,
    en_split: `Roland - The - seasons - are - the - same - as - Beijing - also - spring - summer - autumn - and - winter - four - seasons`,
    en_pos: `n - art - n - v - art - adj - prep - n - adv - n - n - n - conj - n - num - n`,
    vi: `Roland: M√πa m√†ng gi·ªëng B·∫Øc Kinh, c≈©ng l√† b·ªën m√πa Xu√¢n, H·∫°, Thu, ƒê√¥ng.`,
    pinyin: `Lu√≥l√°n: J√¨ji√© gƒìn Bƒõijƒ´ng yƒ´y√†ng, yƒõ sh√¨ ch≈´n, xi√†, qi≈´, d≈çng s√¨ g√® j√¨ji√©.`
  },
  {
    cn_raw: `Áî∞Ëä≥:Ê∞îÂÄôË∑üÂåó‰∫¨‰∏ÄÊ†∑‰∏ç‰∏ÄÊ†∑?`,
    cn_split: `Áî∞Ëä≥ - Ê∞îÂÄô - Ë∑ü - Âåó‰∫¨ - ‰∏ÄÊ†∑ - ‰∏ç - ‰∏ÄÊ†∑`,
    cn_pos: `n - n - prep - n - adj - adv - adj`,
    en_raw: `Tian Fang: Is the climate the same as Beijing or not?`,
    en_split: `Tian - Fang - Is - the - climate - the - same - as - Beijing - or - not`,
    en_pos: `n - n - v - art - n - art - adj - prep - n - conj - adv`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: Kh√≠ h·∫≠u c√≥ gi·ªëng B·∫Øc Kinh hay kh√¥ng?`,
    pinyin: `Ti√°n FƒÅng: Q√¨h√≤u gƒìn Bƒõijƒ´ng yƒ´y√†ng b√π yƒ´y√†ng?`
  },
  {
    cn_raw: `ÁΩóÂÖ∞:‰∏ç‰∏ÄÊ†∑„ÄÇ`,
    cn_split: `ÁΩóÂÖ∞ - ‰∏ç - ‰∏ÄÊ†∑`,
    cn_pos: `n - adv - adj`,
    en_raw: `Roland: Not the same.`,
    en_split: `Roland - Not - the - same`,
    en_pos: `n - adv - art - adj`,
    vi: `Roland: Kh√¥ng gi·ªëng.`,
    pinyin: `Lu√≥l√°n: B√π yƒ´y√†ng.`
  },
  {
    cn_raw: `Âåó‰∫¨ÁöÑÂ§èÂ§©ÂæàÁÉ≠,Êàë‰ª¨ÈÇ£ÂÑøÂ§èÂ§©Ê≤°ÊúâËøô‰πàÁÉ≠„ÄÇ`,
    cn_split: `Âåó‰∫¨ - ÁöÑ - Â§èÂ§© - Âæà - ÁÉ≠ - Êàë‰ª¨ - ÈÇ£ÂÑø - Â§èÂ§© - Ê≤°Êúâ - Ëøô‰πà - ÁÉ≠`,
    cn_pos: `n - part - n - adv - adj - pron - pron - n - v - pron - adj`,
    en_raw: `Beijing's summer is very hot, but summer in our place is not this hot.`,
    en_split: `Beijing's - summer - is - very - hot - but - summer - in - our - place - is - not - this - hot`,
    en_pos: `n - n - v - adv - adj - conj - n - prep - pron - n - v - adv - det - adj`,
    vi: `M√πa h√® ·ªü B·∫Øc Kinh r·∫•t n√≥ng, m√πa h√® ·ªü ch·ªó ch√∫ng t√¥i kh√¥ng n√≥ng nh∆∞ th·∫ø n√†y.`,
    pinyin: `Bƒõijƒ´ng de xi√†tiƒÅn hƒõn r√®, w«ímen n√†r xi√†tiƒÅn m√©iy«íu zh√®me r√®.`
  },
  {
    cn_raw: `Áî∞Ëä≥:ÂÜ¨Â§©ÂÜ∑‰∏çÂÜ∑?`,
    cn_split: `Áî∞Ëä≥ - ÂÜ¨Â§© - ÂÜ∑ - ‰∏ç - ÂÜ∑`,
    cn_pos: `n - n - adj - adv - adj`,
    en_raw: `Tian Fang: Is the winter cold?`,
    en_split: `Tian - Fang - Is - the - winter - cold`,
    en_pos: `n - n - v - art - n - adj`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: M√πa ƒë√¥ng c√≥ l·∫°nh kh√¥ng?`,
    pinyin: `Ti√°n FƒÅng: D≈çngtiƒÅn lƒõng b√π lƒõng?`
  },
  {
    cn_raw: `ÁΩóÂÖ∞:ÂÜ¨Â§©Ë∑üÂåó‰∫¨‰∏ÄÊ†∑ÂÜ∑,‰ΩÜÊòØ‰∏çÂ∏∏ÂàÆÂ§ßÈ£é„ÄÇ`,
    cn_split: `ÁΩóÂÖ∞ - ÂÜ¨Â§© - Ë∑ü - Âåó‰∫¨ - ‰∏ÄÊ†∑ - ÂÜ∑ - ‰ΩÜÊòØ - ‰∏ç - Â∏∏ - ÂàÆ - Â§ßÈ£é`,
    cn_pos: `n - n - prep - n - adj - adj - conj - adv - adv - v - n`,
    en_raw: `Roland: Winter is as cold as Beijing, but it doesn't often blow strong winds.`,
    en_split: `Roland - Winter - is - as - cold - as - Beijing - but - it - does - not - often - blow - strong - winds`,
    en_pos: `n - n - v - adv - adj - prep - n - conj - pron - v - adv - adv - v - adj - n`,
    vi: `Roland: M√πa ƒë√¥ng l·∫°nh gi·ªëng nh∆∞ B·∫Øc Kinh, nh∆∞ng kh√¥ng th∆∞·ªùng xuy√™n c√≥ gi√≥ l·ªõn.`,
    pinyin: `Lu√≥l√°n: D≈çngtiƒÅn gƒìn Bƒõijƒ´ng yƒ´y√†ng lƒõng, d√†nsh√¨ b√π ch√°ng guƒÅ d√†fƒìng.`
  },
  {
    cn_raw: `Áî∞Ëä≥:Â∏∏‰∏ãÈõ™Âêó?`,
    cn_split: `Áî∞Ëä≥ - Â∏∏ - ‰∏ãÈõ™ - Âêó`,
    cn_pos: `n - adv - v - part`,
    en_raw: `Tian Fang: Does it snow often?`,
    en_split: `Tian - Fang - Does - it - snow - often`,
    en_pos: `n - n - v - pron - v - adv`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: C√≥ th∆∞·ªùng xuy√™n c√≥ tuy·∫øt kh√¥ng?`,
    pinyin: `Ti√°n FƒÅng: Ch√°ng xi√†xuƒõ ma?`
  },
  {
    cn_raw: `ÁΩóÂÖ∞:‰∏ç‰ΩÜÂ∏∏Â∏∏‰∏ãÈõ™,ËÄå‰∏î‰∏ãÂæóÂæàÂ§ß„ÄÇ`,
    cn_split: `ÁΩóÂÖ∞ - ‰∏ç‰ΩÜ - Â∏∏Â∏∏ - ‰∏ãÈõ™ - ËÄå‰∏î - ‰∏ã - Âæó - Âæà - Â§ß`,
    cn_pos: `n - conj - adv - v - conj - v - part - adv - adj`,
    en_raw: `Roland: Not only does it snow often, but it also falls very heavily.`,
    en_split: `Roland - Not - only - does - it - snow - often - but - it - also - falls - very - heavily`,
    en_pos: `n - adv - adv - v - pron - v - adv - conj - pron - adv - v - adv - adv`,
    vi: `Roland: Kh√¥ng nh·ªØng th∆∞·ªùng xuy√™n c√≥ tuy·∫øt, m√† c√≤n r∆°i r·∫•t l·ªõn.`,
    pinyin: `Lu√≥l√°n: B√πd√†n ch√°ngch√°ng xi√†xuƒõ, √©rqiƒõ xi√† de hƒõn d√†.`
  },
  {
    cn_raw: `Âåó‰∫¨Âë¢?`,
    cn_split: `Âåó‰∫¨ - Âë¢`,
    cn_pos: `n - part`,
    en_raw: `How about Beijing?`,
    en_split: `How - about - Beijing`,
    en_pos: `adv - prep - n`,
    vi: `C√≤n B·∫Øc Kinh th√¨ sao?`,
    pinyin: `Bƒõijƒ´ng ne?`
  },
  {
    cn_raw: `Áî∞Ëä≥:Âåó‰∫¨ÂÜ¨Â§©‰∏çÂ∏∏‰∏ãÈõ™„ÄÇ`,
    cn_split: `Áî∞Ëä≥ - Âåó‰∫¨ - ÂÜ¨Â§© - ‰∏ç - Â∏∏ - ‰∏ãÈõ™`,
    cn_pos: `n - n - n - adv - adv - v`,
    en_raw: `Tian Fang: It doesn't snow often in Beijing in winter.`,
    en_split: `Tian - Fang - It - does - not - snow - often - in - Beijing - in - winter`,
    en_pos: `n - n - pron - v - adv - v - adv - prep - n - prep - n`,
    vi: `ƒêi·ªÅn Ph∆∞∆°ng: M√πa ƒë√¥ng ·ªü B·∫Øc Kinh kh√¥ng th∆∞·ªùng xuy√™n c√≥ tuy·∫øt.`,
    pinyin: `Ti√°n FƒÅng: Bƒõijƒ´ng d≈çngtiƒÅn b√π ch√°ng xi√†xuƒõ.`
  }
];
// C·∫≠p nh·∫≠t h√†m render ƒë·ªÉ truy·ªÅn d·ªØ li·ªáu an to√†n h∆°n
function renderBook() {
    const container = document.getElementById('bookContent');
    sentences.forEach((s, i) => {
        const item = document.createElement('div');
        item.className = 'sentence-item';
        item.innerHTML = `
            <div class="text-content">
                <div class="row-cn">
                    <span id="cn-txt-${i}">${s.cn_raw}</span>
                </div>
                <div id="cn-pos-${i}" class="pos-tag hidden">${s.cn_pos}</div>
		<p>
                <div id="pinyin-${i}" class="pinyin-row hidden">${s.pinyin || ''}</div>
                <div class="row-en">
                    <span id="en-txt-${i}">${s.en_raw}</span>
                </div>
                <div id="en-pos-${i}" class="pos-tag hidden">${s.en_pos}</div>
                <p>
                <div class="row-vi">${s.vi}</div>
            </div>
            <div class="control-sidebar">
                <button class="btn-icon" onclick="playSpeech(${i}, 'cn')">üó£Ô∏è</button>
                <button class="btn-icon" onclick="toggleMode(${i}, 'cn')">üß©</button>
                <button class="btn-icon" onclick="playSpeech(${i}, 'en')">üîä</button>
                <button class="btn-icon" onclick="toggleMode(${i}, 'en')">üîç</button>
            </div>
        `;
        container.appendChild(item);
    });
}
// H√†m ph√°t √¢m m·ªõi: L·∫•y d·ªØ li·ªáu tr·ª±c ti·∫øp t·ª´ m·∫£ng thay v√¨ truy·ªÅn chu·ªói qua HTML
// H√†m ph√°t √¢m: T·ª± ƒë·ªông duy tr√¨ ng√¥n ng·ªØ ƒëang ch·ªçn
function playSpeech(index, langType) {
    // 1. D·ª´ng m·ªçi √¢m thanh ƒëang ph√°t ƒë·ªÉ tr√°nh ch·ªìng ch√©o
    window.speechSynthesis.cancel(); 

    let textToRead = "";
    let langCode = "";

    // 2. X√°c ƒë·ªãnh n·ªôi dung v√† m√£ ng√¥n ng·ªØ d·ª±a tr√™n l·ª±a ch·ªçn c·ªßa ng∆∞·ªùi d√πng
    if (langType === 'cn') {
        textToRead = sentences[index].cn_raw;
        langCode = 'zh-CN';
    } else {
        textToRead = sentences[index].en_raw;
        langCode = 'en-US';
    }

    const msg = new SpeechSynthesisUtterance();
    msg.text = textToRead;
    msg.lang = langCode;
    msg.rate = document.getElementById('rate').value;
    
    // 3. Hi·ªáu ·ª©ng Highlight: T√¥ m√†u c√¢u ƒëang ƒë·ªçc ƒë·ªÉ d·ªÖ theo d√µi
    const allItems = document.getElementsByClassName('sentence-item');
    // X√≥a m√†u c·ªßa t·∫•t c·∫£ c√°c c√¢u kh√°c
    Array.from(allItems).forEach(item => item.style.backgroundColor = "transparent");
    // T√¥ m√†u v√†ng nh·∫°t cho c√¢u hi·ªán t·∫°i
    allItems[index].style.backgroundColor = "rgba(230, 126, 34, 0.1)";

    // 4. X·ª≠ l√Ω khi k·∫øt th√∫c c√¢u
    msg.onend = () => {
        const isAuto = document.getElementById('autoNext').checked;
        if (isAuto && index < sentences.length - 1) {
            setTimeout(() => {
                // QUAN TR·ªåNG: Truy·ªÅn ƒë√∫ng langType hi·ªán t·∫°i v√†o l·∫ßn g·ªçi ti·∫øp theo
                playSpeech(index + 1, langType); 
                
                // T·ª± ƒë·ªông cu·ªôn m√†n h√¨nh ƒë·∫øn c√¢u ti·∫øp theo
                allItems[index + 1].scrollIntoView({
                    behavior: "smooth", 
                    block: "center"
                });
            }, 500); // Ngh·ªâ 0.5 gi√¢y gi·ªØa c√°c c√¢u ƒë·ªÉ ng∆∞·ªùi d√πng k·ªãp ng·∫•m
        }
    };

    window.speechSynthesis.speak(msg);
}
function toggleMode(index, lang) {
    const txtSpan = document.getElementById(`${lang}-txt-${index}`);
    const posSpan = document.getElementById(`${lang}-pos-${index}`);
    const isOriginal = txtSpan.innerText === sentences[index][`${lang}_raw`];

    txtSpan.innerText = isOriginal ? sentences[index][`${lang}_split`] : sentences[index][`${lang}_raw`];
    posSpan.classList.toggle('hidden');
}

function toggleDarkMode() {
    document.body.classList.toggle('dark-mode');
}

function toggleAllPinyin() {
    // 1. L·∫•y t·∫•t c·∫£ c√°c ph·∫ßn t·ª≠ c√≥ class l√† pinyin-row
    const pinyinElements = document.getElementsByClassName('pinyin-row');
    
    // 2. Ki·ªÉm tra n·∫øu kh√¥ng t√¨m th·∫•y ph·∫ßn t·ª≠ n√†o (b√°o l·ªói ra Console ƒë·ªÉ ki·ªÉm tra)
    if (pinyinElements.length === 0) {
        console.error("Kh√¥ng t√¨m th·∫•y ph·∫ßn t·ª≠ n√†o c√≥ class 'pinyin-row'");
        return;
    }

    // 3. Duy·ªát qua t·ª´ng ph·∫ßn t·ª≠ v√† b·∫≠t/t·∫Øt class 'hidden'
    for (let i = 0; i < pinyinElements.length; i++) {
        pinyinElements[i].classList.toggle('hidden');
    }
}

function speak(text, lang, index) {
    window.speechSynthesis.cancel();
    const msg = new SpeechSynthesisUtterance(text);
    msg.lang = lang;
    msg.rate = document.getElementById('rate').value;

    msg.onend = () => {
        if (document.getElementById('autoNext').checked && index < sentences.length - 1) {
            setTimeout(() => {
                speak(sentences[index + 1].cn_raw, 'zh-CN', index + 1);
                document.getElementsByClassName('sentence-item')[index+1].scrollIntoView({behavior: "smooth", block: "center"});
            }, 1200);
        }
    };
    window.speechSynthesis.speak(msg);
}

renderBook();
</script>
</body>
</html>