<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200..900&display=swap" rel="stylesheet">
    <title>S√°ch ƒêa Ng√¥n Ng·ªØ</title>
    <style>
        :root {
            --bg-body: #dcdcdc;
            --bg-book: #f4f1ea;
            --text-main: #1a1a1a;
            --text-sub: #555;
            --accent: #e67e22;
            --border: #d1ccc0;
        }

        /* Ch·∫ø ƒë·ªô Dark Mode */
        .dark-mode {
            --bg-body: #1a1a1b;
            --bg-book: #2c2c2e;
            --text-main: #e1e1e1;
            --text-sub: #b0b0b0;
            --accent: #f39c12;
            --border: #444;
        }

        body { 
            margin: 0; padding: 0;
            background-color: var(--bg-body);
            color: var(--text-main);
            transition: all 0.3s ease;
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        }

        .book-container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            background: var(--bg-book);
            min-height: 100vh;
            padding-top: 20px;
        }

        .sentence-item {
            display: flex;
            padding: 20px 5%; /* L·ªÅ tr√°i 5% theo y√™u c·∫ßu */
            border-bottom: 1px solid var(--border);
            word-wrap: break-word; /* T·ª± ƒë·ªông xu·ªëng d√≤ng */
        }

        .text-content {
            flex: 1;
            padding-right: 15px;
        }

        .row-cn { font-family: "Noto Serif SC","Segoe UI", Tahoma, Geneva, Verdana, sans-serif; font-size: 1.8rem; font-weight: normal; margin-bottom: 20px; line-height: 1.4; }
        .row-en { font-size: 1.2rem; margin-bottom: 20px; color: var(--text-main); opacity: 0.9; }
        .row-vi { font-size: 1rem; color: var(--text-sub); font-style: italic; }
        
        .pos-tag { font-size: 0.85rem; color: var(--accent); display: block; margin-bottom: 20px; margin-top: 0px; font-weight: normal; }

        /* Ph√≠m ch·ª©c nƒÉng d·∫°ng c·ªôt icon */
        .control-sidebar {
            display: flex;
            flex-direction: column;
            gap: 8px;
            width: 45px;
            align-items: center;
        }

        .btn-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 1px solid var(--border);
            background: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: 0.2s;
        }
        .btn-icon:hover { background: #eee; transform: scale(1.1); }

        /* Menu n·ªïi c·ªë ƒë·ªãnh ·ªü g√≥c d∆∞·ªõi b√™n ph·∫£i */
        .floating-menu {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 10px;
            z-index: 1000;
        }

        .settings-box {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            display: none; /* ·∫®n m·∫∑c ƒë·ªãnh */
            color: #333;
            font-size: 14px;
        }

        .show-settings .settings-box { display: block; }

        .btn-main-float {
            width: 50px;
            height: 50px;
            background: #34495e;
            color: white;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            font-size: 24px;
        }

	/* Th√™m v√†o trong th·∫ª <style> */
	.pinyin-row {
    		font-size: 16px;
		font-weight: normal;
   		color: #27ae60; /* M√†u xanh l√° d·ªãu m·∫Øt */
    		display: block;
    		margin-top: 0px;
		margin-bottom: 20px;
	}


        .hidden { display: none !important; }

    </style>
</head>
<body>

<div class="book-container" id="bookContent">
    </div>

<div class="floating-menu" id="floatMenu">
    <div class="settings-box">
        <strong>‚öôÔ∏è C√†i ƒë·∫∑t</strong><hr>
        T·ªëc ƒë·ªô: <input type="range" id="rate" min="0.5" max="1.3" step="0.1" value="0.9" style="width: 100px;"><br>
        <label><input type="checkbox" id="autoNext"> T·ª± ƒë·ªông chuy·ªÉn</label><br>
	<button onclick="toggleAllPinyin()" style="width: 100%; margin-top: 10px;">üî§ ·∫®n/Hi·ªán Pinyin</button>
        <button onclick="toggleDarkMode()" style="width: 100%; margin-top: 10px;">üåô Dark Mode</button>
    </div>
    <button class="btn-main-float" onclick="document.getElementById('floatMenu').classList.toggle('show-settings')">üõ†Ô∏è</button>
</div>

<script>
const sentences = [
  {
    cn_raw: `‰ªäÂ§©ÊàëÂ∏¶ÂêåÂ≠¶‰ª¨ÂéªÂèÇËßÇÂ±ïËßà„ÄÇ`,
    cn_split: `‰ªäÂ§© - Êàë - Â∏¶ - ÂêåÂ≠¶‰ª¨ - Âéª - ÂèÇËßÇ - Â±ïËßà„ÄÇ`,
    cn_pos: `Danh t·ª´ th·ªùi gian - ƒê·∫°i t·ª´ - ƒê·ªông t·ª´ - Danh t·ª´ - ƒê·ªông t·ª´ - ƒê·ªông t·ª´ - Danh t·ª´.`,
    en_raw: `Today I take the students to visit the exhibition.`,
    en_split: `Today - I - take - the students - to visit - the exhibition.`,
    en_pos: `Adverb - Pronoun - Verb - Noun - Verb - Noun.`,
    vi: `H√¥m nay t√¥i ƒë∆∞a c√°c em h·ªçc sinh ƒëi tham quan tri·ªÉn l√£m.`,
    pinyin: `Jƒ´ntiƒÅn w«í d√†i t√≥ngxu√©men q√π cƒÅnguƒÅn zh«énl«én.`
  },
  {
    cn_raw: `Âø´Âà∞Âá∫ÂèëÁöÑÊó∂Èó¥‰∫Ü, Â∞±Âè´ÂêåÂ≠¶‰ª¨Âø´‰∏äËΩ¶Êù•„ÄÇ`,
    cn_split: `Âø´ - Âà∞ - Âá∫ÂèëÁöÑ - Êó∂Èó¥ - ‰∫Ü, - Â∞± - Âè´ - ÂêåÂ≠¶‰ª¨ - Âø´ - ‰∏äËΩ¶ - Êù•„ÄÇ`,
    cn_pos: `Tr·∫°ng t·ª´ - ƒê·ªông t·ª´ - C·ª•m ƒë·ªãnh ng·ªØ - Danh t·ª´ - Tr·ª£ t·ª´ ng·ªØ kh√≠ - Ph√≥ t·ª´ - ƒê·ªông t·ª´ - Danh t·ª´ - Tr·∫°ng t·ª´ - ƒê·ªông t·ª´ - B·ªï ng·ªØ xu h∆∞·ªõng.`,
    en_raw: `It's almost time to set off, so I tell the students to get on the bus quickly.`,
    en_split: `It - is - almost - time - to set off, - so - I - tell - the students - to get on - the bus - quickly.`,
    en_pos: `Pronoun - Verb - Adverb - Noun - Verb - Conjunction - Pronoun - Verb - Noun - Verb - Noun - Adverb.`,
    vi: `S·∫Øp ƒë·∫øn gi·ªù xu·∫•t ph√°t r·ªìi, b√®n b·∫£o c√°c em h·ªçc sinh mau l√™n xe.`,
    pinyin: `Ku√†i d√†o ch≈´fƒÅ de sh√≠jiƒÅn le, ji√π ji√†o t√≥ngxu√©men ku√†i sh√†ngchƒì l√°i.`
  },
  {
    cn_raw: `Êàë‰ª¨ÂùêÁöÑÊòØ‰∏âÂè∑ËΩ¶, Áà±Âæ∑Âçé‰∏çÊÉ≥ÂùêËøôËæÜËΩ¶, ‰ªñÊúãÂèãÂú®‰∫îÂè∑ËΩ¶, ‰ªñÊÉ≥Âà∞‰∫îÂè∑ËΩ¶Âéª, ÈóÆÊàëË°å‰∏çË°å, ÊàëËØ¥, Ë°å, ‰Ω†ËøáÂéªÂêß„ÄÇ`,
    cn_split: `Êàë‰ª¨ - Âùê - ÁöÑ - ÊòØ - ‰∏âÂè∑ËΩ¶, - Áà±Âæ∑Âçé - ‰∏ç - ÊÉ≥ - Âùê - Ëøô - ËæÜ - ËΩ¶, - ‰ªñ - ÊúãÂèã - Âú® - ‰∫îÂè∑ËΩ¶, - ‰ªñ - ÊÉ≥ - Âà∞ - ‰∫îÂè∑ËΩ¶ - Âéª, - ÈóÆ - Êàë - Ë°å‰∏çË°å, - Êàë - ËØ¥, - Ë°å, - ‰Ω† - ËøáÂéª - Âêß„ÄÇ`,
    cn_pos: `ƒê·∫°i t·ª´ - ƒê·ªông t·ª´ - Tr·ª£ t·ª´ - ƒê·ªông t·ª´ - Danh t·ª´ - Danh t·ª´ ri√™ng - Ph√≥ t·ª´ ph·ªß ƒë·ªãnh - ƒê·ªông t·ª´ nƒÉng nguy·ªán - ƒê·ªông t·ª´ - ƒê·∫°i t·ª´ ch·ªâ ƒë·ªãnh - L∆∞·ª£ng t·ª´ - Danh t·ª´ - ƒê·∫°i t·ª´ - Danh t·ª´ - Gi·ªõi t·ª´ - Danh t·ª´ - ƒê·∫°i t·ª´ - ƒê·ªông t·ª´ nƒÉng nguy·ªán - Gi·ªõi t·ª´ - Danh t·ª´ - ƒê·ªông t·ª´ xu h∆∞·ªõng - ƒê·ªông t·ª´ - ƒê·∫°i t·ª´ - T√≠nh t·ª´ nghi v·∫•n - ƒê·∫°i t·ª´ - ƒê·ªông t·ª´ - T√≠nh t·ª´ - ƒê·∫°i t·ª´ - ƒê·ªông t·ª´ xu h∆∞·ªõng - Tr·ª£ t·ª´ ng·ªØ kh√≠.`,
    en_raw: `We are taking bus number three, Edward doesn't want to take this bus, his friend is on bus number five, he wants to go to bus number five, he asks me if it's okay, I say, okay, you go there.`,
    en_split: `We - are taking - bus number three, - Edward - does not - want - to take - this bus, - his friend - is - on - bus number five, - he - wants - to go - to - bus number five, - asks - me - if it is okay, - I - say, - okay, - you - go over - there.`,
    en_pos: `Pronoun - Verb - Noun - Proper Noun - Adverb - Verb - Verb - Noun - Noun - Verb - Preposition - Noun - Pronoun - Verb - Verb - Preposition - Noun - Verb - Pronoun - Adjective - Pronoun - Verb - Adjective - Pronoun - Verb - Adverb.`,
    vi: `Ch√∫ng t√¥i ƒëi xe s·ªë 3, Edward kh√¥ng mu·ªën ƒëi chi·∫øc xe n√†y, b·∫°n c·ªßa anh ·∫•y ·ªü xe s·ªë 5, anh ·∫•y mu·ªën sang xe s·ªë 5, h·ªèi t√¥i c√≥ ƒë∆∞·ª£c kh√¥ng, t√¥i n√≥i, ƒë∆∞·ª£c, em sang ƒë√≥ ƒëi.`,
    pinyin: `W«ímen zu√≤ de sh√¨ sƒÅnh√†o chƒì, √Äid√©hu√° b√π xi«éng zu√≤ zh√® li√†ng chƒì, tƒÅ p√©ngyou z√†i w«îh√†o chƒì, tƒÅ xi«éng d√†o w«îh√†o chƒì q√π, w√®n w«í x√≠ng b√π x√≠ng, w«í shu≈ç, x√≠ng, n«ê gu√≤q√π ba.`
  },
  {
    cn_raw: `Â∞±Ë¶ÅÂºÄËΩ¶‰∫Ü„ÄÇ`,
    cn_split: `Â∞±Ë¶Å - ÂºÄËΩ¶ - ‰∫Ü„ÄÇ`,
    cn_pos: `Ph√≥ t·ª´ - ƒê·ªông t·ª´ - Tr·ª£ t·ª´ ng·ªØ kh√≠.`,
    en_raw: `The bus is about to start.`,
    en_split: `The bus - is - about - to start.`,
    en_pos: `Noun - Verb - Adverb - Verb.`,
    vi: `S·∫Øp kh·ªüi h√†nh r·ªìi.`,
    pinyin: `Ji√πy√†o kƒÅichƒì le.`
  },
  {
    cn_raw: `Áéõ‰∏ΩËøòÊ≤°Êù•„ÄÇ`,
    cn_split: `Áéõ‰∏Ω - Ëøò - Ê≤° - Êù•„ÄÇ`,
    cn_pos: `Danh t·ª´ ri√™ng - Ph√≥ t·ª´ - Ph√≥ t·ª´ ph·ªß ƒë·ªãnh - ƒê·ªông t·ª´.`,
    en_raw: `Mary hasn't come yet.`,
    en_split: `Mary - has not - come - yet.`,
    en_pos: `Proper Noun - Adverb - Verb - Adverb.`,
    vi: `Mary v·∫´n ch∆∞a ƒë·∫øn.`,
    pinyin: `M«él√¨ h√°i m√©i l√°i.`
  },
  {
    cn_raw: `ÊàëÈóÆÁéõ‰∏ΩÊÄé‰πàÊ≤°Êù•„ÄÇ`,
    cn_split: `Êàë - ÈóÆ - Áéõ‰∏Ω - ÊÄé‰πà - Ê≤° - Êù•„ÄÇ`,
    cn_pos: `ƒê·∫°i t·ª´ - ƒê·ªông t·ª´ - Danh t·ª´ ri√™ng - ƒê·∫°i t·ª´ nghi v·∫•n - Ph√≥ t·ª´ ph·ªß ƒë·ªãnh - ƒê·ªông t·ª´.`,
    en_raw: `I ask why Mary hasn't come.`,
    en_split: `I - ask - why - Mary - has not - come.`,
    en_pos: `Pronoun - Verb - Adverb - Proper Noun - Adverb - Verb.`,
    vi: `T√¥i h·ªèi Mary sao l·∫°i ch∆∞a ƒë·∫øn.`,
    pinyin: `W«í w√®n M«él√¨ zƒõnme m√©i l√°i.`
  },
  {
    cn_raw: `Â±±Êú¨ËØ¥: Â•πÂøòÂ∏¶ÁÖßÁõ∏Êú∫‰∫Ü, ÂèàÂõûÂÆøËàçÂéªÊãø‰∫Ü, È©¨‰∏äÂ∞±ÂõûÊù•„ÄÇ`,
    cn_split: `Â±±Êú¨ - ËØ¥: - Â•π - Âøò - Â∏¶ - ÁÖßÁõ∏Êú∫ - ‰∫Ü, - Âèà - Âõû - ÂÆøËàç - Âéª - Êãø - ‰∫Ü, - È©¨‰∏ä - Â∞± - ÂõûÊù•„ÄÇ`,
    cn_pos: `Danh t·ª´ ri√™ng - ƒê·ªông t·ª´ - ƒê·∫°i t·ª´ - ƒê·ªông t·ª´ - ƒê·ªông t·ª´ - Danh t·ª´ - Tr·ª£ t·ª´ - Ph√≥ t·ª´ - ƒê·ªông t·ª´ - Danh t·ª´ - ƒê·ªông t·ª´ xu h∆∞·ªõng - ƒê·ªông t·ª´ - Tr·ª£ t·ª´ - Tr·∫°ng t·ª´ - Ph√≥ t·ª´ - ƒê·ªông t·ª´ xu h∆∞·ªõng.`,
    en_raw: `Yamamoto says: She forgot to bring her camera, went back to the dormitory to get it, and will be back soon.`,
    en_split: `Yamamoto - says: - She - forgot - to bring - her camera, - went - back - to - the dormitory - to get - it, - and - will - be back - soon.`,
    en_pos: `Proper Noun - Verb - Pronoun - Verb - Verb - Noun - Verb - Adverb - Preposition - Noun - Verb - Pronoun - Conjunction - Verb - Verb - Adverb.`,
    vi: `Yamamoto n√≥i: C√¥ ·∫•y qu√™n mang theo m√°y ·∫£nh, l·∫°i quay v·ªÅ k√Ω t√∫c x√° l·∫•y r·ªìi, s·∫Ω quay l·∫°i ngay th√¥i.`,
    pinyin: `ShƒÅnbƒõn shu≈ç: TƒÅ w√†ng d√†i zh√†oxi√†ngjƒ´ le, y√≤u hu√≠ s√πsh√® q√π n√° le, m«ésh√†ng ji√π hu√≠l√°i.`
  },
  {
    cn_raw: `Ëøá‰∫Ü‰∏Ä‰ºöÂÑø, Áéõ‰∏ΩË∑ëÊù•‰∫Ü„ÄÇ`,
    cn_split: `Ëøá‰∫Ü - ‰∏Ä‰ºöÂÑø, - Áéõ‰∏Ω - Ë∑ë - Êù•‰∫Ü„ÄÇ`,
    cn_pos: `ƒê·ªông t·ª´ - Danh t·ª´ th·ªùi gian - Danh t·ª´ ri√™ng - ƒê·ªông t·ª´ - B·ªï ng·ªØ xu h∆∞·ªõng.`,
    en_raw: `After a while, Mary came running.`,
    en_split: `After - a while, - Mary - came - running.`,
    en_pos: `Preposition - Noun - Proper Noun - Verb - Participle.`,
    vi: `M·ªôt l√°t sau, Mary ch·∫°y ƒë·∫øn.`,
    pinyin: `Gu√≤le y√≠hu√¨r, M«él√¨ p«éol√°i le.`
  },
  {
    cn_raw: `ÊàëÁúãÂêåÂ≠¶‰ª¨ÈÉΩ‰∏äÊù•‰∫Ü, Â∞±ÂØπÂ§ßÂÆ∂ËØ¥, Ëøô‰∏™Â±ïËßàÂ§ßÁ∫¶Ë¶ÅÂèÇËßÇ‰∏§‰∏™Â∞èÊó∂„ÄÇ`,
    cn_split: `Êàë - Áúã - ÂêåÂ≠¶‰ª¨ - ÈÉΩ - ‰∏äÊù• - ‰∫Ü, - Â∞± - ÂØπ - Â§ßÂÆ∂ - ËØ¥, - Ëøô‰∏™ - Â±ïËßà - Â§ßÁ∫¶ - Ë¶Å - ÂèÇËßÇ - ‰∏§‰∏™ - Â∞èÊó∂„ÄÇ`,
    cn_pos: `ƒê·∫°i t·ª´ - ƒê·ªông t·ª´ - Danh t·ª´ - Ph√≥ t·ª´ - ƒê·ªông t·ª´ xu h∆∞·ªõng - Tr·ª£ t·ª´ - Ph√≥ t·ª´ - Gi·ªõi t·ª´ - ƒê·∫°i t·ª´ - ƒê·ªông t·ª´ - ƒê·∫°i t·ª´ ch·ªâ ƒë·ªãnh - Danh t·ª´ - Tr·∫°ng t·ª´ - ƒê·ªông t·ª´ nƒÉng nguy·ªán - ƒê·ªông t·ª´ - S·ªë l∆∞·ª£ng t·ª´ - Danh t·ª´.`,
    en_raw: `I see that the students have all come up, so I say to everyone, this exhibition will take about two hours to visit.`,
    en_split: `I - see - that - the students - have all - come up, - so - I say - to - everyone, - this exhibition - will take - about - two hours - to visit.`,
    en_pos: `Pronoun - Verb - Conjunction - Noun - Adverb - Verb - Conjunction - Pronoun - Verb - Preposition - Pronoun - Noun - Verb - Adverb - Noun - Verb.`,
    vi: `T√¥i th·∫•y c√°c em h·ªçc sinh ƒë·ªÅu ƒë√£ l√™n xe, b√®n n√≥i v·ªõi m·ªçi ng∆∞·ªùi, cu·ªôc tri·ªÉn l√£m n√†y d·ª± ki·∫øn tham quan trong kho·∫£ng hai ti·∫øng.`,
    pinyin: `W«í k√†n t√≥ngxu√©men d≈çu sh√†ngl√°i le, ji√π du√¨ d√†jiƒÅ shu≈ç, zh√®ge zh«énl«én d√†yuƒì y√†o cƒÅnguƒÅn li«éng g√® xi«éosh√≠.`
  },
  {
    cn_raw: `ÂèÇËßÇÂÆå‰ª•Âêé, ÂõõÁÇπÈíüÂáÜÊó∂ÂºÄËΩ¶ÂõûÂ≠¶Ê†°„ÄÇ`,
    cn_split: `ÂèÇËßÇ - ÂÆå - ‰ª•Âêé, - ÂõõÁÇπÈíü - ÂáÜÊó∂ - ÂºÄËΩ¶ - Âõû - Â≠¶Ê†°„ÄÇ`,
    cn_pos: `ƒê·ªông t·ª´ - B·ªï ng·ªØ k·∫øt qu·∫£ - Li√™n t·ª´ th·ªùi gian - Danh t·ª´ th·ªùi gian - Tr·∫°ng t·ª´ - ƒê·ªông t·ª´ - ƒê·ªông t·ª´ xu h∆∞·ªõng - Danh t·ª´.`,
    en_raw: `After finishing the visit, the bus will return to school promptly at four o'clock.`,
    en_split: `After - finishing - the visit, - the bus - will return - to - school - promptly - at - four o'clock.`,
    en_pos: `Preposition - Verb - Noun - Noun - Verb - Preposition - Noun - Adverb - Preposition - Noun.`,
    vi: `Sau khi tham quan xong, ƒë√∫ng 4 gi·ªù xe s·∫Ω kh·ªüi h√†nh v·ªÅ tr∆∞·ªùng.`,
    pinyin: `CƒÅnguƒÅn w√°n y«êh√≤u, s√¨ di«énzh≈çng zh«însh√≠ kƒÅichƒì hu√≠ xu√©xi√†o.`
  },
  {
    cn_raw: `Â§ßÂÆ∂Ë¶ÅËÆ∞‰ΩèÂºÄËΩ¶Êó∂Èó¥„ÄÇ`,
    cn_split: `Â§ßÂÆ∂ - Ë¶Å - ËÆ∞‰Ωè - ÂºÄËΩ¶ - Êó∂Èó¥„ÄÇ`,
    cn_pos: `ƒê·∫°i t·ª´ - ƒê·ªông t·ª´ nƒÉng nguy·ªán - ƒê·ªông t·ª´ - ƒê·ªông t·ª´ - Danh t·ª´.`,
    en_raw: `Everyone must remember the departure time.`,
    en_split: `Everyone - must - remember - the departure - time.`,
    en_pos: `Pronoun - Verb - Verb - Noun - Noun.`,
    vi: `M·ªçi ng∆∞·ªùi c·∫ßn ghi nh·ªõ th·ªùi gian xe ch·∫°y.`,
    pinyin: `D√†jiƒÅ y√†o j√¨zh√π kƒÅichƒì sh√≠jiƒÅn.`
  },
  {
    cn_raw: `‰∏çÂõûÊù•ÁöÑÂêåÂ≠¶Ë∑üËÄÅÂ∏àËØ¥‰∏ÄÂ£∞„ÄÇ`,
    cn_split: `‰∏ç - ÂõûÊù• - ÁöÑ - ÂêåÂ≠¶ - Ë∑ü - ËÄÅÂ∏à - ËØ¥ - ‰∏ÄÂ£∞„ÄÇ`,
    cn_pos: `Ph√≥ t·ª´ ph·ªß ƒë·ªãnh - ƒê·ªông t·ª´ xu h∆∞·ªõng - Tr·ª£ t·ª´ - Danh t·ª´ - Gi·ªõi t·ª´ - Danh t·ª´ - ƒê·ªông t·ª´ - S·ªë l∆∞·ª£ng t·ª´.`,
    en_raw: `Students who are not coming back should tell the teacher.`,
    en_split: `Students - who - are not - coming back - should tell - the teacher.`,
    en_pos: `Noun - Pronoun - Adverb - Verb - Verb - Noun.`,
    vi: `Nh·ªØng b·∫°n h·ªçc sinh kh√¥ng v·ªÅ c√πng th√¨ h√£y n√≥i v·ªõi th·∫ßy/c√¥ m·ªôt ti·∫øng.`,
    pinyin: `B√π hu√≠l√°i de t√≥ngxu√© gƒìn l«éoshƒ´ shu≈ç y√¨shƒìng.`
  },
  {
    cn_raw: `ËØ¥ÂÆå, Êàë‰ª¨Â∞±Âá∫Âèë‰∫Ü„ÄÇ`,
    cn_split: `ËØ¥ - ÂÆå, - Êàë‰ª¨ - Â∞± - Âá∫Âèë - ‰∫Ü„ÄÇ`,
    cn_pos: `ƒê·ªông t·ª´ - B·ªï ng·ªØ k·∫øt qu·∫£ - ƒê·∫°i t·ª´ - Ph√≥ t·ª´ - ƒê·ªông t·ª´ - Tr·ª£ t·ª´ ng·ªØ kh√≠.`,
    en_raw: `After saying that, we set off.`,
    en_split: `After - saying - that, - we - set off.`,
    en_pos: `Preposition - Verb - Pronoun - Pronoun - Verb.`,
    vi: `N√≥i xong, ch√∫ng t√¥i li·ªÅn xu·∫•t ph√°t.`,
    pinyin: `Shu≈ç w√°n, w«ímen ji√π ch≈´fƒÅ le.`
  },
  {
    cn_raw: `Âà∞‰∫ÜÂ±ïËßàÈ¶ÜÁéõ‰∏ΩÂØπÊàëËØ¥, Â•πÁúãÂÆåÂ±ïËßà‰ª•Âêé, Ë¶ÅÂà∞Â§ß‰ΩøÈ¶ÜÂéªÁúã‰∏Ä‰∏™ÊúãÂèã„ÄÇ`,
    cn_split: `Âà∞‰∫Ü - Â±ïËßàÈ¶Ü - Áéõ‰∏Ω - ÂØπ - Êàë - ËØ¥, - Â•π - Áúã - ÂÆå - Â±ïËßà - ‰ª•Âêé, - Ë¶Å - Âà∞ - Â§ß‰ΩøÈ¶Ü - Âéª - Áúã - ‰∏Ä‰∏™ - ÊúãÂèã„ÄÇ`,
    cn_pos: `ƒê·ªông t·ª´ - Danh t·ª´ - Danh t·ª´ ri√™ng - Gi·ªõi t·ª´ - ƒê·∫°i t·ª´ - ƒê·ªông t·ª´ - ƒê·∫°i t·ª´ - ƒê·ªông t·ª´ - B·ªï ng·ªØ k·∫øt qu·∫£ - Danh t·ª´ - Li√™n t·ª´ th·ªùi gian - ƒê·ªông t·ª´ nƒÉng nguy·ªán - Gi·ªõi t·ª´ - Danh t·ª´ - ƒê·ªông t·ª´ xu h∆∞·ªõng - ƒê·ªông t·ª´ - S·ªë l∆∞·ª£ng t·ª´ - Danh t·ª´.`,
    en_raw: `Upon arriving at the exhibition hall, Mary said to me that after she finished viewing the exhibition, she wanted to go to the embassy to see a friend.`,
    en_split: `Upon arriving - at - the exhibition hall, - Mary - said - to - me - that - after - she - finished - viewing - the exhibition, - she - wanted - to go - to - the embassy - to see - a friend.`,
    en_pos: `Verb - Preposition - Noun - Proper Noun - Verb - Preposition - Pronoun - Conjunction - Preposition - Pronoun - Verb - Verb - Noun - Pronoun - Verb - Verb - Preposition - Noun - Verb - Noun.`,
    vi: `ƒê·∫øn nh√† tri·ªÉn l√£m, Mary n√≥i v·ªõi t√¥i r·∫±ng, sau khi xem xong tri·ªÉn l√£m, c√¥ ·∫•y mu·ªën ƒë·∫øn ƒë·∫°i s·ª© qu√°n ƒë·ªÉ thƒÉm m·ªôt ng∆∞·ªùi b·∫°n.`,
    pinyin: `D√†ole zh«énl«éngu«én M«él√¨ du√¨ w«í shu≈ç, tƒÅ k√†n w√°n zh«énl«én y«êh√≤u, y√†o d√†o d√†sh«êgu«én q√π k√†n y√≠ g√® p√©ngyou.`
  },
  {
    cn_raw: `‰∏çË∑üÊàë‰ª¨‰∏ÄËµ∑ÂõûÂ≠¶Ê†°Âéª‰∫Ü„ÄÇ`,
    cn_split: `‰∏ç - Ë∑ü - Êàë‰ª¨ - ‰∏ÄËµ∑ - Âõû - Â≠¶Ê†° - Âéª - ‰∫Ü„ÄÇ`,
    cn_pos: `Ph√≥ t·ª´ ph·ªß ƒë·ªãnh - Gi·ªõi t·ª´ - ƒê·∫°i t·ª´ - Tr·∫°ng t·ª´ - ƒê·ªông t·ª´ - Danh t·ª´ - ƒê·ªông t·ª´ xu h∆∞·ªõng - Tr·ª£ t·ª´ ng·ªØ kh√≠.`,
    en_raw: `She is not going back to school with us.`,
    en_split: `She - is not - going - back - to - school - with - us.`,
    en_pos: `Pronoun - Adverb - Verb - Adverb - Preposition - Noun - Preposition - Pronoun.`,
    vi: `S·∫Ω kh√¥ng c√πng ch√∫ng t√¥i quay v·ªÅ tr∆∞·ªùng n·ªØa.`,
    pinyin: `B√π gƒìn w«ímen y√¨q«ê hu√≠ xu√©xi√†o q√π le.`
  }
];
// C·∫≠p nh·∫≠t h√†m render ƒë·ªÉ truy·ªÅn d·ªØ li·ªáu an to√†n h∆°n
function renderBook() {
    const container = document.getElementById('bookContent');
    sentences.forEach((s, i) => {
        const item = document.createElement('div');
        item.className = 'sentence-item';
        item.innerHTML = `
            <div class="text-content">
                <div class="row-cn">
                    <span id="cn-txt-${i}">${s.cn_raw}</span>
                </div>
                <div id="cn-pos-${i}" class="pos-tag hidden">${s.cn_pos}</div>
                <div id="pinyin-${i}" class="pinyin-row hidden">${s.pinyin || ''}</div>
                <div class="row-en">
                    <span id="en-txt-${i}">${s.en_raw}</span>
                </div>
                <div id="en-pos-${i}" class="pos-tag hidden">${s.en_pos}</div>
                <div class="row-vi">${s.vi}</div>
            </div>
            <div class="control-sidebar">
                <button class="btn-icon" onclick="playSpeech(${i}, 'cn')">‚ôò</button>
                <button class="btn-icon" onclick="toggleMode(${i}, 'cn')">‚ôî</button>
                <button class="btn-icon" onclick="playSpeech(${i}, 'en')">‚ôñ</button>
                <button class="btn-icon" onclick="toggleMode(${i}, 'en')">‚ôï</button>
            </div>
        `;
        container.appendChild(item);
    });
}
// H√†m ph√°t √¢m m·ªõi: L·∫•y d·ªØ li·ªáu tr·ª±c ti·∫øp t·ª´ m·∫£ng thay v√¨ truy·ªÅn chu·ªói qua HTML
// H√†m ph√°t √¢m: T·ª± ƒë·ªông duy tr√¨ ng√¥n ng·ªØ ƒëang ch·ªçn
function playSpeech(index, langType) {
    // 1. D·ª´ng m·ªçi √¢m thanh ƒëang ph√°t ƒë·ªÉ tr√°nh ch·ªìng ch√©o
    window.speechSynthesis.cancel(); 

    let textToRead = "";
    let langCode = "";

    // 2. X√°c ƒë·ªãnh n·ªôi dung v√† m√£ ng√¥n ng·ªØ d·ª±a tr√™n l·ª±a ch·ªçn c·ªßa ng∆∞·ªùi d√πng
    if (langType === 'cn') {
        textToRead = sentences[index].cn_raw;
        langCode = 'zh-CN';
    } else {
        textToRead = sentences[index].en_raw;
        langCode = 'en-US';
    }

    const msg = new SpeechSynthesisUtterance();
    msg.text = textToRead;
    msg.lang = langCode;
    msg.rate = document.getElementById('rate').value;
    
    // 3. Hi·ªáu ·ª©ng Highlight: T√¥ m√†u c√¢u ƒëang ƒë·ªçc ƒë·ªÉ d·ªÖ theo d√µi
    const allItems = document.getElementsByClassName('sentence-item');
    // X√≥a m√†u c·ªßa t·∫•t c·∫£ c√°c c√¢u kh√°c
    Array.from(allItems).forEach(item => item.style.backgroundColor = "transparent");
    // T√¥ m√†u v√†ng nh·∫°t cho c√¢u hi·ªán t·∫°i
    allItems[index].style.backgroundColor = "rgba(230, 126, 34, 0.1)";

    // 4. X·ª≠ l√Ω khi k·∫øt th√∫c c√¢u
    msg.onend = () => {
        const isAuto = document.getElementById('autoNext').checked;
        if (isAuto && index < sentences.length - 1) {
            setTimeout(() => {
                // QUAN TR·ªåNG: Truy·ªÅn ƒë√∫ng langType hi·ªán t·∫°i v√†o l·∫ßn g·ªçi ti·∫øp theo
                playSpeech(index + 1, langType); 
                
                // T·ª± ƒë·ªông cu·ªôn m√†n h√¨nh ƒë·∫øn c√¢u ti·∫øp theo
                allItems[index + 1].scrollIntoView({
                    behavior: "smooth", 
                    block: "center"
                });
            }, 500); // Ngh·ªâ 0.5 gi√¢y gi·ªØa c√°c c√¢u ƒë·ªÉ ng∆∞·ªùi d√πng k·ªãp ng·∫•m
        }
    };

    window.speechSynthesis.speak(msg);
}
function toggleMode(index, lang) {
    const txtSpan = document.getElementById(`${lang}-txt-${index}`);
    const posSpan = document.getElementById(`${lang}-pos-${index}`);
    const isOriginal = txtSpan.innerText === sentences[index][`${lang}_raw`];

    txtSpan.innerText = isOriginal ? sentences[index][`${lang}_split`] : sentences[index][`${lang}_raw`];
    posSpan.classList.toggle('hidden');
}

function toggleDarkMode() {
    document.body.classList.toggle('dark-mode');
}

function toggleAllPinyin() {
    // 1. L·∫•y t·∫•t c·∫£ c√°c ph·∫ßn t·ª≠ c√≥ class l√† pinyin-row
    const pinyinElements = document.getElementsByClassName('pinyin-row');
    
    // 2. Ki·ªÉm tra n·∫øu kh√¥ng t√¨m th·∫•y ph·∫ßn t·ª≠ n√†o (b√°o l·ªói ra Console ƒë·ªÉ ki·ªÉm tra)
    if (pinyinElements.length === 0) {
        console.error("Kh√¥ng t√¨m th·∫•y ph·∫ßn t·ª≠ n√†o c√≥ class 'pinyin-row'");
        return;
    }

    // 3. Duy·ªát qua t·ª´ng ph·∫ßn t·ª≠ v√† b·∫≠t/t·∫Øt class 'hidden'
    for (let i = 0; i < pinyinElements.length; i++) {
        pinyinElements[i].classList.toggle('hidden');
    }
}

function speak(text, lang, index) {
    window.speechSynthesis.cancel();
    const msg = new SpeechSynthesisUtterance(text);
    msg.lang = lang;
    msg.rate = document.getElementById('rate').value;

    msg.onend = () => {
        if (document.getElementById('autoNext').checked && index < sentences.length - 1) {
            setTimeout(() => {
                speak(sentences[index + 1].cn_raw, 'zh-CN', index + 1);
                document.getElementsByClassName('sentence-item')[index+1].scrollIntoView({behavior: "smooth", block: "center"});
            }, 1200);
        }
    };
    window.speechSynthesis.speak(msg);
}

renderBook();
</script>
</body>
</html>