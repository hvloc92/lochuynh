<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S√°ch ƒêa Ng√¥n Ng·ªØ</title>
    <style>
        :root {
            --bg-body: #dcdcdc;
            --bg-book: #f4f1ea;
            --text-main: #1a1a1a;
            --text-sub: #555;
            --accent: #e67e22;
            --border: #d1ccc0;
        }

        /* Ch·∫ø ƒë·ªô Dark Mode */
        .dark-mode {
            --bg-body: #1a1a1b;
            --bg-book: #2c2c2e;
            --text-main: #e1e1e1;
            --text-sub: #b0b0b0;
            --accent: #f39c12;
            --border: #444;
        }

        body { 
            margin: 0; padding: 0;
            background-color: var(--bg-body);
            color: var(--text-main);
            transition: all 0.3s ease;
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        }

        .book-container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            background: var(--bg-book);
            min-height: 100vh;
            padding-top: 20px;
        }

        .sentence-item {
            display: flex;
            padding: 20px 5%; /* L·ªÅ tr√°i 5% theo y√™u c·∫ßu */
            border-bottom: 1px solid var(--border);
            word-wrap: break-word; /* T·ª± ƒë·ªông xu·ªëng d√≤ng */
        }

        .text-content {
            flex: 1;
            padding-right: 15px;
        }

        .row-cn { font-size: 1.5rem; font-weight: bold; margin-bottom: 8px; line-height: 1.4; }
        .row-en { font-size: 1.2rem; margin-bottom: 5px; color: var(--text-main); opacity: 0.9; }
        .row-vi { font-size: 1rem; color: var(--text-sub); font-style: italic; }
        
        .pos-tag { font-size: 0.85rem; color: var(--accent); display: block; margin-top: 4px; font-weight: normal; }

        /* Ph√≠m ch·ª©c nƒÉng d·∫°ng c·ªôt icon */
        .control-sidebar {
            display: flex;
            flex-direction: column;
            gap: 8px;
            width: 45px;
            align-items: center;
        }

        .btn-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 1px solid var(--border);
            background: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: 0.2s;
        }
        .btn-icon:hover { background: #eee; transform: scale(1.1); }

        /* Menu n·ªïi c·ªë ƒë·ªãnh ·ªü g√≥c d∆∞·ªõi b√™n ph·∫£i */
        .floating-menu {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 10px;
            z-index: 1000;
        }

        .settings-box {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            display: none; /* ·∫®n m·∫∑c ƒë·ªãnh */
            color: #333;
            font-size: 14px;
        }

        .show-settings .settings-box { display: block; }

        .btn-main-float {
            width: 50px;
            height: 50px;
            background: #34495e;
            color: white;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            font-size: 24px;
        }

	/* Th√™m v√†o trong th·∫ª <style> */
	.pinyin-row {
    		font-size: 16px;
		font-weight: normal;
   		color: #27ae60; /* M√†u xanh l√° d·ªãu m·∫Øt */
    		display: block;
    		margin-top: 2px;
	}


        .hidden { display: none !important; }

    </style>
</head>
<body>

<div class="book-container" id="bookContent">
    </div>

<div class="floating-menu" id="floatMenu">
    <div class="settings-box">
        <strong>‚öôÔ∏è C√†i ƒë·∫∑t</strong><hr>
        T·ªëc ƒë·ªô: <input type="range" id="rate" min="0.5" max="1.3" step="0.1" value="0.9" style="width: 100px;"><br>
        <label><input type="checkbox" id="autoNext"> T·ª± ƒë·ªông chuy·ªÉn</label><br>
	<button onclick="toggleAllPinyin()" style="width: 100%; margin-top: 10px;">üî§ ·∫®n/Hi·ªán Pinyin</button>
        <button onclick="toggleDarkMode()" style="width: 100%; margin-top: 10px;">üåô Dark Mode</button>
    </div>
    <button class="btn-main-float" onclick="document.getElementById('floatMenu').classList.toggle('show-settings')">üõ†Ô∏è</button>
</div>

<script>
const sentences = [
  {
    cn_raw: `ËµõÈ©¨`,
    cn_split: `Ëµõ-È©¨`,
    cn_pos: `v-n`,
    en_raw: `Horse racing`,
    en_split: `Horse-racing`,
    en_pos: `n-n`,
    vi: `ƒêua ng·ª±a`,
    pinyin: `S√†im«é`
  },
  {
    cn_raw: `‰∏§ÂçÉÂ§öÂπ¥Ââç, Êúâ‰∏™‰∫∫Âè´Áî∞Âøå, ÂæàÂñúÊ¨¢ËµõÈ©¨„ÄÇ`,
    cn_split: `[‰∏§ÂçÉÂ§öÂπ¥Ââç]-[Êúâ]-[‰∏Ä‰∏™‰∫∫]-[Âè´]-[Áî∞Âøå]-[Âæà]-[ÂñúÊ¨¢]-[ËµõÈ©¨]`,
    cn_pos: `(num-mw-n)-(v)-(num-mw-n)-(v)-(n)-(adv)-(v)-(v/n)`,
    en_raw: `Over two thousand years ago, there was a man named Tian Ji who liked horse racing very much.`,
    en_split: `[Over two thousand years ago]-[there]-[was]-[a man]-[named]-[Tian Ji]-[who]-[liked]-[horse racing]-[very much]`,
    en_pos: `(prep-num-num-n-adv)-(adv)-(v)-(art-n)-(v)-(n)-(pron)-(v)-(n)-(adv)`,
    vi: `H∆°n hai ng√†n nƒÉm tr∆∞·ªõc, c√≥ m·ªôt ng∆∞·ªùi t√™n l√† ƒêi·ªÅn K·ªµ, r·∫•t th√≠ch ƒëua ng·ª±a.`,
    pinyin: `Li«éngqiƒÅn du≈ç ni√°n qi√°n, y«íu g√®r√©n ji√†o Ti√°n J√¨, hƒõn x«êhuƒÅn s√†im«é.`
  },
  {
    cn_raw: `‰∏ÄÂ§©, ÂõΩÁéãÂØπ‰ªñËØ¥:‚ÄúÂê¨ËØ¥‰Ω†Âèà‰π∞‰∫Ü‰∏Ä‰∫õÂ•ΩÈ©¨, Êàë‰ª¨ÂÜçËµõËµõÊÄé‰πàÊ†∑?‚Äù`,
    cn_split: `[‰∏ÄÂ§©]-[ÂõΩÁéã]-[ÂØπ‰ªñ]-[ËØ¥]-[Âê¨ËØ¥]-[‰Ω†]-[Âèà]-[‰π∞]-[‰∫Ü]-[‰∏Ä‰∫õ]-[Â•Ω]-[È©¨]-[Êàë‰ª¨]-[ÂÜç]-[ËµõËµõ]-[ÊÄé‰πàÊ†∑]`,
    cn_pos: `(num-mw)-(n)-(prep-pron)-(v)-(v)-(pron)-(adv)-(v)-(part)-(num-mw)-(adj)-(n)-(pron)-(adv)-(v)-(pron)`,
    en_raw: `One day, the King said to him: "I heard you bought some good horses again, how about we race again?"`,
    en_split: `[One day]-[the King]-[said]-[to him]-[I]-[heard]-[you]-[bought]-[some]-[good]-[horses]-[again]-[how about]-[we]-[race]-[again]`,
    en_pos: `(num-n)-(art-n)-(v)-(prep-pron)-(pron)-(v)-(pron)-(v)-(det)-(adj)-(n)-(adv)-(adv)-(pron)-(v)-(adv)`,
    vi: `M·ªôt ng√†y n·ªç, Qu·ªëc v∆∞∆°ng n√≥i v·ªõi √¥ng ·∫•y: "Nghe n√≥i √¥ng l·∫°i mua m·ªôt s·ªë ng·ª±a t·ªët, ch√∫ng ta ƒëua l·∫°i xem th·∫ø n√†o?"`,
    pinyin: `Yƒ´tiƒÅn, gu√≥w√°ng du√¨ tƒÅ shu≈ç: "Tƒ´ng shu≈ç n«ê y√≤u m«éile yƒ´xiƒì h«éo m«é, w«ímen z√†i s√†is√†i zƒõnmey√†ng?"`
  },
  {
    cn_raw: `Áî∞ÂøåÁü•ÈÅìËá™Â∑±ÁöÑÈ©¨Ê≤°ÊúâÂõΩÁéãÁöÑÂ•Ω, ‰ΩÜÊòØÂèà‰∏çÂ•ΩÊÑèÊÄùËØ¥‰∏çËµõ, Â∞±Á≠îÂ∫î‰∫Ü„ÄÇ`,
    cn_split: `[Áî∞Âøå]-[Áü•ÈÅì]-[Ëá™Â∑±ÁöÑ]-[È©¨]-[Ê≤°Êúâ]-[ÂõΩÁéãÁöÑ]-[Â•Ω]-[‰ΩÜÊòØ]-[Âèà]-[‰∏çÂ•ΩÊÑèÊÄù]-[ËØ¥]-[‰∏ç]-[Ëµõ]-[Â∞±]-[Á≠îÂ∫î]-[‰∫Ü]`,
    cn_pos: `(n)-(v)-(pron-part)-(n)-(v)-(n-part)-(adj)-(conj)-(adv)-(adj)-(v)-(adv)-(v)-(adv)-(v)-(part)`,
    en_raw: `Tian Ji knew his horses were not as good as the King's, but he was too embarrassed to say no, so he agreed.`,
    en_split: `[Tian Ji]-[knew]-[his horses]-[were not]-[as good as]-[the King's]-[but]-[he]-[was]-[too embarrassed]-[to say]-[no]-[so]-[he]-[agreed]`,
    en_pos: `(n)-(v)-(pron-n)-(v-adv)-(prep-adj-prep)-(n)-(conj)-(pron)-(v)-(adv-adj)-(part-v)-(adv)-(conj)-(pron)-(v)`,
    vi: `ƒêi·ªÅn K·ªµ bi·∫øt ng·ª±a c·ªßa m√¨nh kh√¥ng t·ªët b·∫±ng c·ªßa Qu·ªëc v∆∞∆°ng, nh∆∞ng l·∫°i ng·∫°i kh√¥ng d√°m n√≥i kh√¥ng ƒëua, n√™n ƒë√£ ƒë·ªìng √Ω.`,
    pinyin: `Ti√°n J√¨ zhƒ´d√†o z√¨j«ê de m«é m√©iy«íu gu√≥w√°ng de h«éo, d√†nsh√¨ y√≤u b√π h«éoy√¨si shu≈ç b√π s√†i, ji√π dƒÅyingle.`
  },
  {
    cn_raw: `Áî∞ÂøåÂíåÂõΩÁéãÁöÑÈ©¨, ÈÉΩÂàÜ‰∏âÁ≠â: ‰∏äÁ≠â„ÄÅ‰∏≠Á≠â„ÄÅ‰∏ãÁ≠â„ÄÇ`,
    cn_split: `[Áî∞Âøå]-[Âíå]-[ÂõΩÁéãÁöÑ]-[È©¨]-[ÈÉΩ]-[ÂàÜ]-[‰∏âÁ≠â]-[‰∏äÁ≠â]-[‰∏≠Á≠â]-[‰∏ãÁ≠â]`,
    cn_pos: `(n)-(conj)-(n-part)-(n)-(adv)-(v)-(num-mw)-(adj)-(adj)-(adj)`,
    en_raw: `Tian Ji's and the King's horses were divided into three grades: superior, medium, and inferior.`,
    en_split: `[Tian Ji's and the King's horses]-[were divided]-[into]-[three grades]-[superior]-[medium]-[inferior]`,
    en_pos: `(n-conj-art-n-n)-(v)-(prep)-(num-n)-(adj)-(adj)-(adj)`,
    vi: `Ng·ª±a c·ªßa ƒêi·ªÅn K·ªµ v√† Qu·ªëc v∆∞∆°ng ƒë·ªÅu chia l√†m ba h·∫°ng: h·∫°ng th∆∞·ª£ng, h·∫°ng trung, h·∫°ng h·∫°.`,
    pinyin: `Ti√°n J√¨ h√© gu√≥w√°ng de m«é, d≈çu fƒìn sƒÅndƒõng: sh√†ngdƒõng, zh≈çngdƒõng, xi√†dƒõng.`
  },
  {
    cn_raw: `ÊØîËµõËøõË°å‰∏âÂú∫, ÊØèÂú∫Ëµõ‰∏âÊ¨°, ÊåâÊúÄÂêéÁöÑÂæóÂàÜÂÜ≥ÂÆöËæìËµ¢„ÄÇ`,
    cn_split: `[ÊØîËµõ]-[ËøõË°å]-[‰∏âÂú∫]-[ÊØèÂú∫]-[Ëµõ]-[‰∏âÊ¨°]-[Êåâ]-[ÊúÄÂêéÁöÑ]-[ÂæóÂàÜ]-[ÂÜ≥ÂÆö]-[ËæìËµ¢]`,
    cn_pos: `(n)-(v)-(num-mw)-(pron-mw)-(v)-(num-mw)-(prep)-(adj-part)-(n)-(v)-(n)`,
    en_raw: `The competition had three rounds, each round raced three times, and the winner was decided by the final score.`,
    en_split: `[The competition]-[had]-[three rounds]-[each round]-[raced]-[three times]-[and]-[the winner]-[was decided]-[by]-[the final score]`,
    en_pos: `(art-n)-(v)-(num-n)-(det-n)-(v)-(num-n)-(conj)-(art-n)-(v)-(prep)-(art-adj-n)`,
    vi: `Cu·ªôc thi ti·∫øn h√†nh ba hi·ªáp, m·ªói hi·ªáp ƒëua ba l·∫ßn, d·ª±a v√†o s·ªë ƒëi·ªÉm cu·ªëi c√πng ƒë·ªÉ quy·∫øt ƒë·ªãnh th·∫Øng thua.`,
    pinyin: `B«ês√†i j√¨nx√≠ng sƒÅn ch«éng, mƒõi ch«éng s√†i sƒÅnc√¨, √†n zu√¨h√≤u de d√©fƒìn ju√©d√¨ng sh≈´y√≠ng.`
  },
  {
    cn_raw: `ÊØîËµõÂºÄÂßã‰∫Ü„ÄÇ`,
    cn_split: `[ÊØîËµõ]-[ÂºÄÂßã]-[‰∫Ü]`,
    cn_pos: `(n)-(v)-(part)`,
    en_raw: `The competition began.`,
    en_split: `[The competition]-[began]`,
    en_pos: `(art-n)-(v)`,
    vi: `Cu·ªôc thi b·∫Øt ƒë·∫ßu r·ªìi.`,
    pinyin: `B«ês√†i kƒÅish«êle.`
  },
  {
    cn_raw: `Á¨¨‰∏ÄÂú∫, Áî∞ÂøåÁî®ÂêåÁ≠âÁ∫ßÁöÑÈ©¨Ë∑üÂõΩÁéãËµõ, Áî∞Á∫™ÁöÑÈ©¨ÈÉΩÊ≤°ÊúâÂõΩÁéãÁöÑË∑ëÂæóÂø´, ÁªìÊûú‰∏âÊ¨°ÈÉΩËæì‰∫Ü„ÄÇ`,
    cn_split: `[Á¨¨‰∏ÄÂú∫]-[Áî∞Âøå]-[Áî®]-[ÂêåÁ≠âÁ∫ßÁöÑ]-[È©¨]-[Ë∑ü]-[ÂõΩÁéã]-[Ëµõ]-[Áî∞Á∫™ÁöÑ]-[È©¨]-[ÈÉΩ]-[Ê≤°Êúâ]-[ÂõΩÁéãÁöÑ]-[Ë∑ë]-[Âæó]-[Âø´]-[ÁªìÊûú]-[‰∏âÊ¨°]-[ÈÉΩ]-[Ëæì]-[‰∫Ü]`,
    cn_pos: `(num-mw)-(n)-(v)-(adj-part)-(n)-(prep)-(n)-(v)-(n-part)-(n)-(adv)-(v)-(n-part)-(v)-(part)-(adj)-(n)-(num-mw)-(adv)-(v)-(part)`,
    en_raw: `In the first round, Tian Ji raced with horses of the same grade as the King, but his horses were not as fast, so he lost all three times.`,
    en_split: `[In the first round]-[Tian Ji]-[raced]-[with horses]-[of the same grade]-[as the King]-[but]-[his horses]-[were not]-[as fast]-[so]-[he]-[lost]-[all three times]`,
    en_pos: `(prep-art-num-n)-(n)-(v)-(prep-n)-(prep-art-adj-n)-(prep-art-n)-(conj)-(pron-n)-(v-adv)-(prep-adj)-(conj)-(pron)-(v)-(det-num-n)`,
    vi: `Hi·ªáp th·ª© nh·∫•t, ƒêi·ªÅn K·ªµ d√πng ng·ª±a c√πng c·∫•p b·∫≠c ƒëua v·ªõi Qu·ªëc v∆∞∆°ng, ng·ª±a c·ªßa ƒêi·ªÅn K·ªµ ƒë·ªÅu ch·∫°y kh√¥ng nhanh b·∫±ng ng·ª±a c·ªßa Qu·ªëc v∆∞∆°ng, k·∫øt qu·∫£ c·∫£ ba l·∫ßn ƒë·ªÅu thua.`,
    pinyin: `D√¨ yƒ´ ch«éng, Ti√°n J√¨ y√≤ng t√≥ng dƒõngj√≠ de m«é gƒìn gu√≥w√°ng s√†i, Ti√°n J«ê de m«é d≈çu m√©iy«íu gu√≥w√°ng de p«éo de ku√†i, ji√©gu«í sƒÅnc√¨ d≈çu sh≈´le.`
  },
  {
    cn_raw: `Áî∞ËÆ∞Ëæì‰∫ÜÁ¨¨‰∏ÄÂú∫, ÂøÉÈáåÂæà‰∏çÈ´òÂÖ¥„ÄÇ`,
    cn_split: `[Áî∞ËÆ∞]-[Ëæì]-[‰∫Ü]-[Á¨¨‰∏ÄÂú∫]-[ÂøÉÈáå]-[Âæà]-[‰∏ç]-[È´òÂÖ¥]`,
    cn_pos: `(n)-(v)-(part)-(num-mw)-(n)-(adv)-(adv)-(adj)`,
    en_raw: `Tian Ji lost the first round and felt very unhappy.`,
    en_split: `[Tian Ji]-[lost]-[the first round]-[and]-[felt]-[very unhappy]`,
    en_pos: `(n)-(v)-(art-num-n)-(conj)-(v)-(adv-adj)`,
    vi: `ƒêi·ªÅn K·ªµ thua hi·ªáp ƒë·∫ßu ti√™n, trong l√≤ng r·∫•t kh√¥ng vui.`,
    pinyin: `Ti√°n J√¨ sh≈´le d√¨ yƒ´ ch«éng, xƒ´nl«ê hƒõn b√π gƒÅox√¨ng.`
  },
  {
    cn_raw: `ËøôÊó∂‰∏Ä‰∏™ÊúãÂèãÂØπ‰ªñËØ¥, ‰Ω†‰∏çËÉΩËøôÊ†∑Ëµõ, ÊàëÂëäËØâ‰Ω†‰∏Ä‰∏™ÂäûÊ≥ï„ÄÇ`,
    cn_split: `[ËøôÊó∂]-[‰∏Ä‰∏™]-[ÊúãÂèã]-[ÂØπ‰ªñ]-[ËØ¥]-[‰Ω†]-[‰∏çËÉΩ]-[ËøôÊ†∑]-[Ëµõ]-[Êàë]-[ÂëäËØâ]-[‰Ω†]-[‰∏Ä‰∏™]-[ÂäûÊ≥ï]`,
    cn_pos: `(pron)-(num-mw)-(n)-(prep-pron)-(v)-(pron)-(v-adv)-(pron)-(v)-(pron)-(v)-(pron)-(num-mw)-(n)`,
    en_raw: `At this time a friend said to him, you can't race like this, I will tell you a way.`,
    en_split: `[At this time]-[a friend]-[said]-[to him]-[you]-[can't race]-[like this]-[I]-[will tell]-[you]-[a way]`,
    en_pos: `(prep-pron-n)-(art-n)-(v)-(prep-pron)-(pron)-(v)-(prep-pron)-(pron)-(v)-(pron)-(art-n)`,
    vi: `L√∫c n√†y m·ªôt ng∆∞·ªùi b·∫°n n√≥i v·ªõi √¥ng ·∫•y, √¥ng kh√¥ng th·ªÉ ƒëua nh∆∞ v·∫≠y, t√¥i n√≥i cho √¥ng m·ªôt c√°ch.`,
    pinyin: `Zh√® sh√≠ yƒ´g√® p√©ngy«íu du√¨ tƒÅ shu≈ç, n«ê b√πn√©ng zh√®y√†ng s√†i, w«í g√†os√π n«ê yƒ´g√® b√†nf«é.`
  },
  {
    cn_raw: `Á¨¨‰∫åÂú∫ÊØîËµõÂºÄÂßã‰∫Ü„ÄÇ`,
    cn_split: `[Á¨¨‰∫åÂú∫]-[ÊØîËµõ]-[ÂºÄÂßã]-[‰∫Ü]`,
    cn_pos: `(num-mw)-(n)-(v)-(part)`,
    en_raw: `The second round of the competition began.`,
    en_split: `[The second round]-[of the competition]-[began]`,
    en_pos: `(art-num-n)-(prep-art-n)-(v)`,
    vi: `Hi·ªáp thi ƒë·∫•u th·ª© hai b·∫Øt ƒë·∫ßu r·ªìi.`,
    pinyin: `D√¨ √®r ch«éng b«ês√†i kƒÅish«êle.`
  },
  {
    cn_raw: `Áî∞ÂøåÂÖàÁî®‰∏ãÁ≠âÈ©¨Ë∑üÂõΩÁéãÁöÑ‰∏äÁ≠âÈ©¨Ëµõ, ÁªìÊûúÁî∞ÂøåËæì‰∫Ü„ÄÇ`,
    cn_split: `[Áî∞Âøå]-[ÂÖà]-[Áî®]-[‰∏ãÁ≠â]-[È©¨]-[Ë∑ü]-[ÂõΩÁéãÁöÑ]-[‰∏äÁ≠â]-[È©¨]-[Ëµõ]-[ÁªìÊûú]-[Áî∞Âøå]-[Ëæì]-[‰∫Ü]`,
    cn_pos: `(n)-(adv)-(v)-(adj)-(n)-(prep)-(n-part)-(adj)-(n)-(v)-(n)-(n)-(v)-(part)`,
    en_raw: `Tian Ji first used an inferior horse to race against the King's superior horse, and as a result, Tian Ji lost.`,
    en_split: `[Tian Ji]-[first]-[used]-[an inferior horse]-[to race against]-[the King's superior horse]-[and]-[as a result]-[Tian Ji]-[lost]`,
    en_pos: `(n)-(adv)-(v)-(art-adj-n)-(part-v-prep)-(art-n-adj-n)-(conj)-(prep-art-n)-(n)-(v)`,
    vi: `ƒêi·ªÅn K·ªµ tr∆∞·ªõc ti√™n d√πng ng·ª±a h·∫°ng h·∫° ƒëua v·ªõi ng·ª±a h·∫°ng th∆∞·ª£ng c·ªßa Qu·ªëc v∆∞∆°ng, k·∫øt qu·∫£ ƒêi·ªÅn K·ªµ thua.`,
    pinyin: `Ti√°n J√¨ xiƒÅn y√≤ng xi√†dƒõng m«é gƒìn gu√≥w√°ng de sh√†ngdƒõng m«é s√†i, ji√©gu«í Ti√°n J√¨ sh≈´le.`
  },
  {
    cn_raw: `Â§ßÂÆ∂ÈÉΩÊÉ≥, ËøôÂú∫ÊØîËµõÁî∞ÂøåÂèàË¶ÅËæì„ÄÇ`,
    cn_split: `[Â§ßÂÆ∂]-[ÈÉΩ]-[ÊÉ≥]-[ËøôÂú∫]-[ÊØîËµõ]-[Áî∞Âøå]-[Âèà]-[Ë¶Å]-[Ëæì]`,
    cn_pos: `(pron)-(adv)-(v)-(pron-mw)-(n)-(n)-(adv)-(v)-(v)`,
    en_raw: `Everyone thought that Tian Ji would lose this competition again.`,
    en_split: `[Everyone]-[thought]-[that]-[Tian Ji]-[would lose]-[this competition]-[again]`,
    en_pos: `(pron)-(v)-(conj)-(n)-(v)-(det-n)-(adv)`,
    vi: `M·ªçi ng∆∞·ªùi ƒë·ªÅu nghƒ©, hi·ªáp thi ƒë·∫•u n√†y ƒêi·ªÅn K·ªµ l·∫°i s·∫Ω thua.`,
    pinyin: `D√†jiƒÅ d≈çu xi«éng, zh√® ch«éng b«ês√†i Ti√°n J√¨ y√≤u y√†o sh≈´.`
  },
  {
    cn_raw: `‰ΩÜÊòØÁ¨¨‰∫åÊ¨°ÊØîËµõ, ÂΩìÂõΩÁéãÁî®‰∏≠Á≠âÈ©¨Êó∂, Áî∞ÂøåÂç¥Áî®‰∫Ü‰∏äÁ≠âÈ©¨„ÄÇ`,
    cn_split: `[‰ΩÜÊòØ]-[Á¨¨‰∫åÊ¨°]-[ÊØîËµõ]-[ÂΩì]-[ÂõΩÁéã]-[Áî®]-[‰∏≠Á≠â]-[È©¨]-[Êó∂]-[Áî∞Âøå]-[Âç¥]-[Áî®]-[‰∫Ü]-[‰∏äÁ≠â]-[È©¨]`,
    cn_pos: `(conj)-(num-mw)-(n)-(prep)-(n)-(v)-(adj)-(n)-(n)-(n)-(adv)-(v)-(part)-(adj)-(n)`,
    en_raw: `But in the second race, when the King used a medium horse, Tian Ji used a superior horse instead.`,
    en_split: `[But]-[in the second race]-[when]-[the King]-[used]-[a medium horse]-[Tian Ji]-[used]-[a superior horse]-[instead]`,
    en_pos: `(conj)-(prep-art-num-n)-(conj)-(art-n)-(v)-(art-adj-n)-(n)-(v)-(art-adj-n)-(adv)`,
    vi: `Nh∆∞ng l·∫ßn ƒëua th·ª© hai, khi Qu·ªëc v∆∞∆°ng d√πng ng·ª±a h·∫°ng trung, ƒêi·ªÅn K·ªµ l·∫°i d√πng ng·ª±a h·∫°ng th∆∞·ª£ng.`,
    pinyin: `D√†nsh√¨ d√¨ √®r c√¨ b«ês√†i, dƒÅng gu√≥w√°ng y√≤ng zh≈çngdƒõng m«é sh√≠, Ti√°n J√¨ qu√® y√≤ngle sh√†ngdƒõng m«é.`
  },
  {
    cn_raw: `Áî∞ÂøåÁöÑ‰∏äÁ≠âÈ©¨ÊØîÂõΩÁéãÁöÑ‰∏≠Á≠âÈ©¨Ë∑ëÂæóÂø´, ËøôÊ¨°Áî∞ÂøåËµ¢‰∫Ü„ÄÇ`,
    cn_split: `[Áî∞ÂøåÁöÑ]-[‰∏äÁ≠â]-[È©¨]-[ÊØî]-[ÂõΩÁéãÁöÑ]-[‰∏≠Á≠â]-[È©¨]-[Ë∑ë]-[Âæó]-[Âø´]-[ËøôÊ¨°]-[Áî∞Âøå]-[Ëµ¢]-[‰∫Ü]`,
    cn_pos: `(n-part)-(adj)-(n)-(prep)-(n-part)-(adj)-(n)-(v)-(part)-(adj)-(pron-mw)-(n)-(v)-(part)`,
    en_raw: `Tian Ji's superior horse ran faster than the King's medium horse, so Tian Ji won this time.`,
    en_split: `[Tian Ji's superior horse]-[ran]-[faster]-[than]-[the King's medium horse]-[so]-[Tian Ji]-[won]-[this time]`,
    en_pos: `(n-adj-n)-(v)-(adv)-(prep)-(art-n-adj-n)-(conj)-(n)-(v)-(det-n)`,
    vi: `Ng·ª±a h·∫°ng th∆∞·ª£ng c·ªßa ƒêi·ªÅn K·ªµ ch·∫°y nhanh h∆°n ng·ª±a h·∫°ng trung c·ªßa Qu·ªëc v∆∞∆°ng, l·∫ßn n√†y ƒêi·ªÅn K·ªµ th·∫Øng r·ªìi.`,
    pinyin: `Ti√°n J√¨ de sh√†ngdƒõng m«é b«ê gu√≥w√°ng de zh≈çngdƒõng m«é p«éo de ku√†i, zh√® c√¨ Ti√°n J√¨ y√≠ngle.`
  },
  {
    cn_raw: `Á¨¨‰∏âÊ¨°, Áî∞ÂøåÁî®‰∏≠Á≠âÈ©¨Ë∑üÂõΩÁéãÁöÑ‰∏ãÁ≠âÈ©¨Ëµõ, ÁªìÊûúÂèàËµ¢‰∫Ü„ÄÇ`,
    cn_split: `[Á¨¨‰∏âÊ¨°]-[Áî∞Âøå]-[Áî®]-[‰∏≠Á≠â]-[È©¨]-[Ë∑ü]-[ÂõΩÁéãÁöÑ]-[‰∏ãÁ≠â]-[È©¨]-[Ëµõ]-[ÁªìÊûú]-[Âèà]-[Ëµ¢]-[‰∫Ü]`,
    cn_pos: `(num-mw)-(n)-(v)-(adj)-(n)-(prep)-(n-part)-(adj)-(n)-(v)-(n)-(adv)-(v)-(part)`,
    en_raw: `For the third time, Tian Ji used a medium horse to race against the King's inferior horse, and won again.`,
    en_split: `[For the third time]-[Tian Ji]-[used]-[a medium horse]-[to race against]-[the King's inferior horse]-[and]-[won again]`,
    en_pos: `(prep-art-num-n)-(n)-(v)-(art-adj-n)-(part-v-prep)-(art-n-adj-n)-(conj)-(v-adv)`,
    vi: `L·∫ßn th·ª© ba, ƒêi·ªÅn K·ªµ d√πng ng·ª±a h·∫°ng trung ƒëua v·ªõi ng·ª±a h·∫°ng h·∫° c·ªßa Qu·ªëc v∆∞∆°ng, k·∫øt qu·∫£ l·∫°i th·∫Øng.`,
    pinyin: `D√¨ sƒÅn c√¨, Ti√°n J√¨ y√≤ng zh≈çngdƒõng m«é gƒìn gu√≥w√°ng de xi√†dƒõng m«é s√†i, ji√©gu«í y√≤u y√≠ngle.`
  },
  {
    cn_raw: `ËøôÊ†∑, Á¨¨‰∫åÂú∫ÊØîËµõÂõΩÁéãËæì‰∫Ü„ÄÇ`,
    cn_split: `[ËøôÊ†∑]-[Á¨¨‰∫åÂú∫]-[ÊØîËµõ]-[ÂõΩÁéã]-[Ëæì]-[l‰∫Ü]`,
    cn_pos: `(pron)-(num-mw)-(n)-(n)-(v)-(part)`,
    en_raw: `In this way, the King lost the second round of the competition.`,
    en_split: `[In this way]-[the King]-[lost]-[the second round]-[of the competition]`,
    en_pos: `(prep-det-n)-(art-n)-(v)-(art-num-n)-(prep-art-n)`,
    vi: `Nh∆∞ v·∫≠y, hi·ªáp thi ƒë·∫•u th·ª© hai Qu·ªëc v∆∞∆°ng thua r·ªìi.`,
    pinyin: `Zh√®y√†ng, d√¨ √®r ch«éng b«ês√†i gu√≥w√°ng sh≈´le.`
  },
  {
    cn_raw: `**Á¨¨‰∏âÂú∫Ë∑üÁ¨¨‰∫åÂú∫‰∏ÄÊ†∑, Áî∞ÂøåÁî®ÂêåÊ†∑ÁöÑÂäûÊ≥ïÂèàËµ¢‰∫ÜÂõΩÁéã. **`,
    cn_split: `[Á¨¨‰∏âÂú∫]-[Ë∑ü]-[Á¨¨‰∫åÂú∫]-[‰∏ÄÊ†∑]-[Áî∞Âøå]-[Áî®]-[ÂêåÊ†∑ÁöÑ]-[ÂäûÊ≥ï]-[Âèà]-[Ëµ¢]-[‰∫Ü]-[ÂõΩÁéã]`,
    cn_pos: `(num-mw)-(prep)-(num-mw)-(adj)-(n)-(v)-(adj-part)-(n)-(adv)-(v)-(part)-(n)`,
    en_raw: `The third round was the same as the second round, Tian Ji used the same method to win over the King again.`,
    en_split: `[The third round]-[was]-[the same as]-[the second round]-[Tian Ji]-[used]-[the same method]-[to win over]-[the King]-[again]`,
    en_pos: `(art-num-n)-(v)-(art-adj-prep)-(art-num-n)-(n)-(v)-(art-adj-n)-(part-v-prep)-(art-n)-(adv)`,
    vi: `Hi·ªáp th·ª© ba gi·ªëng nh∆∞ hi·ªáp th·ª© hai, ƒêi·ªÅn K·ªµ d√πng c√°ch t∆∞∆°ng t·ª± l·∫°i th·∫Øng Qu·ªëc v∆∞∆°ng.`,
    pinyin: `D√¨ sƒÅn ch«éng gƒìn d√¨ √®r ch«éng yƒ´y√†ng, Ti√°n J√¨ y√≤ng t√≥ngy√†ng de b√†nf«é y√≤u y√≠ngle gu√≥w√°ng.`
  },
  {
    cn_raw: `ÊØîËµõÁöÑÁªìÊûúÊòØ‰∫åÊØî‰∏Ä, Áî∞ÂøåËµ¢‰∫Ü„ÄÇ`,
    cn_split: `[ÊØîËµõÁöÑ]-[ÁªìÊûú]-[ÊòØ]-[‰∫åÊØî‰∏Ä]-[Áî∞Âøå]-[Ëµ¢]-[‰∫Ü]`,
    cn_pos: `(n-part)-(n)-(v)-(num)-(n)-(v)-(part)`,
    en_raw: `The result of the competition was two to one, Tian Ji won.`,
    en_split: `[The result]-[of the competition]-[was]-[two to one]-[Tian Ji]-[won]`,
    en_pos: `(art-n)-(prep-art-n)-(v)-(num-prep-num)-(n)-(v)`,
    vi: `K·∫øt qu·∫£ cu·ªôc thi l√† hai-m·ªôt, ƒêi·ªÅn K·ªµ th·∫Øng.`,
    pinyin: `B«ês√†i de ji√©gu«í sh√¨ √®r b«ê yƒ´, Ti√°n J√¨ y√≠ngle.`
  }
];

// C·∫≠p nh·∫≠t h√†m render ƒë·ªÉ truy·ªÅn d·ªØ li·ªáu an to√†n h∆°n
function renderBook() {
    const container = document.getElementById('bookContent');
    sentences.forEach((s, i) => {
        const item = document.createElement('div');
        item.className = 'sentence-item';
        item.innerHTML = `
            <div class="text-content">
                <div class="row-cn">
                    <span id="cn-txt-${i}">${s.cn_raw}</span>
                </div>
                <div id="cn-pos-${i}" class="pos-tag hidden">${s.cn_pos}</div>
                <div id="pinyin-${i}" class="pinyin-row hidden">${s.pinyin || ''}</div>
                
                <div class="row-en">
                    <span id="en-txt-${i}">${s.en_raw}</span>
                </div>
                <div id="en-pos-${i}" class="pos-tag hidden">${s.en_pos}</div>
                
                <div class="row-vi">${s.vi}</div>
            </div>
            <div class="control-sidebar">
                <button class="btn-icon" onclick="playSpeech(${i}, 'cn')">üó£Ô∏è</button>
                <button class="btn-icon" onclick="toggleMode(${i}, 'cn')">üß©</button>
                <button class="btn-icon" onclick="playSpeech(${i}, 'en')">üîä</button>
                <button class="btn-icon" onclick="toggleMode(${i}, 'en')">üîç</button>
            </div>
        `;
        container.appendChild(item);
    });
}
// H√†m ph√°t √¢m m·ªõi: L·∫•y d·ªØ li·ªáu tr·ª±c ti·∫øp t·ª´ m·∫£ng thay v√¨ truy·ªÅn chu·ªói qua HTML
// H√†m ph√°t √¢m: T·ª± ƒë·ªông duy tr√¨ ng√¥n ng·ªØ ƒëang ch·ªçn
function playSpeech(index, langType) {
    // 1. D·ª´ng m·ªçi √¢m thanh ƒëang ph√°t ƒë·ªÉ tr√°nh ch·ªìng ch√©o
    window.speechSynthesis.cancel(); 

    let textToRead = "";
    let langCode = "";

    // 2. X√°c ƒë·ªãnh n·ªôi dung v√† m√£ ng√¥n ng·ªØ d·ª±a tr√™n l·ª±a ch·ªçn c·ªßa ng∆∞·ªùi d√πng
    if (langType === 'cn') {
        textToRead = sentences[index].cn_raw;
        langCode = 'zh-CN';
    } else {
        textToRead = sentences[index].en_raw;
        langCode = 'en-US';
    }

    const msg = new SpeechSynthesisUtterance();
    msg.text = textToRead;
    msg.lang = langCode;
    msg.rate = document.getElementById('rate').value;
    
    // 3. Hi·ªáu ·ª©ng Highlight: T√¥ m√†u c√¢u ƒëang ƒë·ªçc ƒë·ªÉ d·ªÖ theo d√µi
    const allItems = document.getElementsByClassName('sentence-item');
    // X√≥a m√†u c·ªßa t·∫•t c·∫£ c√°c c√¢u kh√°c
    Array.from(allItems).forEach(item => item.style.backgroundColor = "transparent");
    // T√¥ m√†u v√†ng nh·∫°t cho c√¢u hi·ªán t·∫°i
    allItems[index].style.backgroundColor = "rgba(230, 126, 34, 0.1)";

    // 4. X·ª≠ l√Ω khi k·∫øt th√∫c c√¢u
    msg.onend = () => {
        const isAuto = document.getElementById('autoNext').checked;
        if (isAuto && index < sentences.length - 1) {
            setTimeout(() => {
                // QUAN TR·ªåNG: Truy·ªÅn ƒë√∫ng langType hi·ªán t·∫°i v√†o l·∫ßn g·ªçi ti·∫øp theo
                playSpeech(index + 1, langType); 
                
                // T·ª± ƒë·ªông cu·ªôn m√†n h√¨nh ƒë·∫øn c√¢u ti·∫øp theo
                allItems[index + 1].scrollIntoView({
                    behavior: "smooth", 
                    block: "center"
                });
            }, 500); // Ngh·ªâ 0.5 gi√¢y gi·ªØa c√°c c√¢u ƒë·ªÉ ng∆∞·ªùi d√πng k·ªãp ng·∫•m
        }
    };

    window.speechSynthesis.speak(msg);
}
function toggleMode(index, lang) {
    const txtSpan = document.getElementById(`${lang}-txt-${index}`);
    const posSpan = document.getElementById(`${lang}-pos-${index}`);
    const isOriginal = txtSpan.innerText === sentences[index][`${lang}_raw`];

    txtSpan.innerText = isOriginal ? sentences[index][`${lang}_split`] : sentences[index][`${lang}_raw`];
    posSpan.classList.toggle('hidden');
}

function toggleDarkMode() {
    document.body.classList.toggle('dark-mode');
}

function toggleAllPinyin() {
    // 1. L·∫•y t·∫•t c·∫£ c√°c ph·∫ßn t·ª≠ c√≥ class l√† pinyin-row
    const pinyinElements = document.getElementsByClassName('pinyin-row');
    
    // 2. Ki·ªÉm tra n·∫øu kh√¥ng t√¨m th·∫•y ph·∫ßn t·ª≠ n√†o (b√°o l·ªói ra Console ƒë·ªÉ ki·ªÉm tra)
    if (pinyinElements.length === 0) {
        console.error("Kh√¥ng t√¨m th·∫•y ph·∫ßn t·ª≠ n√†o c√≥ class 'pinyin-row'");
        return;
    }

    // 3. Duy·ªát qua t·ª´ng ph·∫ßn t·ª≠ v√† b·∫≠t/t·∫Øt class 'hidden'
    for (let i = 0; i < pinyinElements.length; i++) {
        pinyinElements[i].classList.toggle('hidden');
    }
}

function speak(text, lang, index) {
    window.speechSynthesis.cancel();
    const msg = new SpeechSynthesisUtterance(text);
    msg.lang = lang;
    msg.rate = document.getElementById('rate').value;

    msg.onend = () => {
        if (document.getElementById('autoNext').checked && index < sentences.length - 1) {
            setTimeout(() => {
                speak(sentences[index + 1].cn_raw, 'zh-CN', index + 1);
                document.getElementsByClassName('sentence-item')[index+1].scrollIntoView({behavior: "smooth", block: "center"});
            }, 1200);
        }
    };
    window.speechSynthesis.speak(msg);
}

renderBook();
</script>
</body>
</html>